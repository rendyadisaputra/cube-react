(this["webpackJsonp@cubejs-client/playground"]=this["webpackJsonp@cubejs-client/playground"]||[]).push([[0],{815:function(e,t,n){"use strict";n.r(t);var r,a,i,o,c,s,u,l=n(12),d=n.n(l),b=n(7),p=n(23),h=n(40),m=n(37),f=n.n(m),j=n(47),v=n(94),y=n(75),g=n(76),O=n(104),x=n(103),k=n(14),w=n(0),C=n.n(w),S=(n(244),n(826)),A=n(847),D=n(13),E=n(857),T=n(827),P=n(858),q=n(859),R=n(296),M=n(171),I=n(361),L=n(106),_=n(1),B=function(){return Object(_.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 32 32",fill:"currentColor",children:Object(_.jsx)("path",{d:"M16.135 0c8.75 0 15.865 7.313 15.865 15.995s-7.104 15.99-15.865 15.99l-16.135 0.016v-16.281c0-8.677 7.375-15.719 16.135-15.719zM16.292 6.083c-3.458-0.005-6.661 1.802-8.448 4.76-1.776 2.943-1.849 6.609-0.198 9.625l-1.781 5.677 6.396-1.432c3.656 1.635 7.953 0.901 10.844-1.854 2.896-2.734 3.818-6.969 2.318-10.661-1.51-3.703-5.12-6.12-9.12-6.115z"})})},z=Object(D.d)(M.a)(r||(r=Object(k.a)(["\n  && {\n    background: transparent;\n    border-bottom: 0;\n  }\n"]))),F=Object(D.d)(M.a.Item)(a||(a=Object(k.a)(["\n  &&& {\n    font-size: 15px;\n    font-weight: 500;\n    line-height: 48px;\n    height: 49px;\n    & > a {\n      &,\n      &:hover {\n        opacity: 0.6;\n        color: white;\n      }\n    }\n    &.ant-menu-item-selected,\n    &.ant-menu-item-active {\n      color: white;\n      border-bottom: 2px solid white;\n\n      &:hover {\n        border-bottom: 2px solid white;\n      }\n\n      a {\n        opacity: 1;\n        color: white;\n      }\n    }\n\n    &:not(.ant-menu-item-selected) {\n      &.ant-menu-item-active,\n      &:hover {\n        color: white;\n        border-bottom: 2px solid white;\n      }\n    }\n  }\n"]))),N=D.d.a(i||(i=Object(k.a)(["\n  &&& {\n    float: right;\n    height: 32px;\n    margin: 8px ",";\n    border: 1px solid rgba(255, 255, 255, 0.35);\n    border-radius: 4px;\n    display: flex;\n    align-items: center;\n    color: white;\n    transition: all 0.25s ease;\n    padding: 0 10px;\n\n    span {\n      font-size: 14px;\n      margin-right: 10px;\n    }\n\n    &:hover {\n      border-color: white;\n      color: white;\n    }\n  }\n"])),(function(e){return e.noMargin?"0":"8px"})),Q=n(10),U=n(856),K=n(846),V=n(839),Y=n(66),J=D.d.div(o||(o=Object(k.a)(["\n  display: flex;\n  flex-direction: ",";\n  flex-wrap: ",";\n  justify-content: ",";\n  align-items: ",";\n\n  ",";\n\n  margin: ",";\n"])),(function(e){return e.direction||"row"}),(function(e){return e.wrap?"wrap":null}),(function(e){return e.justifyContent}),(function(e){return e.alignItems}),(function(e){var t=e.gap,n=e.direction;if(t)return"column"===n?Object(D.c)(c||(c=Object(k.a)(["\n        & > div {\n          margin-bottom: ","px};\n        }\n\n        & > div:last-child {\n          margin-bottom: 0;\n        }\n      "])),8*t):Object(D.c)(s||(s=Object(k.a)(["\n      & > div {\n        margin-right: ","px};\n      }\n\n      & > div:last-child {\n        margin-right: 0;\n      }\n    "])),8*t);return""}),(function e(t){var n=t.margin;if("string"===typeof n)return n;if("number"===typeof n)return"".concat(8*n,"px");if(Array.isArray(n)){var r=n.length;if(2===r){var a=Object(Q.a)(n,2),i=a[0],o=a[1];return"".concat(8*i,"px ").concat(8*o,"px")}if(r>2)return n.fill(0,0,4).map((function(e){return"".concat(8*e)})).join(" ")}if(n&&Object.keys(n||{}).length)return Object.entries(n).map((function(t){var n=Object(Q.a)(t,2),r=n[0],a=n[1];return"top"===r?"".concat(e({margin:a})," 0 0 0"):"bottom"===r?"0 0 ".concat(e({margin:a})," 0"):void 0}));return null}));var G=D.d.div(u||(u=Object(k.a)(["\n  align-self: ",";\n  flex-grow: ",";\n"])),(function(e){return e.align}),(function(e){return e.grow})),W=n(191),H=n.n(W);var Z,$=n(282),X=n(369),ee=n(842),te=n(837),ne=n(838),re=n(851),ae=n(494),ie=n(495),oe=n(211),ce=n(48),se=n(491),ue=n(464),le={"angular-cli":{files:{"src/polyfills.ts":{content:"import 'core-js/proposals/reflect-metadata';\nimport 'zone.js/dist/zone';"},"src/main.ts":{content:"import { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\n\nplatformBrowserDynamic().bootstrapModule(AppModule)\n  .catch(err => console.error(err));"},"src/index.html":{content:'<!DOCTYPE html>\n        <html lang="en">\n          <head>\n            <meta charset="utf-8" />\n            <title>AngularCharts</title>\n            <base href="/" />\n            <meta name="viewport" content="width=device-width, initial-scale=1" />\n            <link rel="icon" type="image/x-icon" href="favicon.ico" />\n          </head>\n          <body>\n            <app-root></app-root>\n          </body>\n        </html>\n        '},".angular-cli.json":{content:'{\n          "apps": [\n            {\n              "root": "src",\n              "outDir": "dist",\n              "index": "index.html",\n              "main": "main.ts",\n              "polyfills": "polyfills.ts",\n              "styles": [],\n              "scripts": []\n            }\n          ]\n        }'}},dependencies:{"zone.js":"latest","@angular/platform-browser-dynamic":"latest","@angular/platform-browser":"latest","@angular/compiler":"latest",rxjs:"latest","@angular/common":"latest"}},"create-react-app":{dependencies:{"react-dom":"latest"}}},de={"react-chartjs-2":"chart.js"};function be(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e){var r=new CustomEvent("__cubejsPlaygroundEvent",{bubbles:!0,composed:!0,detail:Object(b.a)(Object(b.a)({},n),{},{eventType:t})});e.dispatchEvent(r)}}function pe(e,t,n){return Promise.race([fetch(e,t),new Promise((function(e,t){return setTimeout((function(){return t(new Error("timeout"))}),n)}))])}function he(e){return me.apply(this,arguments)}function me(){return(me=Object(p.a)(d.a.mark((function e(t){var n,r=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:"Copied to clipboard",navigator.clipboard||se.a.error({message:"Your browser doesn't support copy to clipboard"}),e.prev=2,e.next=5,navigator.clipboard.writeText(t);case 5:se.a.success({message:n}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),se.a.error({message:"Can't copy to clipboard",description:e.t0});case 11:case"end":return e.stop()}}),e,null,[[2,8]])})))).apply(this,arguments)}var fe=X.a.TabPane,je=ee.a.TextArea,ve=V.a.Text,ye=V.a.Link,ge=D.d.div(Z||(Z=Object(k.a)(["\n  display: flex;\n  gap: 8px;\n\n  input {\n    text-overflow: ",";\n  }\n"])),(function(e){return e.editing?"unset":"ellipsis"}));function Oe(){var e=Se(),t=e.payload,n=e.token,r=e.isModalOpen,a=e.setIsModalOpen,i=e.saveToken,o=e.onTokenPayloadChange,c=te.a.useForm(),s=Object(Q.a)(c,1)[0],u=Object(w.useState)(!1),l=Object(Q.a)(u,2),b=l[0],h=l[1],m=Object(w.useState)(!0),f=Object(Q.a)(m,2),j=f[0],v=f[1],y=Object(w.useState)(t||""),g=Object(Q.a)(y,2),O=g[0],x=g[1],k=Object(w.useState)(!1),C=Object(Q.a)(k,2),S=C[0],A=C[1],D=Object(w.useRef)(null);function E(){return(E=Object(p.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,A(!0),e.t0=i,e.next=5,o(Object($.a)(null===t||void 0===t?void 0:t.token),(null===t||void 0===t?void 0:t.token)||null);case 5:e.t1=e.sent,(0,e.t0)(e.t1),e.next=12;break;case 9:e.prev=9,e.t2=e.catch(0),i((null===t||void 0===t?void 0:t.token)||null);case 12:return e.prev=12,h(!1),a(!1),A(!1),e.finish(12);case 17:case"end":return e.stop()}}),e,null,[[0,9,12,17]])})))).apply(this,arguments)}function T(){return(T=Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!j){e.next=18;break}if("function"===typeof o){e.next=3;break}throw new Error("Saving token requires the `onTokenPayloadChange` function provided to the `SecurityContext`");case 3:return A(!0),e.prev=4,e.t0=i,e.next=8,o(JSON.parse(O||"{}"),null);case 8:e.t1=e.sent,(0,e.t0)(e.t1),e.next=15;break;case 12:e.prev=12,e.t2=e.catch(4),console.error(e.t2);case 15:A(!1),e.next=19;break;case 18:O||i(null);case 19:a(!1);case 20:case"end":return e.stop()}}),e,null,[[4,12]])})))).apply(this,arguments)}return Object(w.useEffect)((function(){var e;b&&(null===(e=D.current)||void 0===e||e.focus())}),[b]),Object(w.useEffect)((function(){h(!n),x(t),s.setFieldsValue({token:n})}),[s,n,t]),Object(_.jsx)(ne.a,{title:"Security Context",visible:r,footer:null,bodyStyle:{paddingTop:8},onCancel:function(){a(!1),h(!1)},children:Object(_.jsx)("div",{"data-testid":"security-context-modal",children:Object(_.jsxs)(re.b,{direction:"vertical",size:24,style:{width:"100%"},children:[Object(_.jsxs)(X.a,{defaultActiveKey:"json",style:{minHeight:200},onChange:function(e){"token"!==e&&b&&n&&(h(!1),s.resetFields())},children:[Object(_.jsx)(fe,{tab:"JSON",children:Object(_.jsxs)(re.b,{direction:"vertical",size:16,style:{width:"100%"},children:[Object(_.jsx)(je,{"data-testid":"security-context-textarea",value:O||"",rows:6,style:{width:"100%"},onChange:function(e){var t=e.target.value;x(t);try{JSON.parse(t),v(!0)}catch(n){v(!1)}}}),Object(_.jsx)(Y.a,{"data-testid":"save-security-context-payload-btn",type:"primary",disabled:Boolean(O&&!j),loading:S,onClick:function(){return T.apply(this,arguments)},children:"Save"})]})},"json"),Object(_.jsx)(fe,{"data-testid":"security-modal-token-tab",tab:"Token",children:Object(_.jsxs)(re.b,{direction:"vertical",size:16,style:{width:"100%"},children:[Object(_.jsx)(ve,{type:"secondary",children:"Edit or copy the generated token from below"}),Object(_.jsx)(te.a,{form:s,initialValues:{token:n},onFinish:function(e){return E.apply(this,arguments)},children:Object(_.jsxs)(ge,{editing:b,children:[Object(_.jsx)(te.a.Item,{name:"token",style:{width:"auto",flexGrow:1},children:Object(_.jsx)(ee.a,{"data-testid":"security-context-token-input",ref:D,disabled:!b})}),b?Object(_.jsx)(Y.a,{type:"primary",htmlType:"submit",loading:S,icon:Object(_.jsx)(oe.a,{})}):Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(Y.a,{ghost:!0,type:"primary",icon:Object(_.jsx)(ae.a,{}),onClick:function(){h(!0)}}),Object(_.jsx)(Y.a,{type:"primary",icon:Object(_.jsx)(ie.a,{}),disabled:!n,onClick:function(){return he(n)},children:"Copy"})]})]})})]})},"token")]}),Object(_.jsxs)(ve,{type:"secondary",children:["Learn more about Security Context in"," ",Object(_.jsx)(ye,{href:"https://cube.dev/docs/security/context",target:"_blank",children:"docs"})]})]})})})}var xe=Object(w.createContext)({}),ke=0,we=null;function Ce(e){var t=e.children,n=e.tokenUpdater,r=e.onTokenPayloadChange,a=Mn(),i=Rn("cubejsToken",null),o=Object(Q.a)(i,3),c=o[0],s=o[1],u=o[2],l=Object(w.useState)(""),b=Object(Q.a)(l,2),h=b[0],m=b[1],f=Object(w.useState)(!1),j=Object(Q.a)(f,2),v=j[0],y=j[1];function g(){return(g=Object(p.a)(d.a.mark((function e(){var t,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==c||!n||we===c){e.next=7;break}return we=c,t=ke,e.next=5,n(c);case 5:r=e.sent,a()&&t===ke&&(s(r),ke++);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(w.useEffect)((function(){if(c)try{var e=Object($.a)(c);m(JSON.stringify(e,null,2))}catch(t){m(""),console.error("Invalid JWT token",c)}else m("")}),[c]),Object(_.jsxs)(xe.Provider,{value:{token:c,payload:h,isModalOpen:v,setIsModalOpen:y,saveToken:function(e){e?s(e):u()},refreshToken:function(){return g.apply(this,arguments)},onTokenPayloadChange:r},children:[t,Object(_.jsx)(Oe,{})]})}function Se(){return Object(w.useContext)(xe)}n(381),n(391),n(392),n(393),n(581),n(583),n(584),n(261),n(400),n(401),n(402),n(403),n(592),n(595),n(409),n(411),n(412),n(413),n(414),n(598),n(415),n(420),n(329),n(423),n(610),n(611),n(330),n(614),n(425),n(615),n(426),n(428),n(618);var Ae=n(39),De=n.n(Ae),Ee=n(85),Te=n.n(Ee),Pe=n(72),qe=n.n(Pe),Re=n(77),Me=n.n(Re),Ie=n(67),Le=n.n(Ie),_e=n(26),Be=n.n(_e),ze=n(844),Fe=n(115),Ne=n.n(Fe),Qe=n(54),Ue=n.n(Qe),Ke=n(34),Ve=n.n(Ke),Ye=n(128),Je=n.n(Ye),Ge=n(466),We=n.n(Ge),He=n(467),Ze=n.n(He),$e=n(487),Xe=n(818),et=n(819),tt=n(488),nt=n(848),rt=n(205),at=n(849),it=n(470),ot=n(820),ct=n(821),st=n(822),ut=n(823),lt=n(824),dt=n(825),bt=n(850),pt=n(875),ht=n(876),mt=n(843),ft=n(845),jt=n(468),vt=n.n(jt),yt=(n(630),n(111)),gt=n.n(yt),Ot=n(195),xt=n.n(Ot),kt=n(126),wt=n.n(kt),Ct=n(469),St=n.n(Ct),At=["query"];function Dt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Et(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Dt(Object(n),!0).forEach((function(t){De()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Dt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Tt=[{name:void 0,title:"w/o grouping"},{name:"second",title:"Second"},{name:"minute",title:"Minute"},{name:"hour",title:"Hour"},{name:"day",title:"Day"},{name:"week",title:"Week"},{name:"month",title:"Month"},{name:"quarter",title:"Quarter"},{name:"year",title:"Year"}];function Pt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object($e.a)(Object.entries(e&&e.order||{}),Object.entries(t&&t.order||{}))&&Object($e.a)(e,t)}function qt(e){var t=(e.timeDimensions||[]).find((function(e){return e.granularity}));return t?De()({},t.dimension,"asc"):(e.measures||[]).length>0&&(e.dimensions||[]).length>0?De()({},e.measures[0],"desc"):(e.dimensions||[]).length>0?De()({},e.dimensions[0],"asc"):{}}function Rt(e){return!!e&&(Array.isArray(e)?e:[e]).every((function(e){return e.measures&&e.measures.length||e.dimensions&&e.dimensions.length||e.timeDimensions&&e.timeDimensions.length}))}function Mt(e,t,n,r,a){var i=Et(Et({},e),{},{x:Ue()(e.x),y:Ue()(e.y)}),o=e[r][t],c=i[a].length-1;return"measures"===o?n=c+1:n>=c&&"measures"===i[a][c]&&(n=c-1),i[r].splice(t,1),i[a].splice(n,0,o),i}function It(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.reduce((function(e,t){return t.or||t.and?[].concat(Ue()(e),Ue()(It(t.or||t.and))):[].concat(Ue()(e),[t])}),[])}function Lt(e,t,n,r){var a=e.filter((function(e){return null!=e}));return n&&n.aliasSeries&&n.aliasSeries[t]?[n.aliasSeries[t]].concat(Ue()(a)):r.has(a[0])?[t].concat(Ue()(a)):a}var _t=["x"],Bt=["key"],zt=["title","shortTitle"];function Ft(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Nt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ft(Object(n),!0).forEach((function(t){De()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ft(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}Je.a.locale(Nt(Nt({},Ze.a),{},{weekStart:1})),Je.a.extend(We.a);var Qt={day:function(e){return e.by("d").map((function(e){return e.format("YYYY-MM-DDT00:00:00.000")}))},month:function(e){return e.snapTo("month").by("M").map((function(e){return e.format("YYYY-MM-01T00:00:00.000")}))},year:function(e){return e.snapTo("year").by("y").map((function(e){return e.format("YYYY-01-01T00:00:00.000")}))},hour:function(e){return e.by("h").map((function(e){return e.format("YYYY-MM-DDTHH:00:00.000")}))},minute:function(e){return e.by("m").map((function(e){return e.format("YYYY-MM-DDTHH:mm:00.000")}))},second:function(e){return e.by("s").map((function(e){return e.format("YYYY-MM-DDTHH:mm:ss.000")}))},week:function(e){return e.snapTo("week").by("w").map((function(e){return e.startOf("week").format("YYYY-MM-DDT00:00:00.000")}))},quarter:function(e){return e.snapTo("quarter").by("quarter").map((function(e){return e.startOf("quarter").format("YYYY-MM-DDT00:00:00.000")}))}},Ut=/^\d\d\d\d-\d\d-\d\d$/,Kt=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z?$/,Vt=function(e){var t=new Map;return function(n){return n.forEach((function(n){var r=e(n);t.has(r)||t.set(r,[]),t.get(r).push(n)})),Array.from(t.entries())}},Yt=function(e){var t=[];return e.forEach((function(e){e.forEach((function(e){return t.push(e)}))})),t},Jt=function e(t,n){return{by:function(e){for(var r=[],a=Je()(t),i=Je()(n);a.isBefore(i)||a.isSame(i);)r.push(a),a=a.add(1,e);return r},snapTo:function(r){return e(Je()(t).startOf(r),Je()(n).endOf(r))},start:Je()(t),end:Je()(n)}},Gt={REGULAR_QUERY:"regularQuery",COMPARE_DATE_RANGE_QUERY:"compareDateRangeQuery",BLENDING_QUERY:"blendingQuery"},Wt=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(qe()(this,e),this.loadResponse=t,null!=this.loadResponse.queryType?(this.queryType=t.queryType,this.loadResponses=t.results):(this.queryType=Gt.REGULAR_QUERY,this.loadResponse.pivotQuery=Nt(Nt({},t.query),{},{queryType:this.queryType}),this.loadResponses=[t]),!Object.values(Gt).includes(this.queryType))throw new Error("Unknown query type");this.parseDateMeasures=n.parseDateMeasures,this.options=n,this.backwardCompatibleData=[]}return Me()(e,[{key:"drillDown",value:function(e,t){if(this.queryType===Gt.COMPARE_DATE_RANGE_QUERY)throw new Error("compareDateRange drillDown query is not currently supported");if(this.queryType===Gt.BLENDING_QUERY)throw new Error("Data blending drillDown query is not currently supported");var n=e.xValues,r=void 0===n?[]:n,a=e.yValues,i=void 0===a?[]:a,o=this.normalizePivotConfig(t),c=[];o.x.forEach((function(e,t){return c.push([e,r[t]])})),o.y.forEach((function(e,t){return c.push([e,i[t]])}));var s=this.query(),u=s.filters,l=void 0===u?[]:u,d=s.segments,b=void 0===d?[]:d,p=this.loadResponses[0].annotation.measures,h=c.find((function(e){return"measures"===Ve()(e,1)[0]}))||[],m=Ve()(h,2)[1];if(void 0===m){var f=Object.keys(p);m=Ve()(f,1)[0]}if(!(p[m]&&p[m].drillMembers||[]).length)return null;var j=[{member:m,operator:"measureFilter"}].concat(Ue()(l)),v=[];c.filter((function(e){return"measures"!==Ve()(e,1)[0]})).forEach((function(e){var t=Ve()(e,2),n=t[0],r=t[1],a=n.split("."),i=Ve()(a,3),o=i[0],c=i[1],s=i[2];if(void 0!==s){var u=Jt(r,r).snapTo(s);v.push({dimension:[o,c].join("."),dateRange:[u.start,u.end].map((function(e){return e.format("YYYY-MM-DDTHH:mm:ss.SSS")}))})}else null==r?j.push({member:n,operator:"notSet"}):j.push({member:n,operator:"equals",values:[r.toString()]})}));var y=this.loadResponses[0].query;return 0===v.length&&y.timeDimensions.length>0&&null==y.timeDimensions[0].granularity&&v.push(y.timeDimensions[0]),Nt(Nt(Nt({},p[m].drillMembersGrouped),{},{filters:j},b.length>0?{segments:b}:{}),{},{timeDimensions:v,segments:b,timezone:y.timezone})}},{key:"series",value:function(e){var t=this;return this.seriesNames(e).map((function(n){var r=n.title,a=n.key;return{title:r,key:a,series:t.chartPivot(e).map((function(e){var t=e.x;return{value:Ne()(e,_t)[a],x:t}}))}}))}},{key:"axisValues",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.loadResponses[t].query;return function(t){var r=function(n){return e.filter((function(e){return"measures"!==e})).map((function(e){return null!=t[e]?t[e]:null})).concat(n?[n]:[])};return e.find((function(e){return"measures"===e}))&&(n.measures||[]).length?n.measures.map(r):[r()]}}},{key:"axisValuesString",value:function(e,t){return e.map((function(e){return null==e?"\u2205":""===e?"[Empty string]":e})).join(t||", ")}},{key:"normalizePivotConfig",value:function(t){return e.getNormalizedPivotConfig(this.loadResponse.pivotQuery,t)}},{key:"timeSeries",value:function(t,n){if(!t.granularity)return null;var r=t.dateRange;if(!r){var a=e.timeDimensionMember(t),i=Object(nt.a)(Object(rt.a)((function(e){return e[a]&&Je()(e[a])})),Object(at.a)(Boolean))(this.timeDimensionBackwardCompatibleData(n));r=i.length&&[Object(it.a)(Object(ot.a)((function(e){return e.toDate()})),i[0],i),Object(it.a)(Object(ct.a)((function(e){return e.toDate()})),i[0],i)]||null}if(!r)return null;var o=t.dateRange?t.dateRange.find((function(e){return e.match(Ut)})):!["hour","minute","second"].includes(t.granularity),c=r,s=Ve()(c,2),u=s[0],l=s[1],d=Jt(u,l);if(!Qt[t.granularity])throw new Error("Unsupported time granularity: ".concat(t.granularity));return Qt[t.granularity](o?d.snapTo("d"):d)}},{key:"pivot",value:function(t){var n=this;t=this.normalizePivotConfig(t);var r=this.loadResponse.pivotQuery,a=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=Vt((function(e){var t=e.xValues;return n.axisValuesString(t)})),o=function(e,t){return e[t]};if(t.fillMissingDates&&1===t.x.length&&Object($e.a)(t.x,(r.timeDimensions||[]).filter((function(e){return Boolean(e.granularity)})).map((function(t){return e.timeDimensionMember(t)})))){var c=n.loadResponses.map((function(e){return n.timeSeries(e.query.timeDimensions[0],a)}));c[0]&&(i=function(e){var t=Object(st.a)((function(e){return e.xValues[0]}),e);return c[a].map((function(e){return[e,t[e]||[{xValues:[e],row:{}}]]}))},o=function(e,t){return e[t]||0})}var s=Object(nt.a)(Object(rt.a)((function(e){return n.axisValues(t.x,a)(e).map((function(t){return{xValues:t,row:e}}))})),Yt,i)(n.timeDimensionBackwardCompatibleData(a)),u={};s.forEach((function(e){Ve()(e,2)[1].forEach((function(e){var r=e.row;n.axisValues(t.y,a)(r).forEach((function(e){Object.keys(r).length>0&&(u[e.join()]=e)}))}))}));var l=Object.values(u),d=Boolean(t.x.find((function(e){return"measures"===e})));return s.map((function(r){var i=Ve()(r,2)[1],c=i[0].xValues,s={};return i.forEach((function(e){var r=e.row;n.axisValues(t.y,a)(r).map((function(e){return{yValues:e,row:r}})).forEach((function(e){s[n.axisValuesString(e.yValues)]=e}))})),{xValues:c,yValuesArray:Yt(l.map((function(t){var r=d?e.measureFromAxis(c):e.measureFromAxis(t);return[[t,o((s[n.axisValuesString(t)]||{row:{}}).row,r)]]})))}}))},i=this.loadResponses.length>1?this.loadResponses.map((function(e,t){return a(t)})):[];return i.length?this.mergePivots(i,t.joinDateRange):a()}},{key:"mergePivots",value:function(e,t){var n=e.reduce((function(e,t){return null!=e&&t.length>=e.length?e:t}),null);return n.map((function(r,a){return{xValues:t?[e.map((function(e){return e[a]&&e[a].xValues||[]})).join(", ")]:n[a].xValues,yValuesArray:Yt(e.map((function(e){return e[a].yValuesArray})))}}))}},{key:"pivotedRows",value:function(e){return this.chartPivot(e)}},{key:"chartPivot",value:function(e){var t=this,n=new Set;this.queryType===Gt.BLENDING_QUERY&&Object(ut.a)(this.loadResponses.map((function(e){return e.query.measures}))).filter((function(e,t,n){return n.indexOf(e)!==t})).forEach((function(e){return n.add(e)}));return this.pivot(e).map((function(r){var a=r.xValues,i=r.yValuesArray,o={};return i.forEach((function(r,a){var i,c=Ve()(r,2),s=c[0],u=c[1];o[t.axisValuesString(Lt(s,a,e,n),",")]=u&&(i=u,t.parseDateMeasures&&Kt.test(i)?new Date(i):Number.isNaN(Number.parseFloat(i))?i:Number.parseFloat(i))})),Nt({x:t.axisValuesString(a,","),xValues:a},o)}))}},{key:"tablePivot",value:function(e){var t=this.normalizePivotConfig(e||{}),n=t.x.concat(t.y).includes("measures");return this.pivot(t).map((function(e){var r=e.xValues,a=e.yValuesArray;return Object(lt.a)(t.x.map((function(e,t){return[e,r[t]]})).concat(n?a.map((function(e){var t=Ve()(e,2),n=t[0],r=t[1];return[n.length?n.join():"value",r]})):[]))}))}},{key:"tableColumns",value:function(e){var t=this.normalizePivotConfig(e||{}),n=Object(nt.a)(Object(dt.a)("annotation"),Object(it.a)(Object(bt.a)(),{}))(this.loadResponses),r=Object.values(n).reduce((function(e,t){return Nt(Nt({},e),t)}),{}),a={},i=function(e){var t=r[e]||{};return{key:e,title:t.title,shortTitle:t.shortTitle,type:t.type,format:t.format,meta:t.meta}},o=this.pivot(t);(o[0]&&o[0].yValuesArray||[]).forEach((function(e){var n=Ve()(e,1)[0];if(n.length>0){var r=a;n.forEach((function(e,n){r["_".concat(e)]={key:e,memberId:"measures"===t.y[n]?e:t.y[n],children:r["_".concat(e)]&&r["_".concat(e)].children||{}},r=r["_".concat(e)].children}))}}));var c=[];return!o.length&&t.y.includes("measures")&&(c=(this.loadResponses[0].query.measures||[]).map((function(e){return Nt(Nt({},i(e)),{},{dataIndex:e})}))),!t.y.length&&t.x.includes("measures")&&c.push({key:"value",dataIndex:"value",title:"Value",shortTitle:"Value",type:"string"}),t.x.map((function(e){return"measures"===e?{key:"measures",dataIndex:"measures",title:"Measures",shortTitle:"Measures",type:"string"}:Nt(Nt({},i(e)),{},{dataIndex:e})})).concat(function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return 0===Object.keys(t).length?[]:Object.values(t).map((function(t){var r=t.key,a=Ne()(t,Bt),o=e(a.children,[].concat(Ue()(n),[r])),c=i(a.memberId),s=c.title,u=c.shortTitle,l=Ne()(c,zt),d=r!==a.memberId||null==s?r:"";return o.length?Nt(Nt({},l),{},{key:r,title:[s,d].join(" ").trim(),shortTitle:d||u,children:o}):Nt(Nt({},l),{},{key:r,dataIndex:[].concat(Ue()(n),[r]).join(),title:[s,d].join(" ").trim(),shortTitle:d||u})}))}(a)).concat(c)}},{key:"totalRow",value:function(e){return this.chartPivot(e)[0]}},{key:"categories",value:function(e){return this.chartPivot(e)}},{key:"seriesNames",value:function(t){var n=this;t=this.normalizePivotConfig(t);var r=Object(nt.a)(Object(dt.a)("annotation"),Object(dt.a)("measures"),pt.a)(this.loadResponses),a=Yt(this.loadResponses.map((function(e,r){return Object(nt.a)(Object(rt.a)(n.axisValues(t.y,r)),Yt,ht.a)(n.timeDimensionBackwardCompatibleData(r))}))),i=new Set;this.queryType===Gt.BLENDING_QUERY&&Object(ut.a)(this.loadResponses.map((function(e){return e.query.measures}))).filter((function(e,t,n){return n.indexOf(e)!==t})).forEach((function(e){return i.add(e)}));return a.map((function(a,o){var c=Lt(a,o,t,i);return{title:n.axisValuesString(t.y.find((function(e){return"measures"===e}))?Object(mt.a)(1,c).concat(r[e.measureFromAxis(a)].title):c,", "),key:n.axisValuesString(c,","),yValues:a}}))}},{key:"query",value:function(){if(this.queryType!==Gt.REGULAR_QUERY)throw new Error("Method is not supported for a '".concat(this.queryType,"' query type. Please use decompose"));return this.loadResponses[0].query}},{key:"pivotQuery",value:function(){return this.loadResponse.pivotQuery||null}},{key:"rawData",value:function(){if(this.queryType!==Gt.REGULAR_QUERY)throw new Error("Method is not supported for a '".concat(this.queryType,"' query type. Please use decompose"));return this.loadResponses[0].data}},{key:"annotation",value:function(){if(this.queryType!==Gt.REGULAR_QUERY)throw new Error("Method is not supported for a '".concat(this.queryType,"' query type. Please use decompose"));return this.loadResponses[0].annotation}},{key:"timeDimensionBackwardCompatibleData",value:function(t){if(void 0===t)throw new Error("resultIndex is required");if(!this.backwardCompatibleData[t]){var n=this.loadResponses[t],r=n.data,a=(n.query.timeDimensions||[]).filter((function(e){return Boolean(e.granularity)}));this.backwardCompatibleData[t]=r.map((function(t){return Nt(Nt({},t),Object(lt.a)(Object.keys(t).filter((function(n){return a.find((function(e){return e.dimension===n}))&&!t[e.timeDimensionMember(a.find((function(e){return e.dimension===n})))]})).map((function(n){return[e.timeDimensionMember(a.find((function(e){return e.dimension===n}))),t[n]]}))))}))}return this.backwardCompatibleData[t]}},{key:"decompose",value:function(){var t=this;return this.loadResponses.map((function(n){return new e({queryType:Gt.REGULAR_QUERY,pivotQuery:Nt(Nt({},n.query),{},{queryType:Gt.REGULAR_QUERY}),results:[n]},t.options)}))}},{key:"serialize",value:function(){return{loadResponse:Object(Xe.a)(this.loadResponse)}}}],[{key:"measureFromAxis",value:function(e){return e[e.length-1]}},{key:"timeDimensionMember",value:function(e){return"".concat(e.dimension,".").concat(e.granularity)}},{key:"deserialize",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new e(t.loadResponse,n)}},{key:"getNormalizedPivotConfig",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r={x:[],y:[],fillMissingDates:!0,joinDateRange:!1},a=t.measures,i=void 0===a?[]:a,o=t.dimensions,c=void 0===o?[]:o,s=(t.timeDimensions||[]).filter((function(e){return!!e.granularity}));n=n||(s.length?{x:s.map((function(t){return e.timeDimensionMember(t)})),y:c}:{x:c,y:[]});var u=function(n){return n.map((function(n){return s.find((function(e){return e.dimension===n}))&&!c.find((function(e){return e===n}))?e.timeDimensionMember(t.timeDimensions.find((function(e){return e.dimension===n}))):n}))};(n=Object(bt.a)(n,r)).x=u(n.x),n.y=u(n.y);var l=n.x.concat(n.y),d=s.map((function(t){return e.timeDimensionMember(t)})).concat(c),b=function(e){return d.includes(e)||"measures"===e};return n.x=n.x.concat(d.filter((function(e){return!l.includes(e)&&"compareDateRange"!==e}))).filter(b),n.y=n.y.filter(b),n.x.concat(n.y).find((function(e){return"measures"===e}))||n.y.push("measures"),c.includes("compareDateRange")&&!n.y.concat(n.x).includes("compareDateRange")&&n.y.unshift("compareDateRange"),i.length||(n.x=n.x.filter((function(e){return"measures"!==e})),n.y=n.y.filter((function(e){return"measures"!==e}))),n}}]),e}(),Ht=function(){function e(t){qe()(this,e),this.sqlQuery=t}return Me()(e,[{key:"rawQuery",value:function(){return this.sqlQuery.sql}},{key:"sql",value:function(){return this.rawQuery().sql[0]}}]),e}(),Zt=function(e){return Object(lt.a)(e.map((function(e){return[e.name,e]})))},$t={string:[{name:"contains",title:"contains"},{name:"notContains",title:"does not contain"},{name:"equals",title:"equals"},{name:"notEquals",title:"does not equal"},{name:"set",title:"is set"},{name:"notSet",title:"is not set"}],number:[{name:"equals",title:"equals"},{name:"notEquals",title:"does not equal"},{name:"set",title:"is set"},{name:"notSet",title:"is not set"},{name:"gt",title:">"},{name:"gte",title:">="},{name:"lt",title:"<"},{name:"lte",title:"<="}],time:[{name:"equals",title:"equals"},{name:"notEquals",title:"does not equal"},{name:"inDateRange",title:"in date range"},{name:"notInDateRange",title:"not in date range"},{name:"afterDate",title:"after date"},{name:"beforeDate",title:"before date"}]},Xt=function(){function e(t){qe()(this,e),this.meta=t;var n=this.meta.cubes;this.cubes=n,this.cubesMap=Object(lt.a)(n.map((function(e){return[e.name,{measures:Zt(e.measures),dimensions:Zt(e.dimensions),segments:Zt(e.segments)}]})))}return Me()(e,[{key:"membersForQuery",value:function(e,t){return Object(ft.a)(this.cubes.map((function(e){return e[t]}))).sort((function(e,t){return e.title>t.title?1:-1}))}},{key:"membersGroupedByCube",value:function(){var e=["measures","dimensions","segments","timeDimensions"];return this.cubes.reduce((function(t,n){return e.forEach((function(e){var r=n[e];"timeDimensions"===e&&(r=n.dimensions.filter((function(e){return"time"===e.type}))),t[e]=[].concat(Ue()(t[e]),[{cubeName:n.name,cubeTitle:n.title,members:r}])})),t}),{measures:[],dimensions:[],segments:[],timeDimensions:[]})}},{key:"resolveMember",value:function(e,t){var n=this,r=e.split("."),a=Ve()(r,1)[0];if(!this.cubesMap[a])return{title:e,error:"Cube not found ".concat(a," for path '").concat(e,"'")};var i=(Array.isArray(t)?t:[t]).map((function(t){return n.cubesMap[a][t]&&n.cubesMap[a][t][e]})).find((function(e){return e}));return i||{title:e,error:"Path not found '".concat(e,"'")}}},{key:"defaultTimeDimensionNameFor",value:function(e){var t=this,n=e.split("."),r=Ve()(n,1)[0];return this.cubesMap[r]?Object.keys(this.cubesMap[r].dimensions||{}).find((function(e){return"time"===t.cubesMap[r].dimensions[e].type})):null}},{key:"filterOperatorsForMember",value:function(e,t){var n=this.resolveMember(e,t);return $t[n.type]||$t.string}}]),e}(),en=function(){function e(t){qe()(this,e),this.progressResponse=t}return Me()(e,[{key:"stage",value:function(){return this.progressResponse.stage}},{key:"timeElapsed",value:function(){return this.progressResponse.timeElapsed}}]),e}(),tn=["baseRequestId"];function nn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nn(Object(n),!0).forEach((function(t){De()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var an=function(){function e(t){var n=t.authorization,r=t.apiUrl,a=t.method,i=t.headers,o=void 0===i?{}:i,c=t.credentials;qe()(this,e),this.authorization=n,this.apiUrl=r,this.method=a,this.headers=o,this.credentials=c}return Me()(e,[{key:"request",value:function(e,t){var n=this,r=t.baseRequestId,a=Ne()(t,tn),i=1,o=new URLSearchParams(a&&Object.keys(a).map((function(e){return De()({},e,"object"===Te()(a[e])?JSON.stringify(a[e]):a[e])})).reduce((function(e,t){return rn(rn({},e),t)}),{})),c="".concat(this.apiUrl,"/").concat(e).concat(o.toString().length?"?".concat(o):""),s=this.method||(c.length<2e3?"GET":"POST");"POST"===s&&(c="".concat(this.apiUrl,"/").concat(e),this.headers["Content-Type"]="application/json");return{subscribe:function(e){var t=this;return Le()(Be.a.mark((function o(){var u;return Be.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,vt()(c,{method:s,headers:rn({Authorization:n.authorization,"x-request-id":r&&"".concat(r,"-span-").concat(i++)},n.headers),credentials:n.credentials,body:"POST"===s?JSON.stringify(a):null});case 2:return u=o.sent,o.abrupt("return",e(u,(function(){return t.subscribe(e)})));case 4:case"end":return o.stop()}}),o)})))()}}}}]),e}();function on(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=wt()(e);if(t){var a=wt()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return xt()(this,n)}}var cn=function(e){gt()(n,e);var t=on(n);function n(e,r){var a;return qe()(this,n),(a=t.call(this,e)).response=r,a}return n}(St()(Error));function sn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function un(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?sn(Object(n),!0).forEach((function(t){De()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ln=0,dn="Mutex has been changed";var bn=function(){function e(t,n){if(qe()(this,e),"object"===Te()(t)&&(n=t,t=void 0),!(n=n||{}).transport&&!n.apiUrl)throw new Error("The `apiUrl` option is required");this.apiToken=t,this.apiUrl=n.apiUrl,this.method=n.method,this.headers=n.headers||{},this.credentials=n.credentials,this.transport=n.transport||new an({authorization:"function"===typeof t?void 0:t,apiUrl:this.apiUrl,method:this.method,headers:this.headers,credentials:this.credentials}),this.pollInterval=n.pollInterval||5,this.parseDateMeasures=n.parseDateMeasures,this.updateAuthorizationPromise=null}return Me()(e,[{key:"request",value:function(e,t){return this.transport.request(e,un({baseRequestId:Object(ze.a)()},t))}},{key:"loadMethod",value:function(e,t,n,r){var a=this,i=++ln;"function"!==typeof n||r||(r=n,n=void 0);var o=(n=n||{}).mutexKey||"default";n.mutexObj&&(n.mutexObj[o]=i);var c=this.updateTransportAuthorization().then((function(){return e()})),s=!0,u=!1,l=function(){var e=Le()(Be.a.mark((function e(){var t;return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c;case 2:if(t=e.sent,!n.mutexObj||n.mutexObj[o]===i){e.next=9;break}if(u=!0,!t.unsubscribe){e.next=8;break}return e.next=8,t.unsubscribe();case 8:throw dn;case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),d=function(){var e=Le()(Be.a.mark((function e(i,o){var d,b,p,h,m,f,j;return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c;case 2:if(d=e.sent,b=function(){var e=Le()(Be.a.mark((function e(){return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.subscribe||u){e.next=8;break}if(!d.unsubscribe){e.next=5;break}return e.abrupt("return",o());case 5:return e.next=7,new Promise((function(e){return setTimeout((function(){return e()}),1e3*a.pollInterval)}));case 7:return e.abrupt("return",o());case 8:return e.abrupt("return",null);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),p=function(){var e=Le()(Be.a.mark((function e(t){return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u){e.next=5;break}if(!t){e.next=4;break}return e.next=4,new Promise((function(e){return setTimeout((function(){return e()}),1e3*a.pollInterval)}));case 4:return e.abrupt("return",o());case 5:return e.abrupt("return",null);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),!n.subscribe||s){e.next=8;break}return e.next=8,a.updateTransportAuthorization();case 8:if(s=!1,502!==i.status){e.next=13;break}return e.next=12,l();case 12:return e.abrupt("return",p(!0));case 13:return h={},m="",e.prev=15,e.next=18,i.text();case 18:m=e.sent,h=JSON.parse(m),e.next=25;break;case 22:e.prev=22,e.t0=e.catch(15),h.error=m;case 25:if("Continue wait"!==h.error){e.next=30;break}return e.next=28,l();case 28:return n.progressCallback&&n.progressCallback(new en(h)),e.abrupt("return",p());case 30:if(200===i.status){e.next=43;break}return e.next=33,l();case 33:if(n.subscribe||!d.unsubscribe){e.next=36;break}return e.next=36,d.unsubscribe();case 36:if(f=new cn(h.error,h),!r){e.next=41;break}r(f),e.next=42;break;case 41:throw f;case 42:return e.abrupt("return",b());case 43:return e.next=45,l();case 45:if(n.subscribe||!d.unsubscribe){e.next=48;break}return e.next=48,d.unsubscribe();case 48:if(j=t(h),!r){e.next=53;break}r(null,j),e.next=54;break;case 53:return e.abrupt("return",j);case 54:return e.abrupt("return",b());case 55:case"end":return e.stop()}}),e,null,[[15,22]])})));return function(t,n){return e.apply(this,arguments)}}(),b=c.then((function(e){return function(e){return new Promise(function(){var t=Le()(Be.a.mark((function t(n,r){return Be.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.t0=n,t.next=4,e;case 4:t.t1=t.sent,(0,t.t0)(t.t1),t.next=11;break;case 8:t.prev=8,t.t2=t.catch(0),t.t2!==dn&&r(t.t2);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,n){return t.apply(this,arguments)}}())}(e.subscribe(d))}));return r?{unsubscribe:function(){var e=Le()(Be.a.mark((function e(){var t;return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c;case 2:if(t=e.sent,u=!0,!t.unsubscribe){e.next=6;break}return e.abrupt("return",t.unsubscribe());case 6:return e.abrupt("return",null);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}:b}},{key:"updateTransportAuthorization",value:function(){var e=Le()(Be.a.mark((function e(){var t=this;return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.updateAuthorizationPromise){e.next=4;break}return e.next=3,this.updateAuthorizationPromise;case 3:return e.abrupt("return");case 4:if("function"!==typeof this.apiToken){e.next=8;break}return this.updateAuthorizationPromise=new Promise(function(){var e=Le()(Be.a.mark((function e(n,r){var a;return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.apiToken();case 3:a=e.sent,t.transport.authorization!==a&&(t.transport.authorization=a),n(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),r(e.t0);case 11:return e.prev=11,t.updateAuthorizationPromise=null,e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[0,8,11,14]])})));return function(t,n){return e.apply(this,arguments)}}()),e.next=8,this.updateAuthorizationPromise;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"load",value:function(e,t,n){var r=this;return this.loadMethod((function(){return r.request("load",{query:e,queryType:"multi"})}),(function(e){return new Wt(e,{parseDateMeasures:r.parseDateMeasures})}),t,n)}},{key:"sql",value:function(e,t,n){var r=this;return this.loadMethod((function(){return r.request("sql",{query:e})}),(function(e){return Array.isArray(e)?e.map((function(e){return new Ht(e)})):new Ht(e)}),t,n)}},{key:"meta",value:function(e,t){var n=this;return this.loadMethod((function(){return n.request("meta")}),(function(e){return new Xt(e)}),e,t)}},{key:"dryRun",value:function(e,t,n){var r=this;return this.loadMethod((function(){return r.request("dry-run",{query:e})}),(function(e){return e}),t,n)}},{key:"subscribe",value:function(e,t,n){var r=this;return this.loadMethod((function(){return r.request("subscribe",{query:e,queryType:"multi"})}),(function(e){return new Wt(e,{parseDateMeasures:r.parseDateMeasures})}),un(un({},t),{},{subscribe:!0}),n)}}]),e}(),pn=function(e,t){return new bn(e,t)};var hn=n(49),mn=["retries"];function fn(e){var t=[];return e.forEach((function(e){return e.members.forEach((function(e){t.push([e.name,e])}))})),t}function jn(e){var t={};return Object.entries(e).forEach((function(e){var n=Object(Q.a)(e,2),r=n[0];n[1].forEach((function(e){t[e.cubeName]||(t[e.cubeName]={cubeName:e.cubeName,cubeTitle:e.cubeTitle,measures:[],dimensions:[],segments:[],timeDimensions:[]}),e.members.forEach((function(n){t[e.cubeName]=Object(b.a)(Object(b.a)({},t[e.cubeName]),{},Object(ce.a)({},r,[].concat(Object(hn.a)(t[e.cubeName][r]),[n])))}))}))})),Object.values(t)}function vn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.retries,r=void 0===n?0:n,a=Object(h.a)(t,mn);return fetch(e,a).then(function(){var e=Object(p.a)(d.a.mark((function e(t){var n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(500!==t.status){e.next=6;break}return e.next=3,t.text();case 3:n=e.sent;try{r=JSON.parse(n),n=r.error}catch(a){}throw n;case 6:return e.abrupt("return",t);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(n){if("Network request failed"===n.message&&r>0)return vn(e,{options:t,retries:r-1});throw n}))}function yn(e){return gn.apply(this,arguments)}function gn(){return(gn=Object(p.a)(d.a.mark((function e(t){var n,r,a,i,o,c,s=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:"GET",r=s.length>2&&void 0!==s[2]?s[2]:{},a=r.body,i=r.token,o={},i&&(o.authorization=i),e.next=7,fetch(t,Object(b.a)({method:n,headers:Object(b.a)({"Content-Type":"application/json"},o)},a?{body:JSON.stringify(a)}:null));case 7:return c=e.sent,e.t0=c.ok,e.next=11,c.json();case 11:return e.t1=e.sent,e.abrupt("return",{ok:e.t0,json:e.t1});case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function On(e){var t,n=e.url,r=e.title,a=void 0===r?"":r,i=e.width,o=void 0===i?640:i,c=e.height,s=void 0===c?720:c,u=void 0!==window.screenLeft?window.screenLeft:window.screenX,l=void 0!==window.screenTop?window.screenTop:window.screenY,d=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,b=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,p=d/window.screen.availWidth,h=(d-o)/2/p+u,m=(b-s)/2/p+l,f=window.open(n,a,"\n      scrollbars=yes,\n      width=".concat(o/p,", \n      height=").concat(s/p,", \n      top=").concat(m,", \n      left=").concat(h,"\n    "));return null===f||void 0===f||null===(t=f.focus)||void 0===t||t.call(f),f}var xn=Object(w.createContext)(null);function kn(e){var t=e.disabled,n=void 0!==t&&t,r=e.children,a=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Object(w.useRef)(!1),n=Object(w.useState)(null),r=Object(Q.a)(n,2),a=r[0],i=r[1],o=Object(w.useState)({loading:!0,active:!1,deploymentUrl:null}),c=Object(Q.a)(o,2),s=c[0],u=c[1];Object(w.useEffect)((function(){if(!e){var t=setInterval((function(){l()}),5e3);return l(),function(){clearInterval(t)}}}),[]),Object(w.useEffect)((function(){s.loading||t.current===s.active||m(),t.current=s.active}),[t,s.active,s.loading]);var l=function(){return fetch("/playground/live-preview/status").then((function(e){return e.json()})).then((function(e){u(Object(b.a)({loading:!1},e))}))},h=function(){var e=Object(p.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/playground/live-preview/token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 2:return n=e.sent,e.abrupt("return",n.json());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=Object(p.a)(d.a.mark((function e(){var t,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===s||void 0===s?void 0:s.active)){e.next=8;break}return e.next=3,h({});case 3:t=e.sent,n=t.token,i({token:(null===n||void 0===n?void 0:n.token)||null,apiUrl:(null===s||void 0===s?void 0:s.deploymentUrl)||null}),e.next=9;break;case 8:i(null);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return{credentials:a,statusLivePreview:s,createTokenWithPayload:h,stopLivePreview:function(){var e=Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/playground/live-preview/stop");case 2:return e.next=4,l();case 4:return e.abrupt("return",!0);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),startLivePreview:function(){return new Promise((function(e,t){var n=encodeURIComponent(window.location.origin),r="http://localhost:4000"!==window.location.origin&&new URLSearchParams({callbackUrl:n}).toString(),a=On({url:"https://cubecloud.dev/auth/live-preview".concat(r?"?".concat(r):"")});if(!a)return console.error("The popup was blocked by the browser"),void t();var i=setInterval((function(){a.closed&&(clearInterval(i),e(!0),l())}),1e3)}))}}}(n);return Object(_.jsx)(xn.Provider,{value:Object(b.a)(Object(b.a)({},a),{},{livePreviewDisabled:n}),children:r})}function wn(){return Object(w.useContext)(xn)}var Cn=n(471),Sn=["children"],An=Object(w.createContext)({});function Dn(e){var t=e.children,n=Object(h.a)(e,Sn),r=Object(w.useState)(n||null),a=Object(Q.a)(r,2),i=a[0],o=a[1],c=Object(w.useCallback)((function(e){o((function(t){return Object(b.a)(Object(b.a)(Object(b.a)({},t),e),{},{playgroundContext:Object(b.a)(Object(b.a)({},null===t||void 0===t?void 0:t.playgroundContext),null===e||void 0===e?void 0:e.playgroundContext)})}))}),[]);return Object(_.jsx)(An.Provider,{value:Object(b.a)(Object(b.a)({apiUrl:null,schemaVersion:0,ready:!1},i),{},{token:(null===i||void 0===i?void 0:i.token)||null,playgroundContext:(null===i||void 0===i?void 0:i.playgroundContext)||{},setContext:c}),children:t})}function En(e){var t=e.onReady,n=Tn();return Object(w.useEffect)((function(){t(n)}),[n]),null}function Tn(){return Object(w.useContext)(An)}function Pn(){return Tn().playgroundContext}var qn=new(function(){function e(){var t=this;Object(y.a)(this,e),this.emitter=Object(Cn.a)(),window.addEventListener("storage",(function(e){if(e.oldValue!==e.newValue){var n;try{n=JSON.parse(e.newValue||"")}catch(r){n=e.newValue}t.emit(e.key,n)}}))}return Object(g.a)(e,[{key:"emit",value:function(e,t){this.emitter.emit(e,t)}},{key:"subscribe",value:function(e,t){this.emitter.on(e,t)}},{key:"unsubscribe",value:function(e,t){this.emitter.off(e,t)}},{key:"setItem",value:function(e,t){if(void 0===t)localStorage.removeItem(e);else{var n=JSON.stringify(t);localStorage.setItem(e,n)}this.emit(e,t)}},{key:"getItem",value:function(e,t){try{var n=localStorage.getItem(e),r="string"===typeof n?JSON.parse(n):void 0;return"function"===typeof t?t(r):void 0!==r?r:t}catch(a){return"function"===typeof t?t(null):t}}},{key:"removeItem",value:function(e){this.setItem(e,void 0)}}]),e}());function Rn(e,t){var n=Tn().identifier||"",r=[e,n?":":"",n].join(""),a=function(){return qn.getItem(r,t)},i=Object(w.useState)(a),o=Object(Q.a)(i,2),c=o[0],s=o[1];return Object(w.useEffect)((function(){return s(a),qn.subscribe(r,(function(e){s("function"===typeof t?t(e):e||t)})),function(){qn.unsubscribe(r,s)}}),[r]),Object(w.useMemo)((function(){return[c,function(e){return qn.setItem(r,e),e},function(){qn.removeItem(r)}]}),[r,c])}function Mn(){var e=Object(w.useRef)(!0),t=Object(w.useCallback)((function(){return e.current}),[]);return Object(w.useEffect)((function(){return function(){e.current=!1}}),[]),t}function In(e){var t=Object(w.useRef)();return H()(t.current,e)||(t.current=e),t.current}function Ln(e,t){var n=In(t);return Object(w.useEffect)(e,n)}function _n(e,t){var n=In(t);return Object(w.useMemo)(e,n)}var Bn,zn=["label","value","onCopyClick"],Fn=Object(D.d)(Y.a)(Bn||(Bn=Object(k.a)(["\n  border: none;\n  color: var(--primary-1);\n"])));function Nn(e){var t=e.label,n=e.value,r=e.onCopyClick,a=Object(h.a)(e,zn),i=Object(_.jsx)(Fn,{"data-testid":"localhost-tipbox-".concat(null===t||void 0===t?void 0:t.toLowerCase(),"-copy-btn"),icon:Object(_.jsx)(ie.a,{}),onClick:function(){return n&&r(n.toString())}});return Object(_.jsx)(te.a.Item,{label:t?Object(_.jsx)("b",{children:t}):null,labelCol:{span:24},wrapperCol:{span:24},children:Object(_.jsx)(ee.a,Object(b.a)({"data-testid":"localhost-tipbox-".concat(null===t||void 0===t?void 0:t.toLowerCase(),"-input"),value:n,suffix:i},a))})}var Qn=n(80),Un=n(207);function Kn(e){var t=e.status,n=e.uploading,r={loading:Object(_.jsx)(Qn.a,{spin:!0}),inProgress:Object(_.jsx)(Qn.a,{spin:!0}),running:Object(_.jsx)(Un.a,{})};return n?r.loading:r[t]||r.loading}var Vn;function Yn(){var e,t=wn(),n=Object(w.useState)(!1),r=Object(Q.a)(n,2),a=r[0],i=r[1];if(!t||(null===t||void 0===t?void 0:t.livePreviewDisabled))return null;var o=t.statusLivePreview,c=o.active,s=o.status,u=o.uploading,l=Object(_.jsxs)(N,{"data-testid":"live-preview-btn",onClick:function(){c||t.startLivePreview()},children:[c?Object(_.jsx)(Kn,{status:s,uploading:u}):Object(_.jsx)(U.a,{}),c?"Running":"Run"," on Cube Cloud"]});return c?Object(_.jsx)(R.a,{overlay:Object(_.jsx)(Jn,{livePreviewStatus:t.statusLivePreview,apiUrl:(null===(e=t.credentials)||void 0===e?void 0:e.apiUrl)||"",loading:a,onStopClick:Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i(!0),e.next=3,t.stopLivePreview();case 3:i(!1);case 4:case"end":return e.stop()}}),e)})))}),trigger:["click"],children:l}):l}function Jn(e){var t=e.livePreviewStatus,n=e.apiUrl,r=e.loading,a=e.onStopClick,i=t.url,o=t.deploymentId;return Object(_.jsx)(K.a,{style:{maxWidth:600},children:Object(_.jsxs)(J,{direction:"column",gap:2,children:[Object(_.jsxs)(V.a.Paragraph,{children:["Playground uses the following API URL to execute queries on Cloud. You can use this API to test queries in your application."," ",Object(_.jsx)(V.a.Link,{href:"https://cube.dev/docs/cloud",target:"_blank",children:"Learn more"})," ","on developing and testing with Cube Cloud."]}),Object(_.jsx)(Nn,{value:n,onCopyClick:he}),Object(_.jsx)(G,{children:Object(_.jsxs)(J,{justifyContent:"space-between",children:[Object(_.jsx)(Y.a,{type:"primary",target:"_blank",href:"".concat(i,"/deployments/").concat(o,"/history"),children:"Inspect queries"}),Object(_.jsx)(Y.a,{type:"primary",danger:!0,loading:r,onClick:a,children:"Stop"})]})})]})})}var Gn=Object(D.d)(S.a.Header)(Vn||(Vn=Object(k.a)(["\n  && {\n    background-color: var(--dark-02-color);\n    color: white;\n    padding: 0 16px;\n    line-height: 44px;\n    height: 48px;\n  }\n"])));function Wn(e){var t=e.selectedKeys,n=Object(I.useMediaQuery)({query:"(min-device-width: 992px)"}),r=Object(I.useMediaQuery)({query:"(max-device-width: 991px)"});return Object(_.jsxs)(Gn,{children:[Object(_.jsx)("div",{style:{float:"left"},children:Object(_.jsx)("img",{src:"./cubejs-playground-logo.svg",style:{height:28,marginRight:28},alt:""})}),n&&Object(_.jsxs)(z,{theme:"light",mode:"horizontal",selectedKeys:t,children:[Object(_.jsx)(F,{children:Object(_.jsx)(L.a,{to:"/build",children:"Build"})},"/build"),Object(_.jsx)(F,{children:Object(_.jsx)(L.a,{to:"/dashboard",children:"Dashboard App"})},"/dashboard"),Object(_.jsx)(F,{children:Object(_.jsx)(L.a,{to:"/schema",children:"Schema"})},"/schema"),Object(_.jsxs)(N,{href:"https://slack.cube.dev",target:"_blank",children:[Object(_.jsx)(E.a,{}),"Slack"]},"slack"),Object(_.jsxs)(N,{noMargin:!0,href:"https://forum.cube.dev/",target:"_blank",children:[Object(_.jsx)(T.a,{component:function(){return Object(_.jsx)(B,{})}}),"Discourse"]},"discourse"),Object(_.jsxs)(N,{href:"https://cube.dev/docs",target:"_blank",children:[Object(_.jsx)(P.a,{}),"Docs"]},"docs"),Object(_.jsx)(Yn,{})]}),r&&Object(_.jsx)("div",{style:{float:"right"},children:Object(_.jsx)(R.a,{overlay:Object(_.jsxs)(M.a,{children:[Object(_.jsx)(M.a.Item,{children:Object(_.jsx)(L.a,{to:"/build",children:"Build"})},"/build"),Object(_.jsx)(M.a.Item,{children:Object(_.jsx)(L.a,{to:"/dashboard",children:"Dashboard App"})},"/dashboard"),Object(_.jsx)(M.a.Item,{children:Object(_.jsx)(L.a,{to:"/schema",children:"Schema"})},"/schema")]}),children:Object(_.jsx)(q.a,{})})})]})}var Hn={pink:"255, 100, 146",purple:"122, 119, 255","purple-03":"175, 173, 255","purple-04":"202, 201, 255",text:"91, 92, 125","dark-01":"20, 20, 70","dark-02":"67, 67, 107","dark-03":"114, 114, 144","dark-04":"161, 161, 181","dark-05":"213, 213, 226",light:"243, 243, 251",green:"65, 181, 111",yellow:"251, 188, 5",gray:"246, 246, 248"};function Zn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return"rgba(".concat(Hn[e],", ").concat(t,")")}var $n={"active-bg":Zn("purple",.1),"primary-bg":Zn("purple",.1),"primary-1":Zn("purple",.9),"primary-2":Zn("purple",.8),"primary-3":Zn("purple",.7),"primary-4":Zn("purple",.6),"primary-5":Zn("purple",.5),"primary-6":Zn("purple",.4),"primary-7":Zn("purple",.3),"primary-8":Zn("purple",.2),"primary-9":Zn("purple",.1),"primary-10":Zn("purple",0),"light-5":Zn("light",.5),"remove-btn-bg":Zn("purple",.1),"remove-btn-hover-bg":Zn("purple",.2),"primary-color":Zn("purple"),"success-bg-color":Zn("green",.1),"success-color":Zn("green",.9),"warning-bg-color":Zn("yellow",.1),"warning-color":Zn("yellow",.9),"pink-8":Zn("pink",.2),"pink-9":Zn("pink",.1),"heading-color":Zn("dark",.65),"link-color":Zn("purple"),"info-color":Zn("purple"),"layout-body-background":"#f6f6f8;","layout-header-background":"#eeeef5","menu-highlight-color":Zn("dark-01"),"item-hover-bg":Zn("light"),"layout-header-height":"48px","font-family":'Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", "Avenir Next", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif',"menu-item-font-size":"15px","btn-primary-shadow":"none","btn-text-shadow":"none","modal-body-padding":"32px","form-item-margin-bottom":"23px","disabled-color":Zn("dark-01",.25),"disabled-bg":Zn("dark-05",.2),"menu-item-active-bg":Zn("light"),"font-size-base":"14px","border-radius-base":"4px","padding-lg":"16px"};Object.keys(Hn).forEach((function(e){return $n["".concat(e,"-color")]=Zn(e)}));var Xn,er={},tr={};Object.keys($n).forEach((function(e){er["@".concat(e)]=$n[e]})),Object.keys($n).forEach((function(e){tr["--".concat(e)]=$n[e]}));var nr,rr,ar=Object(D.b)(Xn||(Xn=Object(k.a)(["\n  body {\n    ",'\n  }\n\n  body {\n    margin: 0;\n    padding: 0;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    background: var(--layout-body-background);\n    overflow-x: hidden;\n  }\n\n  .inline-code {\n    margin: 0 1px;\n    padding: 0.2em 0.4em;\n    font-size: 0.9em;\n    background: #f2f4f5;\n    border: 1px solid #eee;\n    border-radius: 3px;\n  }\n  \n  .ant-dropdown-menu::-webkit-scrollbar-track {\n    background: var(--light-color);\n  }\n  \n  .ant-dropdown-menu::-webkit-scrollbar-thumb {\n    border-radius: 4px;\n    background: var(--dark-03-color);\n  }\n  \n  .ant-dropdown-menu::-webkit-scrollbar {\n    width: 8px;\n    height: 8px;\n  } \n  \n  .schema-sidebar .ant-tabs-top-bar {\n    padding: 0 16px;\n  }\n  \n  .schema-sidebar .ant-menu {\n    border: 0;\n  }\n  \n  .ant-layout {\n    height: 100%;\n    background: var(--layout-body-background);\n  }\n  \n  .ant-layout-header .ant-menu {\n    height: 100%;\n  }\n  \n  .ant-menu-horizontal .ant-menu-item {\n    top: 0;\n    height: 100%;\n  }\n  \n  .ant-select-item.ant-select-item-option-selected:not(.ant-select-item-option-disabled) {\n    color: white;\n  }\n  \n  .ant-popover .ant-popover-inner-content {\n    padding: 0;\n  }\n  \n  \n  code[class*="language-"],\n  pre[class*="language-"] {\n    color: var(--dark-01-color);\n    background: none;\n    /*text-shadow: 0 1px white;*/\n    font-family: "Roboto Mono", Monaco, \'Andale Mono\', \'Ubuntu Mono\', monospace;\n    text-align: left;\n    font-weight: normal;\n    font-size: 14px;\n    line-height: 20px;\n    white-space: pre;\n    word-spacing: normal;\n    word-break: normal;\n    word-wrap: normal;\n    border-radius: 4px;\n    border: none;\n  \n    -moz-tab-size: 4;\n    -o-tab-size: 4;\n    tab-size: 4;\n  \n    -webkit-hyphens: none;\n    -moz-hyphens: none;\n    -ms-hyphens: none;\n    hyphens: none;\n  }\n\n  code {\n    font-family: source-code-pro, Menlo, Monaco, Consolas, "Courier New",\n    monospace;\n  }\n\n  .schema-sidebar,\n  .schema-sidebar .ant-tabs,\n  .schema-sidebar .ant-tabs-content {\n    height: 100%;\n  }\n\n  .schema-sidebar {\n    background: #fff;\n    border-right: 1px solid #eee;\n    padding: 0;\n  }\n\n  .schema-sidebar .ant-tabs-tabpane {\n    /* TODO: replace with flexbox */\n    height: 85%;\n    overflow: auto;\n  }\n\n  .ant-popover-disabled-compatible-wrapper {\n    pointer-events: none;\n  }\n  \n  pre[class*="language-"]::-moz-selection, pre[class*="language-"] ::-moz-selection,\n  code[class*="language-"]::-moz-selection, code[class*="language-"] ::-moz-selection {\n    text-shadow: none;\n    /*background: #b3d4fc;*/\n  }\n  \n  pre[class*="language-"]::selection, pre[class*="language-"] ::selection,\n  code[class*="language-"]::selection, code[class*="language-"] ::selection {\n    text-shadow: none;\n    /*background: #b3d4fc;*/\n  }\n  \n  @media print {\n    code[class*="language-"],\n    pre[class*="language-"] {\n      text-shadow: none;\n    }\n  }\n  \n  /* Code blocks */\n  pre[class*="language-"] {\n    padding: 1em;\n    overflow: auto;\n  }\n  \n  :not(pre) > code[class*="language-"],\n  pre[class*="language-"] {\n    background: transparent;\n  }\n  \n  /* Inline code */\n  :not(pre) > code[class*="language-"] {\n    padding: .1em;\n    border-radius: .3em;\n    white-space: normal;\n  }\n  \n  .token.comment,\n  .token.prolog,\n  .token.doctype,\n  .token.cdata {\n    color: var(--dark-04-color);\n  }\n  \n  .token.punctuation {\n    color: var(--dark-04-color);\n  }\n  \n  .namespace {\n    opacity: .7;\n  }\n  \n  .token.property,\n  .token.tag,\n  .token.boolean,\n  .token.number,\n  .token.constant,\n  .token.symbol,\n  .token.deleted {\n    color: var(--pink-color);\n  }\n  \n  .token.selector,\n  .token.attr-name,\n  .token.string,\n  .token.char,\n  .token.builtin,\n  .token.inserted {\n    color: var(--purple-color);\n  }\n  \n  .token.operator,\n  .token.entity,\n  .token.url,\n  .language-css .token.string,\n  .style .token.string {\n    color: var(--dark-01-color);\n  }\n  \n  .token.atrule,\n  .token.attr-value,\n  .token.keyword {\n    color: var(--dark-01-color);\n  }\n  \n  .token.atrule,\n  .token.keyword {\n    font-weight: 500;\n  }\n  \n  .token.function,\n  .token.class-name {\n    color: var(--pink-color);\n  }\n  \n  .token.regex,\n  .token.important,\n  .token.variable {\n    color: var(--pink-color);\n  }\n  \n  .token.important,\n  .token.bold {\n    font-weight: bold;\n  }\n  \n  .token.italic {\n    font-style: italic;\n  }\n  \n  .token.entity {\n    cursor: help;\n  }\n  \n  .missing-member-tooltip {\n    max-width: none;\n  }\n  \n  .ant-btn-link > span {\n    text-decoration: underline;\n  }\n  \n  a.ant-typography {\n    text-decoration: underline;\n  }\n  \n  .ant-notification {\n    z-index: 9999;\n  }\n  \n  .ant-modal-header {\n    padding: 16px 24px;\n  }\n  \n  .ant-modal-body {\n    padding: 24px;\n  }\n'])),Object.entries(tr).map((function(e){var t=Object(Q.a)(e,2),n=t[0],r=t[1];return"".concat(n,": ").concat(r,";")})).join("\n    ")),ir={error:{border:"#FFCCC7",background:"rgb(255, 100, 109, 0.05)",color:"#EF404A"},warning:{border:"#FFE58F",background:"#FFFBE6"},info:{border:"#91D5FF",background:"#E6F7FF"},success:{border:"#B7EB8F",background:"#F6FFED"}},or=Object(D.d)(A.a)(nr||(nr=Object(k.a)(["\n  && {\n    background: ",";\n    border: 1px solid ",";\n    color: ",";\n    box-sizing: border-box;\n    border-radius: 2px;\n  }\n"])),(function(e){return ir[e.type||"info"].background}),(function(e){return ir[e.type||"info"].border}),(function(e){var t;return e.type&&(null===(t=ir[e.type])||void 0===t?void 0:t.color)||"inherit"})),cr=[[49,.5],[0,25],[49,49],[98,25]];function sr(e){return"transform: translate(".concat(cr[e][0],"%, ").concat(cr[e][1],"%);")}var ur,lr=D.d.img((function(e){var t=e.index;return"\n  display: block;\n  position: absolute;\n  width: 50%;\n  height: 50%;\n  \n  ".concat(null!=t?"\n  animation-name: dice".concat(t,";\n  animation-duration: 2s;\n  animation-iteration-count: infinite;\n  animation-timing-function: ease;\n  z-index: 0;\n  \n  @keyframes dice").concat(t," {\n    ").concat(0===t?"\n    from {\n      ".concat(sr(0),"\n      z-index: 0;\n    }\n    \n    25% {\n      ").concat(sr(0),"\n      z-index: 0;\n    }\n    \n    50% {\n      ").concat(sr(1),"\n      z-index: 0;\n    }\n    \n    51% {\n      z-index: 1;\n    }\n    \n    75% {\n      z-index: 1;\n    }\n\n    to {\n      ").concat(sr(1),"\n      z-index: 1;\n    }\n    "):"","\n    \n    ").concat(1===t?"\n    from {\n      ".concat(sr(1),"\n      z-index: 3;\n    }\n    \n    25% {\n      ").concat(sr(2),"\n      z-index: 3;\n    }\n    \n    75% {\n      ").concat(sr(2),"\n      z-index: 2;\n    }\n    \n    to {\n      ").concat(sr(3),"\n      z-index: 1;\n    }\n    "):"","\n    \n    ").concat(2===t?"\n    from {\n      ".concat(sr(3),"\n      z-index: 1;\n    }\n    \n    50% {\n      ").concat(sr(3),"\n      z-index: 0;\n    }\n    \n    75% {\n      ").concat(sr(0),"\n      z-index: 0;\n    }\n\n    to {\n      ").concat(sr(0),"\n      z-index: 0;\n    }\n    "):"","\n  }\n  "):"","\n")})),dr=function(e){return Object(_.jsx)(lr,Object(b.a)({role:"presentation",src:"data:image/svg+xml,%3Csvg width='36' height='41' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M35.899 10.351l-18 10.25L.1 10.25l18-10.25L35.9 10.351z' fill='%23FAFAFF'/%3E%3Cpath d='M18 41L0 30.75l.101-20.5L18 20.5' fill='%23E5E5F6'/%3E%3Cpath d='M36 30.75L18 41V20.6l17.899-10.25L36 30.75z' fill='%23C0C0EA'/%3E%3C/svg%3E",alt:""},e))},br=D.d.div(rr||(rr=Object(k.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n"])));function pr(e){var t=e.size,n=void 0===t?80:t,r=e.full,a=void 0===r||r,i=Object(_.jsxs)("div",{"data-testid":"cube-loader",role:"img","aria-label":"Loading animation",style:{position:"relative",width:n,height:1.1388888889*n,margin:"0 auto"},children:[Object(_.jsx)(dr,{style:{transform:"translate(0%, 72.5%)"}}),Object(_.jsx)(dr,{style:{transform:"translate(98%, 72.5%)"}}),Object(_.jsx)(dr,{style:{transform:"translate(49%, 96.5%)"}}),Object(_.jsx)(dr,{index:0}),Object(_.jsx)(dr,{index:1}),Object(_.jsx)(dr,{index:2})]},"loader");return a?Object(_.jsx)(br,{children:i}):i}var hr,mr,fr=V.a.Text,jr=V.a.Paragraph,vr=D.d.pre(ur||(ur=Object(k.a)(["\n  padding: 0.4em 0.8em;\n  font-size: 13px;\n  white-space: pre-wrap;\n  margin: 0;\n"])));function yr(e){var t=e.error;return Object(_.jsxs)(re.b,{direction:"vertical",children:[Object(_.jsx)(fr,{strong:!0,style:{fontSize:18},children:"Error \ud83d\ude22"}),Object(_.jsxs)(jr,{children:["Ask about it in"," ",Object(_.jsx)("a",{href:"https://slack.cube.dev",target:"_blank",rel:"noopener noreferrer",children:"Slack"}),". These guys know how to fix this for sure!"]}),Object(_.jsx)(or,{type:"error",message:Object(_.jsx)(vr,{dangerouslySetInnerHTML:{__html:t.toString().replace(/(Error:\s){2,}/g,"")}})})]})}var gr,Or=Object(D.d)(Y.a)(hr||(hr=Object(k.a)(["\n  &&:not(.ant-btn-link) {\n    padding: 5px 12px;\n    height: auto;\n    border-color: var(--dark-05-color);\n    color: var(--text-color);\n    box-shadow: none;\n\n    &:hover,\n    &:active,\n    &:focus {\n      border-color: var(--purple-04-color);\n      color: var(--primary-color);\n    }\n\n    &:disabled {\n      color: var(--disabled-color);\n      border-color: var(--disabled-color);\n      background-color: white;\n\n      &:hover,\n      &:active,\n      &:focus {\n        color: var(--disabled-color);\n        border-color: var(--disabled-color);\n      }\n    }\n\n    &.ant-btn-primary:not([disabled]) {\n      background: var(--primary-color);\n      color: white;\n      border-color: var(--primary-color);\n      place-self: center;\n    }\n\n    &.ant-btn-background-ghost:not([disabled]) {\n      color: var(--primary-color);\n    }\n\n    &.ant-btn-icon-only {\n      display: inline-flex;\n      place-items: center;\n      padding: 5px 8px;\n      font-size: 14px;\n\n      svg {\n        width: 15px;\n        height: 14px;\n      }\n    }\n\n    .anticon {\n      display: inline-block;\n      height: 14px;\n    }\n\n    &.ant-btn-sm {\n      padding: 0 8px;\n      height: 24px !important;\n    }\n  }\n"])));Or.Group=Object(D.d)(Y.a.Group)(mr||(mr=Object(k.a)(["\n  &&& .ant-btn-primary:not([disabled]) {\n    background-color: var(--primary-bg);\n    color: var(--primary-color);\n    border: 1px solid var(--primary-color);\n\n    &:not(:first-child):not(:last-child) {\n      border-left-color: var(--primary-color);\n      border-right-color: var(--primary-color);\n    }\n\n    &:first-child {\n      border-right-color: var(--primary-color);\n    }\n\n    &:last-child {\n      border-left-color: var(--primary-color);\n    }\n  }\n\n  &&\n    .ant-btn-primary:not([disabled])\n    + .ant-btn:not(.ant-btn-primary):not([disabled]) {\n    border-left-color: var(--primary-color);\n\n    &:hover,\n    &:active,\n    &:focus {\n      border-left-color: var(--primary-color);\n    }\n  }\n\n  &&& .ant-btn:disabled {\n    background-color: var(--disabled-bg);\n  }\n"])));var xr,kr,wr,Cr=Object(D.d)(K.a)(gr||(gr=Object(k.a)(["\n  && {\n    border-radius: 8px;\n    border: none;\n\n    .ant-card-head {\n      border-bottom: 1px solid #d7d7f488;\n      padding: 8px 16px;\n    }\n\n    .ant-card-head-title {\n      padding: 0;\n      flex: initial;\n    }\n\n    .ant-card-extra {\n      padding: 0;\n    }\n\n    .ant-card-head-wrapper {\n      flex-flow: row wrap;\n      place-content: space-between;\n    }\n\n    .ant-card-head-title {\n      font-size: 18px;\n      line-height: 40px;\n    }\n\n    .ant-card-body {\n      padding: 16px;\n    }\n  }\n"]))),Sr=n(852),Ar=Object(D.d)(Sr.a)(xr||(xr=Object(k.a)(["\n  && {\n    .ant-popover-inner-content {\n      padding: 0;\n    }\n  }\n"]))),Dr=n(366),Er=n.n(Dr),Tr=function(e){Object(O.a)(n,e);var t=Object(x.a)(n);function n(){return Object(y.a)(this,n),t.apply(this,arguments)}return Object(g.a)(n,[{key:"componentDidMount",value:function(){Er.a.highlightAll()}},{key:"componentDidUpdate",value:function(){Er.a.highlightAll()}},{key:"render",value:function(){return Object(_.jsx)("pre",{style:this.props.style,children:Object(_.jsx)("code",{"data-testid":"prism-code",className:"language-".concat(this.props.language||"javascript"),children:this.props.code})})}}]),n}(w.Component),Pr=D.d.div(kr||(kr=Object(k.a)(["\n  display: flex;\n  border-radius: 4px;\n  background: ",";\n  width: 100%;\n  max-width: 100%;\n"])),(function(e){return e.theme.background})),qr=D.d.div(wr||(wr=Object(k.a)(["\n  position: relative;\n\n  button,\n  button:hover,\n  button:focus {\n    border: none;\n    background: none;\n    box-shadow: none;\n    outline: none;\n    color: var(--primary-color);\n  }\n\n  [ant-click-animating-without-extra-node]:after {\n    animation: none !important;\n  }\n\n  ::after {\n    display: block;\n    content: '';\n    width: 16px;\n    position: absolute;\n    left: -16px;\n    top: 0;\n    bottom: 0;\n    background: linear-gradient(\n      to right,\n      ",",\n      ","\n    );\n  }\n"])),(function(e){return"".concat(e.theme.background,"00")}),(function(e){return e.theme.background}));function Rr(e){var t=e.code,n=e.language,r=e.style,a=e.copyMessage,i=e.theme,o=void 0===i?"dark":i;return Object(_.jsx)(D.a,{theme:{background:"dark"===o?"#F6F6F8":"#FFFFFF"},children:Object(_.jsxs)(Pr,{style:r,children:[Object(_.jsx)(Tr,{code:t,language:n,style:{flexGrow:1}}),Object(_.jsx)(qr,{children:Object(_.jsx)(Y.a,{icon:Object(_.jsx)(ie.a,{}),onClick:function(){return he(t,a||"Copied")}})})]})})}var Mr,Ir,Lr=n(367),_r=n.n(Lr),Br=null,zr=[],Fr={sentFrom:"frontend"},Nr=null,Qr=function(){var e=Object(p.a)(d.a.mark((function e(t){var n,r,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0===Mr){e.next=2;break}return e.abrupt("return");case 2:return(n=localStorage.getItem("playground_anonymous"))||(n=_r.a.get("playground_anonymous")||Object(ze.a)().toString(),localStorage.setItem("playground_anonymous",n),_r.a.remove("playground_anonymous")),zr.push(Object(b.a)(Object(b.a)(Object(b.a)({},Fr),t),{},{id:Object(ze.a)(),clientAnonymousId:n,clientTimestamp:(new Date).toJSON()})),r=function(){var e=Object(p.a)(d.a.mark((function e(t){var n,a,i=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>1&&void 0!==i[1]?i[1]:10,t||(t=zr,zr=[]),t.length){e.next=4;break}return e.abrupt("return",null);case 4:return e.prev=4,a=(new Date).toJSON(),e.next=8,fetch("https://track.cube.dev/track",{method:"post",body:JSON.stringify(t.map((function(e){return Object(b.a)(Object(b.a)({},e),{},{sentAt:a})}))),headers:{"Content-Type":"application/json"}});case 8:if(!(200!==e.sent.status&&n>0)){e.next=11;break}return e.abrupt("return",r(t,n-1));case 11:e.next=17;break;case 13:if(e.prev=13,e.t0=e.catch(4),!(n>0)){e.next=17;break}return e.abrupt("return",r(t,n-1));case 17:return e.abrupt("return",null);case 18:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(t){return e.apply(this,arguments)}}(),a=(Br||Promise.resolve()).then((function(){return r()})).then((function(){a===Br&&(Br=null)})),Br=a,e.abrupt("return",Br);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ur=function(e,t){var n;Fr=Object(b.a)(Object(b.a)({},Fr),t),null===(n=Nr)||void 0===n||n(Object(b.a)({event:"identify",anonymousId:e},t),Mr)},Kr=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null===(t=Nr)||void 0===t||t(Object(b.a)({event:e},n),Mr)},Vr=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Kr("Playground Action",Object(b.a)({name:e},t))},Yr=Object(D.d)(S.a.Content)(Ir||(Ir=Object(k.a)(["\n  height: 100%;\n"]))),Jr=function(e){Object(O.a)(n,e);var t=Object(x.a)(n);function n(){var e;Object(y.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).state={fatalError:null,context:null,showLoader:!1,isAppContextSet:!1},e}return Object(g.a)(n,[{key:"componentDidMount",value:function(){var e=Object(p.a)(d.a.mark((function e(){var t,n,r=this;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return setTimeout((function(){return r.setState({showLoader:!0})}),700),window.addEventListener("unhandledrejection",(function(e){var t=e.reason;console.log(t);var n=(t.stack||t).toString();Kr("Playground Error",{error:n})})),e.next=4,fetch("/playground/context");case 4:return t=e.sent,e.next=7,t.json();case 7:n=e.sent,a=n.telemetry,Mr=a,Nr=Qr,Ur(n.anonymousId,{coreServerVersion:n.coreServerVersion,projectFingerprint:n.projectFingerprint,isDocker:Boolean(n.isDocker),dockerVersion:n.dockerVersion}),this.setState({context:n});case 12:case"end":return e.stop()}var a}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidCatch",value:function(e,t){Kr("Playground Error",{error:(e.stack||e).toString(),info:t.toString()})}},{key:"render",value:function(){var e,t=this,n=this.props,r=n.location,a=n.children,i=this.state,o=i.context,c=i.fatalError,s=i.isAppContextSet,u=i.showLoader;return null==o||s?null!=o||s?(c&&console.log(c.stack),Object(_.jsx)(kn,{disabled:null==o.livePreview||!o.livePreview,children:Object(_.jsxs)(S.a,{children:[Object(_.jsx)(ar,{}),Object(_.jsx)(Wn,{selectedKeys:(e=r.pathname,"/template-gallery"===e?["/dashboard"]:[e])}),Object(_.jsx)(Yr,{children:c?Object(_.jsx)(A.a,{message:"Error occured while rendering",description:c.stack||"",type:"error"}):a})]})})):u?Object(_.jsx)(pr,{}):null:Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(Gr,{context:o}),Object(_.jsx)(En,{onReady:function(){return t.setState({isAppContextSet:!0})}})]})}}],[{key:"getDerivedStateFromError",value:function(e){return{fatalError:e}}}]),n}(w.Component);function Gr(e){var t=e.context,n=Tn().setContext;return Object(w.useEffect)((function(){null!==t&&n({ready:!0,playgroundContext:Object(b.a)(Object(b.a)({},t),{},{isCloud:!1}),identifier:t.identifier})}),[t]),null}var Wr,Hr,Zr,$r,Xr,ea,ta=Object(j.g)(Jr),na=n(472),ra=function(e,t,n){return vn(e,Object(b.a)(Object(b.a)({},t),{},{retries:n}))},aa=function(){function e(){Object(y.a)(this,e),this.loadError=null,this.dashboardCreated=!1,this.installedTemplates=void 0,this.playgroundContext=void 0}return Object(g.a)(e,[{key:"load",value:function(){var e=Object(p.a)(d.a.mark((function e(){var t,n,r,a=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]&&a[0],e.next=3,ra("/playground/dashboard-app-create-status".concat(t?"?instant=true":""),void 0,10);case 3:return n=e.sent,e.next=6,n.json();case 6:(r=e.sent).error?this.loadError=r.error:(this.dashboardCreated="created"===r.status,this.installedTemplates=r.installedTemplates);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"applyTemplatePackages",value:function(){var e=Object(p.a)(d.a.mark((function e(t){var n,r=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.length>1&&void 0!==r[1]?r[1]:null,this.playgroundContext){e.next=5;break}return e.next=4,this.loadContext();case 4:this.playgroundContext=e.sent;case 5:return e.abrupt("return",vn("/playground/apply-template-packages",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({toApply:t,templateConfig:n||{credentials:this.playgroundContext}})}));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadContext",value:function(){var e=Object(p.a)(d.a.mark((function e(){var t,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,vn("/playground/context");case 2:return t=e.sent,e.next=5,t.json();case 5:return n=e.sent,e.abrupt("return",{cubejsToken:n.cubejsToken,apiUrl:n.apiUrl||window.location.href.split("#")[0].replace(/\/$/,"")});case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"templatePackages",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"react";return"react"===e.toLowerCase()?[{name:"react-antd-dynamic",description:"React Antd Dynamic"},{name:"react-antd-static",description:"React Antd Static"},{name:"react-material-static",description:"React Material UI Static"}]:"angular"===e.toLowerCase()?[{name:"ng-material-dynamic",description:"Angular Material UI Dynamic"}]:"vue"===e.toLowerCase()?[{name:"vue-vuetify-dynamic",description:"Vue Vuetify UI Dynamic"}]:[]}},{key:"canAddChart",value:function(){var e=Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:if(!this.loadError){e.next=4;break}return e.abrupt("return",this.loadError);case 4:return e.abrupt("return",!!Object.keys(this.installedTemplates).find((function(e){return e.match(/-static$/)})));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addChart",value:function(){var e=Object(p.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:if(!this.loadError){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,this.applyTemplatePackages(["create-react-app",Object.keys(this.installedTemplates).find((function(e){return e.match(/-static$/)})),"static-chart"],{chartCode:t});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"templates",value:function(){var e=Object(p.a)(d.a.mark((function e(){var t,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,vn("/playground/manifest");case 2:return e.next=4,e.sent.json();case 4:return t=e.sent,n=t.templates,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}(),ia=function(e){var t=e.children;return Object(_.jsx)("div",{style:{textAlign:"center",marginTop:50},children:t})},oa=function(){return Object(_.jsxs)("p",{style:{width:450,margin:"20px auto"},children:["Dashboard App is a convenient way to setup and deploy frontend app to work with Cube.js backend. You can learn more about in the"," ",Object(_.jsx)("a",{href:"https://cube.dev/docs/dashboard-app",target:"_blankl",children:"Cube.js docs"}),"."]})},ca=function(e){Object(O.a)(n,e);var t=Object(x.a)(n);function n(e){var r;return Object(y.a)(this,n),(r=t.call(this,e)).dashboardSource=new aa,r.state={},r}return Object(g.a)(n,[{key:"componentDidMount",value:function(){var e=Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadDashboard();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadDashboard",value:function(){var e=Object(p.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({appCode:null,loadError:null}),e.prev=1,e.next=4,this.dashboardSource.load();case 4:return this.setState({dashboardStarting:!1,appCode:!this.dashboardSource.loadError&&this.dashboardSource.dashboardCreated,loadError:this.dashboardSource.loadError}),e.next=7,vn("/playground/dashboard-app-status");case 7:return e.next=9,e.sent.json();case 9:t=e.sent,this.setState({dashboardRunning:t.running,dashboardPort:t.dashboardPort,dashboardAppPath:t.dashboardAppPath}),e.next=17;break;case 13:throw e.prev=13,e.t0=e.catch(1),this.setState({dashboardStarting:!1,loadError:Object(_.jsx)("pre",{children:e.t0.toString()})}),e.t0;case 17:case"end":return e.stop()}}),e,this,[[1,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"startDashboardApp",value:function(){var e=Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({dashboardStarting:!0}),e.next=3,fetch("/playground/start-dashboard-app");case 3:return e.next=5,this.loadDashboard();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state,n=t.appCode,r=t.dashboardPort,a=t.loadError,i=t.dashboardRunning,o=t.dashboardStarting,c=t.dashboardAppPath;if(a&&"string"===typeof a&&-1!==a.indexOf("Dashboard app not found"))return Object(_.jsx)(j.a,{to:"/template-gallery"});if(a)return Object(_.jsxs)(ia,{children:[Object(_.jsx)("h2",{children:a}),Object(_.jsx)("p",{style:{marginTop:25},children:Object(_.jsx)(L.a,{to:"/template-gallery",children:Object(_.jsx)(Y.a,{type:"primary",children:"Create dashboard app in your project directory"})})}),Object(_.jsx)(oa,{})]});if(!n)return Object(_.jsxs)(ia,{children:[Object(_.jsx)("h2",{children:"\xa0Creating Dashboard App"}),Object(_.jsx)("div",{children:Object(_.jsx)(na.a,{tip:"It may take several minutes. Please check console for progress..."})}),Object(_.jsx)(oa,{})]});if(!i)return Object(_.jsxs)(ia,{children:[Object(_.jsx)("h2",{children:"Dashboard App is not running"}),Object(_.jsxs)("h3",{children:["Please start dashboard app or run it manually using",Object(_.jsx)("code",{className:"inline-code",children:"$ npm run start"}),Object(_.jsx)("br",{}),"in\xa0",Object(_.jsx)("b",{children:c}),"\xa0directory."]}),Object(_.jsx)("p",{style:{marginTop:25},children:Object(_.jsx)(Y.a,{type:"primary",size:"large",loading:o,onClick:function(){return e.startDashboardApp()},children:o?"Dashboard app is starting. It may take a while. Please check console for progress...":"Start dashboard app"})}),Object(_.jsx)(oa,{})]});var s="http://".concat(window.location.hostname,":").concat(r);return Object(_.jsxs)("div",{style:{height:"100%",width:"100%",padding:"15px 30px 30px 30px",background:"#fff"},children:[Object(_.jsx)(A.a,{message:Object(_.jsxs)("span",{children:["This dashboard app can be edited at\xa0",Object(_.jsx)("b",{children:c}),". Dev server is running at\xa0",Object(_.jsx)("a",{href:s,target:"_blank",rel:"noopener noreferrer",children:s}),". Learn more how to customize and deploy it at\xa0",Object(_.jsx)("a",{href:"https://cube.dev/docs/dashboard-app",children:"Cube.js\xa0docs"}),".\xa0",Object(_.jsx)("a",{onClick:function(){return window.location.reload()},style:{cursor:"pointer"},children:"Refresh page"}),"\xa0if it is empty."]}),type:"info",closable:!0,style:{marginBottom:15}}),Object(_.jsx)("iframe",{src:s,style:{width:"100%",height:"100%",border:0,borderRadius:4,overflow:"hidden"},sandbox:"allow-modals allow-forms allow-popups allow-scripts allow-same-origin",title:"Dashboard"})]})}}]),n}(w.Component),sa=Object(j.g)(ca),ua=n(139),la=D.d.div(Wr||(Wr=Object(k.a)(["\n  font-weight: 500;\n  font-size: 12px;\n  line-height: 18px;\n  letter-spacing: 0.04em;\n  text-transform: uppercase;\n  color: var(--dark-04-color);\n  margin-bottom: 8px;\n"]))),da=D.d.div(Hr||(Hr=Object(k.a)(["\n  display: flex;\n  flex-flow: row wrap;\n  margin-right: -8px;\n  margin-bottom: -8px;\n\n  && > * {\n    margin-right: 8px !important;\n    margin-bottom: 8px !important;\n  }\n"]))),ba=n(240),pa=Object(D.d)(ba.a)(Zr||(Zr=Object(k.a)(["\n  &&& {\n    &.ant-select-disabled {\n      .ant-select-selector {\n        border-color: var(--disabled-color);\n        background-color: white;\n      }\n\n      .ant-select-selector {\n        color: var(--disabled-color);\n\n        &:hover,\n        &:active,\n        &:focus {\n          border-color: var(--disabled-color);\n          color: var(--disabled-color);\n        }\n      }\n    }\n\n    &.ant-select-single {\n      .ant-select-selector {\n        padding: 5px 12px;\n\n        .ant-select-selection-placeholder {\n          line-height: 22px;\n        }\n      }\n    }\n\n    &.ant-select-multiple {\n      .ant-select-selector {\n        padding: 3px 12px;\n      }\n\n      .ant-select-selection-item {\n        margin-top: 0;\n        margin-bottom: 0;\n      }\n    }\n\n    .ant-select-selection-item {\n      font-size: 14px;\n      line-height: 22px;\n    }\n\n    .ant-select-selector {\n      height: auto;\n      color: var(--text-color);\n      font-size: 14px;\n      line-height: 22px;\n\n      &:hover,\n      &:active,\n      &:focus {\n        border-color: var(--purple-04-color);\n        color: var(--primary-color);\n      }\n    }\n\n    .ant-select-selector::after {\n      font-size: 14px;\n      line-height: 22px;\n    }\n  }\n"]))),ha=(Object(D.d)(ee.a)($r||($r=Object(k.a)(["\n  && .ant-select-selector {\n    padding: 6px 12px;\n    height: auto;\n    border-color: 1px solid var(--dark-05-color);\n    color: var(--text-color);\n\n    &:hover,\n    &:active,\n    &:focus {\n      border-color: var(--purple-04-color);\n      color: var(--primary-color);\n    }\n  }\n"]))),Object(D.d)(M.a)(Xr||(Xr=Object(k.a)(["\n  && {\n    user-select: none;\n\n    &.ant-menu-inline .ant-menu-item:not(:last-child) {\n      margin-bottom: 0;\n    }\n  }\n"]))));ha.Item=Object(D.d)(M.a.Item)(ea||(ea=Object(k.a)(["\n  &&& {\n    border-radius: 4px;\n    margin-bottom: 0;\n    margin-top: 0;\n\n    &::after {\n      border-color: transparent;\n    }\n\n    &.ant-menu-item-selected {\n      color: var(--primary-color);\n\n      &::after {\n        border-color: transparent;\n      }\n    }\n  }\n"])));var ma,fa,ja,va=ha,ya=Object(D.d)(X.a)(ma||(ma=Object(k.a)(["\n  && {\n    .ant-tabs-nav {\n      padding: 0 16px;\n      user-select: none;\n    }\n\n    .ant-tabs-content-holder {\n      padding: 0 16px;\n    }\n  }\n"]))),ga=n(836),Oa=Object(D.d)(ga.a)(fa||(fa=Object(k.a)(["\n  && {\n    user-select: none;\n\n    .ant-tree-node-content-wrapper.ant-tree-node-selected {\n      color: white;\n    }\n  }\n"])));Oa.TreeNode=Object(D.d)(ga.a.TreeNode)(ja||(ja=Object(k.a)(["\n  && {\n  }\n"])));var xa=Oa,ka=S.a.Content,wa=S.a.Sider,Ca=xa.TreeNode,Sa=ya.TabPane,Aa={},Da=function(e){Object(O.a)(n,e);var t=Object(x.a)(n);function n(e){var r;return Object(y.a)(this,n),(r=t.call(this,e)).state={expandedKeys:[],autoExpandParent:!0,checkedKeys:[],selectedKeys:[],activeTab:"schema",files:[],isDocker:null},r}return Object(g.a)(n,[{key:"componentDidMount",value:function(){var e=Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadDBSchema();case 2:return e.next=4,this.loadFiles();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onExpand",value:function(e){Vr("Expand Tables"),this.setState({expandedKeys:e,autoExpandParent:!1})}},{key:"onCheck",value:function(e){Vr("Check Tables"),this.setState({checkedKeys:e})}},{key:"onSelect",value:function(e){this.setState({selectedKeys:e})}},{key:"loadDBSchema",value:function(){var e=Object(p.a)(d.a.mark((function e(){var t,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({schemaLoading:!0}),e.prev=1,e.next=4,vn("/playground/db-schema");case 4:return t=e.sent,e.next=7,t.json();case 7:n=e.sent,this.setState({tablesSchema:n.tablesSchema}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),this.setState({schemaLoadingError:e.t0});case 14:return e.prev=14,this.setState({schemaLoading:!1}),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])})));return function(){return e.apply(this,arguments)}}()},{key:"loadFiles",value:function(){var e=Object(p.a)(d.a.mark((function e(){var t,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,vn("/playground/files");case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,this.setState({files:n.files});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"generateSchema",value:function(){var e=Object(p.a)(d.a.mark((function e(){var t,n,r,a,i;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state,n=t.checkedKeys,r=t.tablesSchema,a=this.props.history,Vr("Generate Schema"),e.next=5,vn("/playground/generate-schema",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tables:n.filter((function(e){return!!Aa[e]})).map((function(e){return Aa[e]})),tablesSchema:r})});case 5:if(200!==(i=e.sent).status){e.next=14;break}return Vr("Generate Schema Success"),e.next=10,this.loadFiles();case 10:this.setState({checkedKeys:[],activeTab:"files"}),ne.a.success({title:"Schema files successfully generated!",content:"You can start building the charts",okText:"Build",cancelText:"Close",okCancel:!0,onOk:function(){a.push("/build")}}),e.next=20;break;case 14:return e.t0=Vr,e.next=17,i.text();case 17:e.t1=e.sent,e.t2={error:e.t1},(0,e.t0)("Generate Schema Fail",e.t2);case 20:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"selectedFileContent",value:function(){var e=this.selectedFile();return e&&e.content}},{key:"selectedFile",value:function(){var e=this.state,t=e.files,n=e.selectedFile;return t.find((function(e){return e.fileName===n}))}},{key:"renderFilesMenu",value:function(){var e=this,t=this.state,n=t.selectedFile,r=t.files;return Object(_.jsx)(va,{mode:"inline",onClick:function(t){var n=t.key;Vr("Select File"),e.setState({selectedFile:n})},selectedKeys:n?[n]:[],children:r.map((function(e){return Object(_.jsx)(va.Item,{children:e.fileName},e.fileName)}))})}},{key:"render",value:function(){var e=this,t=this.state,n=t.schemaLoading,r=t.schemaLoadingError,a=t.tablesSchema,i=t.selectedFile,o=t.expandedKeys,c=t.autoExpandParent,s=t.checkedKeys,u=t.selectedKeys,l=t.activeTab,d=t.isDocker,p=function e(t){return t.map((function(t){return t.treeData?Object(_.jsx)(Ca,{title:t.title,dataRef:t,children:e(t.treeData)},t.key):Object(_.jsx)(Ca,Object(b.a)({},t))}))};return Object(_.jsxs)(S.a,{style:{height:"100%"},children:[Object(_.jsx)(wa,{width:340,className:"schema-sidebar",children:Object(_.jsxs)(ya,{activeKey:l,onChange:function(t){return e.setState({activeTab:t})},tabBarExtraContent:Object(_.jsx)(Y.a,{disabled:!s.length,type:"primary",onClick:function(){return e.generateSchema()},children:"Generate Schema"}),children:[Object(_.jsx)(Sa,{tab:"Tables",children:n?Object(_.jsx)(pr,{}):r?Object(_.jsx)(or,{"data-testid":"schema-error",message:"Error while loading DB schema",description:r.toString(),type:"error"}):function(){return Object.keys(a||{}).length>0?Object(_.jsx)(xa,{checkable:!0,onExpand:e.onExpand.bind(e),expandedKeys:o,autoExpandParent:c,onCheck:e.onCheck.bind(e),checkedKeys:s,onSelect:e.onSelect.bind(e),selectedKeys:u,children:p((t=a||{},Object.keys(t).map((function(e){return{title:e,key:e,treeData:Object.keys(t[e]).map((function(t){var n="".concat(e,".").concat(t);return Aa[n]=[e,t],{title:t,key:n}}))}}))))}):Object(_.jsx)(or,{message:"Empty DB Schema",description:"Please check connection settings",type:"warning"});var t}()},"schema"),Object(_.jsx)(Sa,{tab:"Files",children:this.renderFilesMenu()},"files")]})}),Object(_.jsxs)(ka,{style:{minHeight:280,padding:24},children:[i&&Object(_.jsx)(or,{message:d?Object(_.jsxs)("span",{children:["Schema files are located and can be edited in the mount volume directory."," ",Object(_.jsx)(V.a.Link,{href:"https://cube.dev/docs/schema/getting-started",target:"_blank",children:"Learn more about working with Cube.js data schema in the docs"})]}):Object(_.jsxs)("span",{children:["This file can be edited at\xa0",Object(_.jsx)("b",{children:this.selectedFile().absPath})]}),type:"info",style:{paddingTop:10,paddingBottom:11}}),i?Object(_.jsx)(Tr,{code:this.selectedFileContent(),style:{padding:0,marginTop:24}}):Object(_.jsx)(ua.a,{style:{marginTop:50},description:"Select tables to generate Cube.js schema"}),Object(_.jsx)(En,{onReady:function(t){var n=t.playgroundContext;return e.setState({isDocker:null===n||void 0===n?void 0:n.isDocker})}})]})]})}}]),n}(w.Component),Ea=n(118),Ta=n(214),Pa=n(493),qa=n(212),Ra=n(860),Ma=n(496),Ia=n(861),La=n(862),_a=n(474),Ba=(n(641),n(642),n(828)),za=n(490),Fa=n(829),Na=n(475),Qa=n.n(Na),Ua=n(476),Ka=(n(59),n(357)),Va=n.n(Ka),Ya=Object(w.createContext)(null),Ja={reset:"orange",black:"black",red:"red",green:"green",yellow:"orange",blue:"blue",magenta:"magenta",cyan:"cyan",gray:"gray",lightgrey:"lightgrey",darkgrey:"darkgrey"},Ga={"ansi-bright-black":"black","ansi-bright-yellow":"yellow","ansi-yellow":"yellow","ansi-bright-green":"green","ansi-green":"green","ansi-bright-cyan":"cyan","ansi-cyan":"cyan","ansi-bright-red":"red","ansi-red":"red","ansi-bright-magenta":"magenta","ansi-magenta":"magenta","ansi-white":"darkgrey"};function Wa(e){for(var t=(new Qa.a).ansiToJson(Object(Ua.encode)(e),{use_classes:!0}),n="",r=!1,a=0;a<t.length;++a)for(var i=t[a],o=i.content,c=i.fg,s=o.split("\n"),u=0;u<s.length;++u){r||(n+='<span data-ansi-line="true">',r=!0);var l=s[u].replace("\r",""),d=Ja[Ga[c]];null!=d?n+='<span style="color: '.concat(d,';">').concat(l,"</span>"):(null!=c&&console.log("Missing color mapping: ",c),n+="<span>".concat(l,"</span>")),u<s.length-1&&(n+="</span>",r=!1,n+="<br/>")}return r&&(n+="</span>"),n}function Ha(e){return"object"!==Te()(e)?e:Object.fromEntries(Object.entries(e).filter((function(e){return null!=Ve()(e,2)[1]})).map((function(e){var t=Ve()(e,2),n=t[0],r=t[1];return Array.isArray(r)?[n,r.map(Ha)]:[n,"object"===Te()(r)?Ha(r):r]})))}function Za(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Za(Object(n),!0).forEach((function(t){De()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Za(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Xa(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=wt()(e);if(t){var a=wt()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return xt()(this,n)}}var ei=function(e){gt()(n,e);var t=Xa(n);function n(e){var r;return qe()(this,n),(r=t.call(this,e)).state={},r.mutexObj={},r}return Me()(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.query,n=e.queries;t&&this.load(t),n&&this.loadQueries(n)}},{key:"shouldComponentUpdate",value:function(e,t){var n=this.props,r=n.query,a=n.queries,i=n.render,o=n.cubejsApi,c=n.loadSql,s=n.updateOnlyOnStateChange;return!s||(!Object($e.a)(e.query,r)||!Object($e.a)(e.queries,a)||(null==e.render||null==i)&&e.render!==i||e.cubejsApi!==o||e.loadSql!==c||!Object($e.a)(t,this.state)||e.updateOnlyOnStateChange!==s)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.query,r=t.queries;Object($e.a)(e.query,n)||this.load(n),Object($e.a)(e.queries,r)||this.loadQueries(r)}},{key:"cubejsApi",value:function(){return this.props.cubejsApi||this.context&&this.context.cubejsApi}},{key:"load",value:function(e){var t=this,n=this.props.resetResultSetOnChange;this.setState($a({isLoading:!0,error:null,sqlQuery:null},n?{resultSet:null}:{}));var r=this.props.loadSql,a=this.cubejsApi();e&&Rt(e)&&("only"===r?a.sql(e,{mutexObj:this.mutexObj,mutexKey:"sql"}).then((function(e){return t.setState({sqlQuery:e,error:null,isLoading:!1})})).catch((function(e){return t.setState($a($a({},n?{resultSet:null}:{}),{},{error:e,isLoading:!1}))})):r?Promise.all([a.sql(e,{mutexObj:this.mutexObj,mutexKey:"sql"}),a.load(e,{mutexObj:this.mutexObj,mutexKey:"query"})]).then((function(e){var n=Ve()(e,2),r=n[0],a=n[1];return t.setState({sqlQuery:r,resultSet:a,error:null,isLoading:!1})})).catch((function(e){return t.setState($a($a({},n?{resultSet:null}:{}),{},{error:e,isLoading:!1}))})):a.load(e,{mutexObj:this.mutexObj,mutexKey:"query"}).then((function(e){return t.setState({resultSet:e,error:null,isLoading:!1})})).catch((function(e){return t.setState($a($a({},n?{resultSet:null}:{}),{},{error:e,isLoading:!1}))})))}},{key:"loadQueries",value:function(e){var t=this,n=this.cubejsApi(),r=this.props.resetResultSetOnChange;this.setState($a($a({isLoading:!0},r?{resultSet:null}:{}),{},{error:null})),Promise.all(Object(Ba.a)(e).map((function(e){var r=Ve()(e,2),a=r[0],i=r[1];return n.load(i,{mutexObj:t.mutexObj,mutexKey:a}).then((function(e){return[a,e]}))}))).then((function(e){return t.setState({resultSet:Object(lt.a)(e),error:null,isLoading:!1})})).catch((function(e){return t.setState($a($a({},r?{resultSet:null}:{}),{},{error:e,isLoading:!1}))}))}},{key:"render",value:function(){var e=this.state,t=e.error,n=e.queries,r=e.resultSet,a=e.isLoading,i=e.sqlQuery,o=this.props.render,c={error:t?new Error(Wa(t.message||t.toString())):null,resultSet:n?r||{}:r,loadingState:{isLoading:a},sqlQuery:i};return o?o(c):null}}],[{key:"isQueryPresent",value:function(e){return Rt(e)}}]),n}(C.a.Component);ei.contextType=Ya,ei.defaultProps={cubejsApi:null,query:null,render:null,queries:null,loadSql:null,updateOnlyOnStateChange:!1,resetResultSetOnChange:!0};function ti(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ni(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ti(Object(n),!0).forEach((function(t){De()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ti(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ri(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=wt()(e);if(t){var a=wt()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return xt()(this,n)}}var ai=[{name:void 0,title:"w/o grouping"},{name:"second",title:"Second"},{name:"minute",title:"Minute"},{name:"hour",title:"Hour"},{name:"day",title:"Day"},{name:"week",title:"Week"},{name:"month",title:"Month"},{name:"quarter",title:"Quarter"},{name:"year",title:"Year"}],ii=function(e){gt()(n,e);var t=ri(n);function n(e){var r;return qe()(this,n),r=t.call(this,e),De()(Va()(r),"fetchMeta",Le()(Be.a.mark((function e(){var t,n;return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.cubejsApi()){e.next=2;break}return e.abrupt("return");case 2:return n=null,e.prev=3,r.setState({isFetchingMeta:!0}),e.next=7,r.cubejsApi().meta();case 7:t=e.sent,e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),n=e.t0;case 13:r.setState({meta:t,metaError:n?new Error(Wa(n.message||n.toString())):null,isFetchingMeta:!1},(function(){r.updateQuery({})}));case 14:case"end":return e.stop()}}),e,null,[[3,10]])})))),r.state=ni(ni({query:e.defaultQuery||e.query,chartType:e.defaultChartType,validatedQuery:e.query,missingMembers:[],isFetchingMeta:!0,dryRunResponse:null},e.vizState),e.initialVizState),r.mutexObj={},r.orderMembersOrderKeys=[],r}return Me()(n,[{key:"componentDidMount",value:function(){var e=Le()(Be.a.mark((function e(){return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.prevContext=this.context,e.next=3,this.fetchMeta();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Le()(Be.a.mark((function e(t){var n,r,a,i,o,c,s,u=this;return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.props,i=a.schemaVersion,o=a.onSchemaChange,c=this.state.meta,(null===(n=this.prevContext)||void 0===n?void 0:n.cubejsApi)===(null===(r=this.context)||void 0===r?void 0:r.cubejsApi)){e.next=6;break}return this.prevContext=this.context,e.next=6,this.fetchMeta();case 6:if(t.schemaVersion===i){e.next=17;break}return e.prev=7,e.next=10,this.cubejsApi().meta();case 10:s=e.sent,Object($e.a)(s,c)||"function"!==typeof o||o({schemaVersion:i,refresh:function(){var e=Le()(Be.a.mark((function e(){return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.fetchMeta();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(7),this.setState({metaError:e.t0});case 17:case"end":return e.stop()}}),e,this,[[7,14]])})));return function(t){return e.apply(this,arguments)}}()},{key:"cubejsApi",value:function(){var e=this.props.cubejsApi;return e||this.context&&this.context.cubejsApi}},{key:"getMissingMembers",value:function(e,t){return t?function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=["measures","dimensions","segments"],n=new Set;return t.forEach((function(t){return(e[t]||[]).forEach((function(e){return n.add(e)}))})),(e.timeDimensions||[]).forEach((function(e){return n.add(e.dimension)})),It(e.filters).forEach((function(e){return n.add(e.dimension||e.member)})),Ue()(n)}(e).map((function(e){return!!t.resolveMember(e,["measures","dimensions","segments"]).error&&e})).filter(Boolean):[]}},{key:"isQueryPresent",value:function(){var e=this.state.query;return ei.isQueryPresent(e)}},{key:"prepareRenderProps",value:function(e){var t=this,r=function(e){return e.name},a=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r;return{add:function(r){var a=t.state.query;t.updateQuery(De()({},e,(a[e]||[]).concat(n(r))))},remove:function(n){var r=(t.state.query[e]||[]).concat([]);return r.splice(n.index,1),t.updateQuery(De()({},e,r))},update:function(r,a){var i=(t.state.query[e]||[]).concat([]);return i.splice(r.index,1,n(a)),t.updateQuery(De()({},e,i))}}},i=this.state,o=i.meta,c=i.metaError,s=i.query,u=i.queryError,l=i.chartType,d=i.pivotConfig,b=i.validatedQuery,p=i.missingMembers,h=i.isFetchingMeta,m=i.dryRunResponse,f=Object(za.a)((function(e){return"".concat(Object(tt.a)("member",e)).concat(Object(tt.a)("operator",e))}),It(o&&s.filters||[]).map((function(e){return ni(ni({},e),{},{member:e.member||e.dimension})}))).map((function(e,t){return ni(ni({},e),{},{dimension:o.resolveMember(e.member||e.dimension,["dimensions","measures"]),operators:o.filterOperatorsForMember(e.member||e.dimension,["dimensions","measures"]),index:t})})),j=n.resolveMember("measures",this.state),v=n.resolveMember("dimensions",this.state),y=n.resolveMember("timeDimensions",this.state),g=(o&&s.segments||[]).map((function(e,t){return ni({index:t},o.resolveMember(e,"segments"))})),O=[],x=[],k=[],w=[],C=(null===o||void 0===o?void 0:o.membersGroupedByCube())||{measures:[],dimensions:[],segments:[],timeDimensions:[]};if(o){O=o.membersForQuery(s,"measures"),x=o.membersForQuery(s,"dimensions"),k=o.membersForQuery(s,"segments");var S=Object(et.a)(Object(tt.a)("cubeName"),C.measures),A=Object(et.a)(Object(tt.a)("cubeName"),C.dimensions);w=Object(ht.a)([].concat(Ue()(Object.keys(S)),Ue()(Object.keys(A)))).sort().map((function(e){var t,n;return ni(ni({},S[e]||A[e]),{},{members:[].concat(Ue()(null===(t=S[e])||void 0===t?void 0:t.members),Ue()(null===(n=A[e])||void 0===n?void 0:n.members)).sort((function(e,t){return e.shortTitle>t.shortTitle?1:-1}))})}))}var D=Array.isArray(s.order)?Object.fromEntries(s.order):s.order,E=[].concat(Ue()(j),Ue()(v),Ue()(y.map((function(e){return e.dimension})))),T=Object(za.a)(Object(tt.a)("id"),Ue()(E.map((function(e){var t=e.name;return{id:t,title:e.title,order:(null===D||void 0===D?void 0:D[t])||"none"}}))));return this.orderMembersOrderKeys.length!==T.length&&(this.orderMembersOrderKeys=T.map((function(e){return e.id}))),this.orderMembersOrderKeys.length&&(T=(this.orderMembersOrderKeys||[]).map((function(e){return T.find((function(t){return t.id===e}))}))),ni({meta:o,metaError:c,query:s,error:u,validatedQuery:b,isQueryPresent:this.isQueryPresent(),chartType:l,measures:j,dimensions:v,timeDimensions:y,segments:g,filters:f,orderMembers:T,availableMeasures:O,availableDimensions:x,availableTimeDimensions:x.filter((function(e){return"time"===e.type})),availableSegments:k,availableMembers:C,availableFilterMembers:w,updateQuery:function(e){return t.updateQuery(e)},updateMeasures:a("measures"),updateDimensions:a("dimensions"),updateSegments:a("segments"),updateTimeDimensions:a("timeDimensions",(function(e){var t=e.compareDateRange?{compareDateRange:e.compareDateRange}:{dateRange:e.dateRange};return Ha(ni({dimension:e.dimension.name,granularity:e.granularity},t))})),updateFilters:a("filters",(function(e){var t,n;return{member:(null===(t=e.member)||void 0===t?void 0:t.name)||(null===(n=e.dimension)||void 0===n?void 0:n.name),operator:e.operator,values:e.values}})),updateChartType:function(e){return t.updateVizState({chartType:e})},updateOrder:{set:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";t.updateQuery({order:T.map((function(t){return ni(ni({},t),{},{order:t.id===e?n:t.order})})).reduce((function(e,t){var n=t.id,r=t.order;return"none"!==r?[].concat(Ue()(e),[[n,r]]):e}),[])})},update:function(e){t.updateQuery({order:e})},reorder:function(e,n){if(null!=e&&null!=n){var r=function(e,t,n){var r=Ue()(e),a=r.splice(t,1),i=Ve()(a,1)[0];return r.splice(n,0,i),r}(T,e,n);t.orderMembersOrderKeys=r.map((function(e){return e.id})),t.updateQuery({order:r.reduce((function(e,t){var n=t.id,r=t.order;return"none"!==r?[].concat(Ue()(e),[[n,r]]):e}),[])})}}},pivotConfig:d,updatePivotConfig:{moveItem:function(e){var n=e.sourceIndex,r=e.destinationIndex,a=e.sourceAxis,i=e.destinationAxis;t.updateVizState({pivotConfig:Mt(d,n,r,a,i)})},update:function(e){var n=e.limit;t.updateVizState(ni({pivotConfig:ni(ni({},d),e)},n?{query:ni(ni({},s),{},{limit:n})}:null))}},missingMembers:p,refresh:this.fetchMeta,isFetchingMeta:h,dryRunResponse:m},e)}},{key:"updateQuery",value:function(e){var t=this.state.query;this.updateVizState({query:ni(ni({},t),e)})}},{key:"updateVizState",value:function(){var e=Le()(Be.a.mark((function e(t){var n,r,a,i,o,c,s,u,l,d,b,p,h,m=this;return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.props,r=n.setQuery,a=n.setVizState,i=this.state,o=i.query,c=i.pivotConfig,s=i.chartType,u=i.meta,(l=this.applyStateChangeHeuristics(t)).query||(l.query=ni({},o)),d=null,b=function(e){var t=m.props.onVizStateChanged;if(t){var n=Object(Fa.a)(["chartType","pivotConfig","query"],e);d&&Object($e.a)(d,n)||(t(n),d=Object(Xe.a)(n))}},p=function(e){a&&a(Object(Fa.a)(["chartType","pivotConfig","query"],e)),e.query&&r&&r(e.query)},l.shouldApplyHeuristicOrder&&(l.query.order=qt(l.query)),l.pivotConfig=Wt.getNormalizedPivotConfig(l.query,void 0!==l.pivotConfig?l.pivotConfig:c),l.missingMembers=this.getMissingMembers(l.query,u),l.chartType=l.chartType||t.chartType||s,p(ni(ni({},t),{},{query:l.query})),this.setState(ni(ni({},l),{},{queryError:null})),b(l),!!Object($e.a)(Object(Fa.a)(["measures","dimensions","timeDimensions"],o),Object(Fa.a)(["measures","dimensions","timeDimensions"],l.query))||!Rt(l.query)||0!==l.missingMembers.length){e.next=30;break}return e.prev=16,e.next=19,this.cubejsApi().dryRun(l.query,{mutexObj:this.mutexObj});case 19:h=e.sent,l.shouldApplyHeuristicOrder&&(l.query.order=(h.queryOrder||[]).reduce((function(e,t){return ni(ni({},e),t)}),{})),l.pivotConfig=Wt.getNormalizedPivotConfig(h.pivotQuery,l.pivotConfig),l.validatedQuery=this.validatedQuery(l),l.dryRunResponse=h,Rt(o)&&p(ni(ni({},this.state),l)),e.next=30;break;case 27:e.prev=27,e.t0=e.catch(16),this.setState({queryError:new Error(Wa(e.t0.message||e.t0.toString()))});case 30:this.setState(l,(function(){return b(m.state)}));case 31:case"end":return e.stop()}}),e,this,[[16,27]])})));return function(t){return e.apply(this,arguments)}}()},{key:"validatedQuery",value:function(e){var t=(e||this.state).query;return ni(ni({},t),{},{filters:(t.filters||[]).filter((function(e){return e.operator}))})}},{key:"defaultHeuristics",value:function(e){var t=this.state,n=t.query,r=t.sessionGranularity;return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=Object(Xe.a)(e),a=r.query,i=Ne()(r,At),o=n.meta,c=n.sessionGranularity||"day",s=Et({query:a},i),u=null;if(Pt(a,t)||(u=a),Array.isArray(u)||Array.isArray(t))return e;if(u){if(1===(t.timeDimensions||[]).length&&1===(u.timeDimensions||[]).length&&u.timeDimensions[0].granularity&&t.timeDimensions[0].granularity!==u.timeDimensions[0].granularity&&(s=Et(Et({},s),{},{sessionGranularity:u.timeDimensions[0].granularity})),0===(t.measures||[]).length&&(u.measures||[]).length>0||1===(t.measures||[]).length&&1===(u.measures||[]).length&&t.measures[0]!==u.measures[0]){var l=u.timeDimensions||[],d=Ve()(l,1)[0],b=o.defaultTimeDimensionNameFor(u.measures[0]);return u=Et(Et({},u),{},{timeDimensions:b?[{dimension:b,granularity:d&&d.granularity||c,dateRange:d&&d.dateRange}]:[]}),Et(Et({},s),{},{pivotConfig:null,shouldApplyHeuristicOrder:!0,query:u,chartType:b?"line":"number"})}return 0===(t.dimensions||[]).length&&(u.dimensions||[]).length>0?(u=Et(Et({},u),{},{timeDimensions:(u.timeDimensions||[]).map((function(e){return Et(Et({},e),{},{granularity:void 0})}))}),Et(Et({},s),{},{pivotConfig:null,shouldApplyHeuristicOrder:!0,query:u,chartType:"table"})):(t.dimensions||[]).length>0&&0===(u.dimensions||[]).length?(u=Et(Et({},u),{},{timeDimensions:(u.timeDimensions||[]).map((function(e){return Et(Et({},e),{},{granularity:e.granularity||c})}))}),Et(Et({},s),{},{pivotConfig:null,shouldApplyHeuristicOrder:!0,query:u,chartType:(u.timeDimensions||[]).length?"line":"number"})):((t.dimensions||[]).length>0||(t.measures||[]).length>0)&&0===(u.dimensions||[]).length&&0===(u.measures||[]).length?(u=Et(Et({},u),{},{timeDimensions:[],filters:[]}),Et(Et({},s),{},{pivotConfig:null,shouldApplyHeuristicOrder:!0,query:u,sessionGranularity:null})):s}if(s.chartType){var p=s.chartType;if(("line"===p||"area"===p)&&1===(t.timeDimensions||[]).length&&!t.timeDimensions[0].granularity){var h=Ve()(t.timeDimensions,1)[0];return Et(Et({},s),{},{pivotConfig:null,query:Et(Et({},t),{},{timeDimensions:[Et(Et({},h),{},{granularity:c})]})})}if(("pie"===p||"table"===p||"number"===p)&&1===(t.timeDimensions||[]).length&&t.timeDimensions[0].granularity){var m=Ve()(t.timeDimensions,1)[0];return Et(Et({},s),{},{pivotConfig:null,shouldApplyHeuristicOrder:!0,query:Et(Et({},t),{},{timeDimensions:[Et(Et({},m),{},{granularity:void 0})]})})}}return s}(e,n,{meta:t.meta,sessionGranularity:r||"day"})}},{key:"applyStateChangeHeuristics",value:function(e){var t=this.props,n=t.stateChangeHeuristics;return t.disableHeuristics?e:n&&n(this.state,e)||this.defaultHeuristics(e)}},{key:"render",value:function(){var e=this,t=this.state.query,n=this.props,r=n.cubejsApi,a=n.render;return n.wrapWithQueryRenderer?C.a.createElement(ei,{query:t,cubejsApi:r,resetResultSetOnChange:!1,render:function(t){return a?a(e.prepareRenderProps(t)):null}}):a?a(this.prepareRenderProps()):null}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(e.query||e.vizState){var n=ni(ni({},t),e.vizState||{});if(Array.isArray(e.query))throw new Error("Array of queries is not supported.");return ni(ni({},n),{},{query:ni(ni({},n.query),e.query||{})})}return null}},{key:"resolveMember",value:function(e,t){var r=t.meta,a=t.query;return r?Array.isArray(a)?a.reduce((function(t,a){return t.concat(n.resolveMember(e,{meta:r,query:a}))}),[]):"timeDimensions"===e?(a.timeDimensions||[]).map((function(e,t){return ni(ni({},e),{},{dimension:ni(ni({},r.resolveMember(e.dimension,"dimensions")),{},{granularities:ai}),index:t})})):(a[e]||[]).map((function(t,n){return ni({index:n},r.resolveMember(t,e))})):[]}}]),n}(C.a.Component);function oi(e){var t=e.cubejsApi,n=e.children;return C.a.createElement(Ya.Provider,{value:{cubejsApi:t}},n)}function ci(e){var t=Object(w.useRef)([]);return Object($e.a)(e,t.current)||(t.current=e),t.current}function si(){var e=Object(w.useRef)(!0);return Object(w.useEffect)((function(){return function(){e.current=!1}}),[]),function(){return e.current}}function ui(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function li(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ui(Object(n),!0).forEach((function(t){De()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ui(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function di(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=si(),a=Object(w.useContext)(Ya),i=Object(w.useRef)({}),o=Object(w.useState)({isLoading:!1,response:null}),c=Ve()(o,2),s=c[0],u=c[1],l=Object(w.useState)(null),d=Ve()(l,2),b=d[0],p=d[1],h=n.skip,m=void 0!==h&&h;function f(){return j.apply(this,arguments)}function j(){return(j=Le()(Be.a.mark((function t(){var o,c,s,l,d,b,h,f,j=arguments;return Be.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=j.length>0&&void 0!==j[0]?j[0]:{},c=j.length>1&&void 0!==j[1]&&j[1],s=n.cubejsApi||(null===a||void 0===a?void 0:a.cubejsApi),l=o.query||n.query,d="meta"===e||l&&Rt(l),!s||!c&&m||!d){t.next=20;break}return p(null),u({isLoading:!0,response:null}),b={mutexObj:i.current,mutexKey:e},h="meta"===e?[b]:[l,b],t.prev=10,t.next=13,s[e].apply(s,h);case 13:f=t.sent,r()&&u({response:f,isLoading:!1}),t.next=20;break;case 17:t.prev=17,t.t0=t.catch(10),r()&&(p(t.t0),u({isLoading:!1,response:null}));case 20:case"end":return t.stop()}}),t,null,[[10,17]])})))).apply(this,arguments)}return Object(w.useEffect)((function(){f()}),ci([Object.keys((null===(t=n.query)||void 0===t?void 0:t.order)||{}),n,a])),li(li({},s),{},{error:b,refetch:function(e){return f(e,!0)}})}function bi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bi(Object(n),!0).forEach((function(t){De()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}De()(ii,"contextType",Ya),ii.defaultProps={cubejsApi:null,stateChangeHeuristics:null,disableHeuristics:!1,render:null,wrapWithQueryRenderer:!0,defaultChartType:"line",defaultQuery:{},initialVizState:null,onVizStateChanged:null,query:null,setQuery:null,vizState:null,setVizState:null};var hi,mi=n(238),fi=n(79),ji=n(831),vi=function(e){var t=e.query;return Object(_.jsx)(ei,{loadSql:!0,query:Object(b.a)(Object(b.a)({},t),{},{renewQuery:!0}),render:function(e){var t,n=e.sqlQuery,r=e.resultSet,a=e.error;if(a)return Object(_.jsx)(yr,{error:a});var i=(null===r||void 0===r?void 0:r.serialize())||{},o=null===n||void 0===n?void 0:n.rawQuery(),c=null===(t=i.loadResponse)||void 0===t?void 0:t.results[0];return Object(_.jsxs)(X.a,{defaultActiveKey:"refreshKeys",tabBarExtraContent:Object(_.jsxs)("span",{children:["Last Refresh Time:\xa0",Object(_.jsx)("b",{children:null===c||void 0===c?void 0:c.lastRefreshTime})]}),children:[Object(_.jsx)(X.a.TabPane,{tab:"Refresh Keys",children:Object(_.jsx)(ji.a,{loading:!n,pagination:!1,scroll:{x:!0},columns:[{title:"Refresh Key SQL",key:"refreshKey",render:function(e,t){return Object(_.jsx)(Tr,{code:Object(mi.format)(t[0])})}},{title:"Value",key:"value",render:function(e,t){return Object(_.jsx)(Tr,{code:(null===c||void 0===c?void 0:c.refreshKeyValues)&&o&&JSON.stringify(c.refreshKeyValues[o.cacheKeyQueries.indexOf(t)],null,2)})}}],dataSource:null===o||void 0===o?void 0:o.cacheKeyQueries})},"refreshKeys"),Object(_.jsx)(X.a.TabPane,{tab:"Pre-aggregations",children:Object(_.jsx)(ji.a,{loading:!n,pagination:!1,scroll:{x:!0},columns:[{title:"Table Name",key:"tableName",dataIndex:"tableName",render:function(e){return Object(_.jsx)("b",{children:e})}},{title:"Refresh Key SQL",key:"refreshKey",dataIndex:"invalidateKeyQueries",render:function(e){return e.map((function(e){return Object(_.jsx)(Tr,{code:Object(mi.format)(e[0])},e[0])}))}},{title:"Refresh Key Value",key:"value",render:function(e,t){var n,r,a,i=null===c||void 0===c||null===(n=c.usedPreAggregations)||void 0===n||null===(r=n[t.tableName])||void 0===r?void 0:r.refreshKeyValues;return Array.isArray(i)&&(i=i.reduce((function(e,t){return e.concat(t)}),[])),null===(a=i)||void 0===a?void 0:a.map((function(e){return Object(_.jsx)(Tr,{code:JSON.stringify(e,null,2)},JSON.stringify(e))}))}}],dataSource:null===o||void 0===o?void 0:o.preAggregations})},"preAggregations"),Object(_.jsx)(X.a.TabPane,{tab:"Rollup Match Results",children:Object(_.jsx)(ji.a,{loading:!n,pagination:!1,scroll:{x:!0},columns:[{title:"Rollup Name",key:"name",dataIndex:"name",render:function(e){return Object(_.jsx)("b",{children:e})}},{title:"Rollup Definition",key:"rollup",dataIndex:"references",render:function(e){return Object(_.jsx)(Tr,{code:JSON.stringify(e,null,2)})}},{title:"Can Be Used",key:"canUsePreAggregation",dataIndex:"canUsePreAggregation",render:function(e){return e?Object(_.jsx)(oe.a,{style:{color:"#52c41a",fontSize:"2em"}}):Object(_.jsx)(fi.a,{style:{color:"#c2371b",fontSize:"2em"}})}}],dataSource:null===o||void 0===o?void 0:o.rollupMatchResults})},"rollupMatchResults")]})}})},yi={react:"create-react-app",angular:"angular-cli",vue:"vue-cli"},gi=Object(D.d)(Cr)(hi||(hi=Object(k.a)(["\n  .ant-card-head {\n    position: sticky;\n    top: 0;\n    z-index: 100;\n    background: white;\n  }\n\n  .ant-card-body {\n    max-width: 100%;\n    overflow: auto;\n    position: relative;\n  }\n"]))),Oi=[{id:"react",title:"React",scaffoldingSupported:!0},{id:"angular",title:"Angular",scaffoldingSupported:!0},{id:"vue",title:"Vue",scaffoldingSupported:!0},{id:"vanilla",title:"Vanilla JavaScript",placeholder:function(e){var t=e.framework;return Object(_.jsxs)("h2",{style:{padding:24,textAlign:"center"},children:["We do not support\xa0 Vanilla JavaScript \xa0code generation here yet.",Object(_.jsx)("br",{}),"Please refer to\xa0",Object(_.jsx)("a",{href:"https://cube.dev/docs/@cubejs-client-core",target:"_blank",rel:"noopener noreferrer",onClick:function(){return Vr("Unsupported Framework Docs",{framework:t})},children:"Vanilla JavaScript \xa0docs"}),"\xa0to see on how to use it with Cube.js."]})}},{id:"bi",title:"BI",placeholder:function(){return Object(_.jsxs)("h2",{style:{padding:24,textAlign:"center"},children:["You can connect Cube to any Business Intelligence tool through the Cube SQL API.",Object(_.jsx)("br",{}),"Please refer to\xa0",Object(_.jsx)("a",{href:"https://cube.dev/docs/backend/sql",target:"_blank",rel:"noopener noreferrer",onClick:function(){return Vr("BI Docs")},children:"Cube SQL \xa0docs"}),"\xa0to learn more."]})}}],xi=function(e){Object(O.a)(n,e);var t=Object(x.a)(n);function n(e){var r;return Object(y.a)(this,n),(r=t.call(this,e)).state={showCode:!1,chartRendererError:null,sql:{loading:!1}},r}return Object(g.a)(n,[{key:"render",value:function(){var e=this,t=this.state,n=t.codeExample,r=t.codesandboxFiles,a=t.dependencies,i=t.redirectToDashboard,o=t.showCode,c=t.addingToDashboard,s=t.chartRendererError,u=t.sql,l=this.props,h=l.isChartRendererReady,m=l.resultSet,f=l.error,v=l.render,y=l.dashboardSource,g=l.hideActions,O=l.query,x=l.chartingLibrary,k=l.setChartLibrary,w=l.chartLibraries,C=l.history,S=l.framework,A=l.setFramework,D=l.isFetchingMeta,E=l.onChartRendererReadyChange;if(i)return Object(_.jsx)(j.a,{to:"/dashboard"});if(s)return Object(_.jsx)("div",{children:s});var T,P=h?Object(_a.getParameters)(function(e,t){var n,r,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return{files:Object(b.a)(Object(b.a)(Object(b.a)({},null===(n=le[e])||void 0===n?void 0:n.files),Object.entries(t).map((function(e){var t=Object(Q.a)(e,2),n=t[0],r=t[1];return Object(ce.a)({},n,{content:r})})).reduce((function(e,t){return Object(b.a)(Object(b.a)({},e),t)}),{})),{},{"package.json":{content:{dependencies:Object(b.a)(Object(b.a)({},null===(r=le[e])||void 0===r?void 0:r.dependencies),a.reduce((function(e,t){var n=Array.isArray(t)?t:[t,"latest"],r=Object(Q.a)(n,2),a=r[0],i=r[1];return Object(b.a)(Object(b.a)({},e),{},Object(ce.a)({},a,i),de[a]?Object(ce.a)({},de[a],"latest"):null)}),{}))}}}),template:e}}(yi[S],r,a)):null,q=(w[S]||[]).length>0?Object(_.jsx)(M.a,{"data-testid":"charting-library-dropdown",onClick:function(e){Vr("Set Chart Library",{chartingLibrary:e.key}),k(e.key)},children:(w[S]||[]).map((function(e){return Object(_.jsx)(M.a.Item,{children:e.title},e.value)}))}):null,I=Object(_.jsx)(M.a,{"data-testid":"framework-dropdown",onClick:function(e){var t,n;e.key!==S&&(Vr("Set Framework",{framework:e.key}),A(e.key),E(!1),k((null===(t=w[e.key])||void 0===t||null===(n=t[0])||void 0===n?void 0:n.value)||null))},children:Oi.map((function(e){return Object(_.jsx)(M.a.Item,{children:e.title},e.id)}))}),L=(w[S]||[]).find((function(e){return e.value===x})),B=Oi.find((function(e){return e.id===S})),z=Object(_.jsxs)("form",{action:"https://codesandbox.io/api/v1/sandboxes/define",method:"POST",target:"_blank",children:[null!=P?Object(_.jsx)("input",{type:"hidden",name:"parameters",value:P}):null,Object(_.jsxs)(da,{children:[Object(_.jsxs)(Or.Group,{children:[Object(_.jsx)(R.a,{overlay:I,disabled:D,children:Object(_.jsxs)(Or,{"data-testid":"framework-btn",size:"small",children:[null===B||void 0===B?void 0:B.title,Object(_.jsx)(qa.a,{})]})}),q?Object(_.jsx)(R.a,{overlay:q,disabled:!!(null===B||void 0===B?void 0:B.placeholder)||D,children:Object(_.jsxs)(Or,{"data-testid":"charting-library-btn",size:"small",children:[null===L||void 0===L?void 0:L.title,Object(_.jsx)(qa.a,{})]})}):null]}),Object(_.jsxs)(Or.Group,{children:[Object(_.jsx)(Or,{"data-testid":"chart-btn",size:"small",type:o?"default":"primary",disabled:!!(null===B||void 0===B?void 0:B.placeholder)||D,onClick:function(){Vr("Show Chart"),e.setState({showCode:null})},children:"Chart"}),Object(_.jsx)(Or,{"data-testid":"json-query-btn",size:"small",type:"query"===o?"primary":"default",disabled:!!(null===B||void 0===B?void 0:B.placeholder)||D,onClick:function(){Vr("Show Query"),e.setState({showCode:"query"})},children:"JSON Query"}),Object(_.jsx)(Or,{"data-testid":"code-btn",icon:Object(_.jsx)(Ra.a,{}),size:"small",type:"code"===o?"primary":"default",disabled:!!(null===B||void 0===B?void 0:B.placeholder)||D,onClick:function(){Vr("Show Code"),e.setState({showCode:"code"})},children:"Code"}),Object(_.jsx)(Or,{"data-testid":"sql-btn",icon:Object(_.jsx)(Ma.a,{}),size:"small",type:"sql"===o?"primary":"default",disabled:!!(null===B||void 0===B?void 0:B.placeholder)||D,onClick:function(){Vr("Show SQL"),e.setState({showCode:"sql"})},children:"SQL"}),Object(_.jsx)(Or,{"data-testid":"cache-btn",icon:Object(_.jsx)(Ia.a,{}),size:"small",type:"cache"===o?"primary":"default",disabled:!!(null===B||void 0===B?void 0:B.placeholder)||D,onClick:function(){Vr("Show Cache"),e.setState({showCode:"cache"})},children:"Cache"})]}),Object(_.jsx)(Or,{"data-testid":"edit-btn",icon:Object(_.jsx)(La.a,{}),size:"small",htmlType:"submit",disabled:!!(null===B||void 0===B?void 0:B.placeholder)||D,onClick:function(){return Vr("Open Code Sandbox")},children:"Edit"}),y&&Object(_.jsx)(Or,{"data-testid":"add-to-dashboard-btn",onClick:Object(p.a)(d.a.mark((function t(){var r;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({addingToDashboard:!0}),t.next=3,y.canAddChart();case 3:if("boolean"!==typeof(r=t.sent)||!r){t.next=11;break}return Vr("Add to Dashboard"),t.next=8,y.addChart(n);case 8:e.setState({redirectToDashboard:!0,addingToDashboard:!1}),t.next=12;break;case 11:r?(e.setState({addingToDashboard:!1}),ne.a.error({title:"There is an error loading your dashboard app",content:r,okText:"Fix",okCancel:!0,onOk:function(){C.push("/dashboard")}})):(e.setState({addingToDashboard:!1}),ne.a.error({title:"Your dashboard app does not support adding of static charts",content:"Please use static dashboard template"}));case 12:case"end":return t.stop()}}),t)}))),icon:Object(_.jsx)(Pa.a,{}),size:"small",loading:c,disabled:!!(null===B||void 0===B?void 0:B.placeholder)||D,type:"primary",children:c?"Preparing dashboard app. It may take a while. Please check console for progress...":"Add to Dashboard"})]})]}),F=JSON.stringify(O,null,2);return T="code"===o?Object(_.jsxs)(da,{style:{alignItems:"center"},children:[Object(_.jsx)("div",{children:"Code"}),Object(_.jsx)(Or,{"data-testid":"copy-code-btn",icon:Object(_.jsx)(ie.a,{}),size:"small",disabled:Boolean(f),onClick:Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,he(n);case 2:Vr("Copy Code to Clipboard");case 3:case"end":return e.stop()}}),e)}))),type:"primary",children:"Copy to Clipboard"})]}):"query"===o?Object(_.jsxs)(da,{children:[Object(_.jsx)("div",{children:"Query"}),Object(_.jsx)(Or,{"data-testid":"copy-cube-query-btn",icon:Object(_.jsx)(ie.a,{}),size:"small",onClick:Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,he(JSON.stringify(O,null,2));case 2:Vr("Copy Query to Clipboard");case 3:case"end":return e.stop()}}),e)}))),type:"primary",children:"Copy to Clipboard"})]}):"sql"===o?Object(_.jsxs)(da,{children:[Object(_.jsx)("div",{children:"SQL"}),!u.loading&&u.value?Object(_.jsx)(Or,{"data-testid":"copy-sql-btn",icon:Object(_.jsx)(ie.a,{}),size:"small",onClick:Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,he(u.value,"The SQL has been copied");case 2:Vr("Copy SQL to Clipboard");case 3:case"end":return e.stop()}}),e)}))),type:"primary",children:"Copy to Clipboard"}):null]}):"cache"===o?"Cache":"Chart",g?v({resultSet:m,error:f}):Object(_.jsx)(gi,{title:T,style:{minHeight:420},extra:z,children:function(){if(null===B||void 0===B?void 0:B.placeholder){var t=B.placeholder;return Object(_.jsx)(t,{framework:S})}return"code"===o?f?Object(_.jsx)(yr,{error:f}):Object(_.jsx)(Tr,{code:n}):"query"===o?Object(_.jsx)(Tr,{code:F}):"sql"===o?Object(_.jsx)(ei,{loadSql:"only",query:O,render:function(t){var n=t.sqlQuery,r=t.loadingState,a=t.error;if(a)return Object(_.jsx)(yr,{error:a});var i=Array.isArray(n)?n:[n],o=Object(Q.a)(i,1)[0],c=o&&Object(mi.format)(o.sql());return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(Tr,{code:c}),Object(_.jsx)(ki,{loading:r.isLoading,sql:c,onChange:function(t){var n=t.sql,r=t.loading;e.setState({sql:{loading:r,value:n}})}})]})}}):"cache"===o?Object(_.jsx)(vi,{query:O}):v({framework:S,error:f})}()})}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(e.isChartRendererReady&&null!=e.iframeRef.current&&e.chartingLibrary){var n=(e.iframeRef.current.contentWindow||{}).__cubejsPlayground;if(!n)return Object(b.a)(Object(b.a)({},t),{},{chartRendererError:"The chart renderer failed to load"});var r=n.getCodesandboxFiles(e.chartingLibrary,{chartType:e.chartType,query:JSON.stringify(e.query,null,2),pivotConfig:JSON.stringify(e.pivotConfig,null,2),apiUrl:e.apiUrl,cubejsToken:e.cubejsToken}),a="";return"react"===e.framework?a=r["index.js"]:"angular"===e.framework?a=r["src/app/query-renderer/query-renderer.component.ts"]:"vue"===e.framework&&(a=r["src/components/ChartRenderer.vue"]),Object(b.a)(Object(b.a)({},t),{},{chartRendererError:null,dependencies:n.getDependencies(e.chartingLibrary),codeExample:a,codesandboxFiles:r})}return t}}]),n}(w.Component);function ki(e){var t=e.sql,n=e.loading,r=e.onChange;return Object(w.useEffect)((function(){r({sql:t,loading:n})}),[t,n]),null}xi.defaultProps={query:{},hideActions:!1};var wi,Ci,Si,Ai,Di,Ei,Ti,Pi,qi=Object(j.g)(xi),Ri=n(497),Mi=n(835),Ii=n(853),Li=Object(D.d)(ne.a)(wi||(wi=Object(k.a)(["\n  && {\n    .ant-modal-header {\n      border-bottom: none;\n      padding: 40px 32px 0 32px;\n\n      .ant-modal-title {\n        font-size: 20px;\n      }\n    }\n\n    .ant-modal-footer {\n      border-top: none;\n      padding: 0 32px 34px 32px;\n      text-align: left;\n    }\n  }\n"]))),_i=Object(D.d)(Mi.a)(Ci||(Ci=Object(k.a)(["\n  && {\n    .ant-form-item-label {\n      line-height: 16px;\n      margin-bottom: 7px;\n      label {\n        font-weight: 500;\n        font-size: 12px;\n        line-height: 16px;\n      }\n    }\n\n    .ant-dropdown-trigger {\n      padding: 5px 12px;\n    }\n  }\n"]))),Bi=Object(D.d)(Mi.a.Item)(Si||(Si=Object(k.a)(["\n  && {\n    &:not(:last-child) {\n      margin-bottom: 16px;\n    }\n\n    &:last-child {\n      margin-bottom: 0;\n    }\n  }\n"]))),zi=function(){return Object(_.jsx)(Ri.a,{style:{color:"#727290"}})},Fi=function(e){var t=e.visible,n=e.onOk,r=e.onCancel,a=e.onChange,i=e.chartLibraries,o=e.currentLibraryItem,c=e.frameworks,s=e.framework,u=e.frameworkItem,l=e.templatePackages,d=e.templatePackage,b=e.enableWebSocketTransport,p=Object(_.jsx)(M.a,{onClick:function(e){Vr("Set Chart Library",{chartLibrary:e.key}),a("chartLibrary",e.key)},children:i.map((function(e){return Object(_.jsx)(M.a.Item,{children:e.title},e.value)}))}),h=Object(_.jsx)(M.a,{onClick:function(e){Vr("Set Framework",{framework:e.key}),a("framework",e.key)},children:c.map((function(e){return Object(_.jsx)(M.a.Item,{children:e.title},e.id)}))}),m=Object(_.jsx)(M.a,{onClick:function(e){Vr("Set Template Package",{templatePackageName:e.key}),a("templatePackageName",e.key)},children:(l||[]).map((function(e){return Object(_.jsx)(M.a.Item,{children:e.description},e.name)}))});return Object(_.jsx)(Li,{title:"Create your own Dashboard App",visible:t,onOk:n,onCancel:r,footer:[Object(_.jsx)(Or,{type:"primary",onClick:n,children:"Ok"},"submit"),Object(_.jsx)(Or,{onClick:r,children:"Cancel"},"back")],children:Object(_.jsxs)(_i,{children:[Object(_.jsx)(Bi,{label:"Framework",children:Object(_.jsx)(R.a,{overlay:h,children:Object(_.jsxs)(Or,{children:[u&&u.title,Object(_.jsx)(zi,{})]})})}),!(null===u||void 0===u?void 0:u.scaffoldingSupported)&&Object(_.jsx)(A.a,{style:{marginBottom:23},type:"info",message:Object(_.jsxs)("span",{children:["We do not support\xa0",u.title,"\xa0dashboard scaffolding generation yet. Please refer to\xa0",Object(_.jsxs)("a",{href:u.docsLink,target:"_blank",rel:"noopener noreferrer",onClick:function(){return Vr("Unsupported Dashboard Framework Docs",{framework:s})},children:[u.title,"\xa0docs"]}),"\xa0to see on how to use it with Cube.js."]})}),Object(_.jsx)(Bi,{label:"Main Template",children:Object(_.jsx)(R.a,{overlay:m,disabled:!u.scaffoldingSupported,children:Object(_.jsxs)(Or,{children:[d&&d.description,Object(_.jsx)(zi,{})]})})}),Object(_.jsx)(Bi,{label:"Charting Library",children:Object(_.jsx)(R.a,{overlay:p,disabled:!u.scaffoldingSupported,children:Object(_.jsxs)(Or,{children:[o&&o.title,Object(_.jsx)(zi,{})]})})}),Object(_.jsx)(Bi,{label:"Web Socket Transport (Real-time)",children:Object(_.jsx)(Ii.a,{disabled:"react"!==s.toLowerCase(),checked:b,onChange:function(e){return a("enableWebSocketTransport",e)}})})]})})},Ni=n(863),Qi=n(498),Ui=Object(w.createContext)({});function Ki(e){var t=e.children,n=Object(w.useState)({}),r=Object(Q.a)(n,2),a=r[0],i=r[1],o=Object(w.useState)({}),c=Object(Q.a)(o,2),s=c[0],u=c[1],l=Object(w.useState)({}),d=Object(Q.a)(l,2),p=d[0],h=d[1],m=Object(w.useState)({}),f=Object(Q.a)(m,2),j=f[0],v=f[1],y=Object(w.useState)({}),g=Object(Q.a)(y,2),O=g[0],x=g[1],k=Object(w.useState)({}),C=Object(Q.a)(k,2),S=C[0],A=C[1],D=Object(w.useState)({}),E=Object(Q.a)(D,2),T=E[0],P=E[1],q=Object(w.useState)({}),R=Object(Q.a)(q,2),M=R[0],I=R[1],L=Object(w.useState)({}),B=Object(Q.a)(L,2),z=B[0],F=B[1];return Object(_.jsx)(Ui.Provider,{value:{chartRendererState:a,setChartRendererReady:function(e,t){i((function(n){return Object(b.a)(Object(b.a)({},n),{},Object(ce.a)({},e,t))}))},queryStatus:s,setQueryStatus:function(e,t){u((function(n){return Object(b.a)(Object(b.a)({},n),{},Object(ce.a)({},e,t))}))},resultSetExists:p,setResultSetExists:function(e,t){h((function(n){return Object(b.a)(Object(b.a)({},n),{},Object(ce.a)({},e,t))}))},isQueryLoading:j,setQueryLoading:function(e,t){v((function(n){return Object(b.a)(Object(b.a)({},n),{},Object(ce.a)({},e,t))}))},queryError:O,setQueryError:function(e,t){x((function(n){return Object(b.a)(Object(b.a)({},n),{},Object(ce.a)({},e,t))}))},isBuildInProgress:S,setBuildInProgress:function(e,t){A((function(n){return Object(b.a)(Object(b.a)({},n),{},Object(ce.a)({},e,t))}))},slowQuery:T,setSlowQuery:function(e,t){P((function(n){return Object(b.a)(Object(b.a)({},n),{},Object(ce.a)({},e,t))}))},slowQueryFromCache:M,setSlowQueryFromCache:function(e,t){I((function(n){return Object(b.a)(Object(b.a)({},n),{},Object(ce.a)({},e,t))}))},queryRequestId:z,setQueryRequestId:function(e,t){F((function(n){return Object(b.a)(Object(b.a)({},n),{},Object(ce.a)({},e,t))}))}},children:t})}function Vi(e){var t=Object(w.useContext)(Ui),n=t.chartRendererState,r=t.queryStatus,a=t.resultSetExists,i=t.isQueryLoading,o=t.queryError,c=t.isBuildInProgress,s=t.slowQuery,u=t.slowQueryFromCache,l=t.queryRequestId;return{isChartRendererReady:Boolean(n[e]),queryStatus:r[e],resultSetExists:a[e],isQueryLoading:Boolean(i[e]),queryError:o[e]||null,isBuildInProgress:Boolean(c[e]),slowQuery:Boolean(s[e]),slowQueryFromCache:Boolean(u[e]),queryRequestId:l[e]}}function Yi(){var e=Object(w.useContext)(Ui);return{setChartRendererReady:e.setChartRendererReady,setQueryStatus:e.setQueryStatus,setResultSetExists:e.setResultSetExists,setQueryLoading:e.setQueryLoading,setQueryError:e.setQueryError,setBuildInProgress:e.setBuildInProgress,setSlowQuery:e.setSlowQuery,setSlowQueryFromCache:e.setSlowQueryFromCache,setQueryRequestId:e.setQueryRequestId}}var Ji=V.a.Text,Gi=D.d.div(Ai||(Ai=Object(k.a)(["\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  right: 0;\n  left: 0;\n"]))),Wi=D.d.div(Di||(Di=Object(k.a)(["\n  visibility: ",";\n  min-height: 400px;\n\n  & > iframe {\n    width: 100%;\n    min-height: 400px;\n    border: none;\n  }\n"])),(function(e){return e.invisible?"hidden":"visible"})),Hi=D.d.div(Ei||(Ei=Object(k.a)(["\n  position: absolute;\n  width: 100%;\n  bottom: -4em;\n  animation: fadeIn 0.3s;\n\n  @keyframes fadeIn {\n    from {\n      opacity: 0;\n    }\n\n    to {\n      opacity: 1;\n    }\n  }\n"]))),Zi=D.d.div(Ti||(Ti=Object(k.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n"]))),$i=D.d.div(Pi||(Pi=Object(k.a)(["\n  position: relative;\n  width: 100%;\n  text-align: center;\n"])));function Xi(e){var t=e.queryId,n=e.areQueriesEqual,r=e.isFetchingMeta,a=e.iframeRef,i=e.framework,o=e.queryHasMissingMembers,c=e.onRunButtonClick,s=Object(w.useContext)(Ya).cubejsApi,u=Vi(t),l=u.isChartRendererReady,d=u.isQueryLoading,b=u.resultSetExists,p=u.queryError,h=u.isBuildInProgress,m=u.slowQuery,f=u.slowQueryFromCache,j=Yi(),v=j.setResultSetExists,y=j.setChartRendererReady,g=j.setQueryError,O=Object(w.useRef)(null);Object(Qi.a)("cmd+enter",(function(){var e;null===(e=O.current)||void 0===e||e.click()})),Object(w.useEffect)((function(){return function(){y(t,!1)}}),[]),Object(w.useEffect)((function(){!n&&p&&g(t,null)}),[t,n,p]),Object(w.useEffect)((function(){v(t,!1)}),[i]);var x=o||d||h||!s,k=!l||h||Boolean(p)||o||x||!n||!b,C=m?"This query takes more than 5 seconds to execute. Please consider using pre-aggregations to improve its performance. ":f?"This query takes more than 5 seconds to execute. It was served from the cache because Cube.js wasn't able to renew it in less than 5 seconds. Please consider using pre-aggregations to improve its performance. ":"";return Object(_.jsxs)(_.Fragment,{children:[(m||f)&&Object(_.jsx)(A.a,{style:{marginBottom:24},message:C,type:"warning"}),p?Object(_.jsx)(yr,{error:p}):o?Object(_.jsx)("div",{children:"At least one of the query members is missing from your data schema. Please update your query or data schema."}):x?Object(_.jsx)(Gi,{children:Object(_.jsx)(Zi,{children:Object(_.jsxs)($i,{children:[Object(_.jsx)(pr,{full:!1}),h&&Object(_.jsx)(Hi,{children:Object(_.jsx)(Ji,{strong:!0,style:{fontSize:18},children:"Building pre-aggregations..."})})]})})}):n&&b?null:Object(_.jsx)(Gi,{children:Object(_.jsx)(Zi,{children:Object(_.jsx)(Or,{"data-testid":"run-query-btn",ref:O,size:"large",type:"primary",loading:!l||r,icon:Object(_.jsx)(Ni.a,{}),onClick:c,children:"Run"})})}),Object(_.jsx)(Wi,{invisible:k,children:s?Object(_.jsx)("iframe",{id:"iframe-".concat(t),"data-testid":"chart-renderer",ref:a,title:"Chart renderer",src:"/chart-renderers/".concat(i,"/index.html#queryId=").concat(t)}):null})]})}var eo=n(830),to=n(840),no=n(483),ro=n.n(no),ao=n(113),io=n(864);function oo(e){var t=e.id,n=e.index;return Object(_.jsx)(ao.b,{draggableId:t,index:n,children:function(e){var n=e.draggableProps,r=e.dragHandleProps,a=e.innerRef;return Object(_.jsx)("div",Object(b.a)(Object(b.a)(Object(b.a)({ref:a},n),r),{},{style:Object(b.a)(Object(b.a)({},n.style),{},{border:"1px dashed var(--dark-05-color)",borderRadius:4,padding:"5px 12px",lineHeight:"22px"}),children:Object(_.jsxs)(V.a.Text,{ellipsis:!0,style:{maxWidth:"100%"},children:[Object(_.jsx)(io.a,{style:{marginRight:8}}),t]})}))}})}function co(e){var t=e.pivotConfig,n=e.axis;return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(V.a.Text,{strong:!0,style:{display:"flex",justifyContent:"center",padding:"8px 16px",background:"var(--light-5)",borderBottom:"1px solid var(--light-color)"},children:n}),Object(_.jsx)("div",{"data-testid":"pivot-popover-".concat(n),style:{padding:"8px"},children:Object(_.jsx)(ao.c,{droppableId:n,children:function(e){return Object(_.jsxs)("div",Object(b.a)(Object(b.a)({ref:e.innerRef},e.droppableProps),{},{style:{display:"grid",gridTemplateColumns:"minmax(0, 1fr)",gap:"8px",height:"100%",minHeight:"32px"},children:[t[n].map((function(e,t){return Object(_.jsx)(oo,{id:e,index:t},e)})),e.placeholder]}))}})})]})}var so=["source","destination"];function uo(e){var t=e.pivotConfig,n=e.onMove;return Object(_.jsx)(ao.a,{onDragEnd:function(e){var t=e.source,r=e.destination;Object(h.a)(e,so);r&&n({sourceIndex:t.index,destinationIndex:r.index,sourceAxis:t.droppableId,destinationAxis:r.droppableId})},children:Object(_.jsxs)(Ta.a,{children:[Object(_.jsx)(Ea.a,{span:12,style:{minWidth:160},children:Object(_.jsx)(co,{pivotConfig:t,axis:"x"})}),Object(_.jsx)(Ea.a,{span:12,style:{minWidth:160},children:Object(_.jsx)(co,{pivotConfig:t,axis:"y"})})]})})}var lo=n(241);function bo(e){var t=e.pivotConfig,n=e.onUpdate;return Object(_.jsx)(lo.a,{checked:t.fillMissingDates,onChange:function(){return n({fillMissingDates:!t.fillMissingDates})},children:"Fill Missing Dates"})}var po=n(294);function ho(e){var t=e.id,n=e.index,r=e.order,a=void 0===r?"none":r,i=e.children,o=e.onOrderChange;return Object(_.jsx)(ao.b,{draggableId:t,index:n,children:function(e){var n=e.draggableProps,r=e.dragHandleProps,c=e.innerRef;return Object(_.jsxs)("div",Object(b.a)(Object(b.a)(Object(b.a)({"data-testid":"order-item",ref:c},n),r),{},{style:Object(b.a)({display:"flex",flexWrap:"nowrap",justifyContent:"space-between",alignItems:"center",marginBottom:8},n.style),children:[Object(_.jsx)(io.a,{}),Object(_.jsx)(V.a.Text,{ellipsis:!0,style:{margin:"0 auto 0 8px",padding:"5px 0"},children:i}),Object(_.jsxs)(po.a.Group,{onChange:function(e){return o(t,e.target.value)},defaultValue:a,size:"small",style:{marginLeft:"8px"},children:[Object(_.jsx)(po.a.Button,{value:"asc",children:"ASC"}),Object(_.jsx)(po.a.Button,{value:"desc",children:"DESC"}),Object(_.jsx)(po.a.Button,{value:"none",children:"NONE"})]})]}))}})}function mo(e){var t=e.orderMembers,n=e.onOrderChange,r=e.onReorder;return Object(_.jsx)(ao.a,{onDragEnd:function(e){var t=e.source,n=e.destination;r(t&&t.index,n&&n.index)},children:Object(_.jsx)(ao.c,{droppableId:"droppable",children:function(e){return Object(_.jsxs)("div",Object(b.a)(Object(b.a)({"data-testid":"order-popover",ref:e.innerRef},e.droppableProps),{},{children:[t.map((function(e,t){var r=e.id,a=e.title,i=e.order;return Object(_.jsx)(ho,{id:r,index:t,order:i,onOrderChange:n,children:a},r)})),e.placeholder]}))}})})}function fo(e){var t=e.pivotConfig,n=e.orderMembers,r=e.limit,a=e.disabled,i=e.onMove,o=e.onUpdate,c=e.onReorder,s=e.onOrderChange,u=e.isQueryPresent,l=Object(w.useState)(r),d=Object(Q.a)(l,2),b=d[0],p=d[1],h=Object(w.useState)(!1),m=Object(Q.a)(h,2),f=m[0],j=m[1];return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(ro.a,{style:{lineHeight:"32px"},children:"Settings:"}),Object(_.jsx)(Ar,{content:null===t?Object(_.jsx)(na.a,{}):Object(_.jsxs)("div",{"data-testid":"pivot-popover",children:[Object(_.jsx)(uo,{pivotConfig:t,onMove:i}),Object(_.jsx)(eo.a,{style:{margin:0}}),Object(_.jsx)("div",{style:{padding:"8px"},children:Object(_.jsx)(bo,{pivotConfig:t,onUpdate:o})})]}),placement:"bottomLeft",trigger:"click",children:Object(_.jsx)(Or,{"data-testid":"pivot-btn",disabled:!u||a,style:{border:0},children:"Pivot"})}),Object(_.jsx)(Ar,{content:Object(_.jsx)("div",{style:{padding:"8px",paddingBottom:1},children:Object(_.jsx)(mo,{orderMembers:n,onReorder:c,onOrderChange:s})}),placement:"bottomLeft",trigger:"click",children:Object(_.jsx)(Or,{"data-testid":"order-btn",disabled:!u||a,style:{border:0},children:"Order"})}),Object(_.jsx)(Ar,{visible:f,content:Object(_.jsx)("div",{style:{padding:"8px"},children:Object(_.jsxs)("label",{children:["Limit"," ",Object(_.jsx)(to.a,{prefix:"Limit",type:"number",value:b,step:500,onChange:p,onPressEnter:function(){o({limit:b}),j(!1)}})]})}),placement:"bottomLeft",trigger:"click",onVisibleChange:function(e){j(e),e||o({limit:b})},children:Object(_.jsx)(Or,{"data-testid":"limit-btn",disabled:!u||a,style:{border:0},children:"Limit"})})]})}var jo,vo,yo,go=n(292),Oo=n.n(go),xo=["overlay","disabled"],ko=function(e){var t=e.overlay,n=e.disabled,r=void 0!==n&&n,a=Object(h.a)(e,xo);return Object(_.jsx)(R.a,{disabled:r,overlay:t,placement:"bottomLeft",trigger:["click"],children:Object(_.jsx)(Or,Object(b.a)(Object(b.a)({},a),{},{disabled:r}))})},wo=["availableCubes","showNoMembersPlaceholder","onClick"],Co=Object(D.d)(M.a)(jo||(jo=Object(k.a)(["\n  max-height: 320px;\n  overflow: hidden auto;\n  padding-top: 0;\n\n  li.ant-dropdown-menu-item-active {\n    background: #f3f3fb;\n  }\n"]))),So=Object(D.d)(Co.Item)(vo||(vo=Object(k.a)(["\n  position: sticky;\n  top: 0;\n  background: white;\n  padding-top: 10px;\n  padding-bottom: 0;\n  margin-bottom: 16px;\n\n  ::after {\n    display: block;\n    position: absolute;\n    content: '';\n    width: 100%;\n    left: 0;\n    bottom: -20px;\n    height: 20px;\n    background: linear-gradient(\n      to bottom,\n      rgba(255, 255, 255, 1),\n      rgba(255, 255, 255, 0)\n    );\n  }\n"])));function Ao(e){var t=e.isVisible;return void 0===t||t}function Do(e){var t=e.availableCubes,n=e.showNoMembersPlaceholder,r=void 0===n||n,a=e.onClick,i=Object(h.a)(e,wo),o=Object(w.useRef)(Oo.a.create({encode:"advanced"})),c=Object(w.useState)(""),s=Object(Q.a)(c,2),u=s[0],l=s[1],m=Object(w.useState)([]),f=Object(Q.a)(m,2),j=f[0],v=f[1],y=o.current,g=t.some((function(e){return e.members.filter(Ao).length>0})),O=_n((function(){return fn(t).forEach((function(e){var t=Object(Q.a)(e,2),n=t[0],r=t[1].title;return y.add(n,r)})),Object.fromEntries(fn(t))}),[t]);Object(w.useEffect)((function(){var e=u;return Object(p.a)(d.a.mark((function t(){var n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,y.search(u);case 2:if(n=t.sent,e===u){t.next=5;break}return t.abrupt("return");case 5:v(n);case 6:case"end":return t.stop()}}),t)})))(),function(){e=""}}),[y,u]);var x=u?function(e,t){var n=t.map((function(e){return e.split(".")[0]}));return e.filter((function(e){var t=e.cubeName;return n.includes(t)})).map((function(e){return Object(b.a)(Object(b.a)({},e),{},{members:e.members.filter((function(e){var n=e.name;return t.includes(n)}))})}))}(t,j):t;return Object(_.jsx)(ko,Object(b.a)(Object(b.a)({},i),{},{overlay:Object(_.jsx)(Co,{onClick:function(e){l(""),v([]),a(O[e.key])},children:g?Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(So,{disabled:!0,children:Object(_.jsx)(ee.a,{placeholder:"Search",autoFocus:!0,value:u,allowClear:!0,onKeyDown:function(e){["ArrowDown","ArrowUp"].includes(e.key)&&e.preventDefault()},onChange:function(e){l(e.target.value)}})}),x.map((function(e){var t=e.members.filter(Ao);return t.length?Object(_.jsx)(Co.ItemGroup,{title:e.cubeTitle,children:t.map((function(e){return Object(_.jsx)(Co.Item,{"data-testid":e.name,children:e.shortTitle},e.name)}))},e.cubeName):null}))]}):r?Object(_.jsx)(Co.Item,{disabled:!0,children:"No members found"}):null})}))}var Eo=["onRemoveClick","children"];function To(e){return null==e.color?"primary":{primary:"primary",danger:"pink"}[e.color]}var Po=Object(D.d)((function(e){var t=e.onRemoveClick,n=e.children,r=Object(h.a)(e,Eo);return Object(_.jsxs)(Or.Group,Object(b.a)(Object(b.a)({},r),{},{children:[n,Object(_.jsx)(Or,{ghost:!0,className:"remove-btn",disabled:r.disabled,onClick:t,children:Object(_.jsx)(fi.a,{})})]}))}))(yo||(yo=Object(k.a)(["\n  && {\n    border-radius: calc(var(--border-radius-base) + 1px);\n\n    .ant-btn {\n      border: none;\n\n      & + .ant-btn {\n        margin-left: 0;\n      }\n    }\n\n    .remove-btn {\n      padding: 8px;\n\n      .anticon {\n        height: 14px;\n        display: block;\n      }\n    }\n  }\n\n  &&:not(.disabled) {\n    border: 1px solid var(--","-color);\n    color: var(--","-color);\n\n    .ant-btn {\n      background-color: var(--","-9);\n      color: var(--","-color);\n\n      span {\n        color: var(--","-color);\n      }\n\n      &:hover {\n        background-color: var(--","-8);\n        border: none;\n        box-shadow: none;\n      }\n    }\n\n    .remove-btn {\n      background-color: white !important;\n      color: var(--","-color);\n\n      &:hover {\n        background-color: var(--","-8) !important;\n      }\n    }\n  }\n\n  &&.disabled {\n    border: 1px solid var(--disabled-color);\n    color: var(--disabled-color);\n\n    .ant-btn {\n      background-color: var(--disabled-bg);\n      color: var(--disabled-color);\n      border: none;\n\n      span {\n        color: var(--disabled-color);\n      }\n    }\n\n    .remove-btn {\n      color: var(--disabled-color);\n    }\n  }\n"])),To,To,To,To,To,To,To,To),qo=n(484),Ro={string:function(e){var t=e.values,n=void 0===t?[]:t,r=e.disabled,a=e.onChange;return Object(_.jsx)(pa,{disabled:r,style:{width:300},mode:"tags",value:n,maxTagCount:"responsive",onChange:a},"input")},number:function(e){var t=e.values,n=void 0===t?[]:t,r=e.disabled,a=e.onChange;return Object(_.jsx)(ee.a,{disabled:r,style:{width:300},onChange:function(e){return a([e.target.value])},value:(null===n||void 0===n?void 0:n[0])||""},"input")}};function Mo(e){var t=e.member,n=e.disabled,r=void 0!==n&&n,a=e.updateMethods,i=Ro[t.dimension.type]||Ro.string,o=Object(w.useRef)(Object(qo.a)(500,(function(e,t){a.update(e,Object(b.a)(Object(b.a)({},e),{},{values:t}))}))),c=Object(w.useState)(t.values),s=Object(Q.a)(c,2),u=s[0],l=s[1];return Object(_.jsx)(i,{disabled:r,values:u,onChange:function(e){l(e),o.current(t,e)}},"filter")}var Io=n(93);function Lo(e){var t=e.children;return Object(_.jsx)(Io.a,{overlayClassName:"missing-member-tooltip",placement:"top",title:"This member was removed from the data schema",color:"var(--dark-01-color)",children:t})}var _o=function(e){var t=e.disabled,n=void 0!==t&&t,r=e.members,a=e.availableMembers,i=e.addMemberName,o=e.updateMethods,c=e.missingMembers;return Object(_.jsxs)(da,{children:[r.map((function(e){var t=c.includes(e.member),r=Object(_.jsx)(Po,{disabled:n,className:n?"disabled":null,color:t?"danger":"primary",onRemoveClick:function(){return o.remove(e)},children:Object(_.jsx)(Do,{disabled:n,availableCubes:a,style:{width:150,textOverflow:"ellipsis",overflow:"hidden"},onClick:function(t){return o.update(e,Object(b.a)(Object(b.a)({},e),{},{dimension:t}))},children:e.dimension.title})});return Object(_.jsxs)(w.Fragment,{children:[t?Object(_.jsx)(Lo,{children:r}):r,Object(_.jsx)(pa,{disabled:n,value:e.operator,style:{width:200},onChange:function(t){return o.update(e,Object(b.a)(Object(b.a)({},e),{},{operator:t}))},children:e.operators.map((function(e){return Object(_.jsx)(pa.Option,{value:e.name,children:e.title},e.name)}))}),Object(_.jsx)(Mo,{disabled:n,member:e,updateMethods:o},"filterInput")]},e.index)})),Object(_.jsx)(Do,{availableCubes:a,type:"dashed",disabled:n,icon:Object(_.jsx)(Pa.a,{}),onClick:function(e){return o.add({member:e})},children:r.length?null:i})]})};function Bo(e){var t=e.disabled,n=void 0!==t&&t,r=e.members,a=e.availableMembers,i=e.missingMembers,o=e.addMemberName,c=e.updateMethods,s=Object(w.useCallback)((function(e){return c.add(e)}),[]);return Object(_.jsxs)(da,{children:[r.map((function(e){var t=i.includes(e.title),r=Object(_.jsx)(Po,{disabled:n,className:n?"disabled":null,color:t?"danger":"primary",onRemoveClick:function(){return c.remove(e)},children:Object(_.jsx)(Do,{disabled:n,availableCubes:a,onClick:function(t){return c.update(e,t)},children:e.title})},e.index||e.name);return t?Object(_.jsx)(Lo,{children:r},e.index||e.name):r})),Object(_.jsx)(Do,{"data-testid":o,disabled:n,availableCubes:a,type:"dashed",icon:Object(_.jsx)(Pa.a,{}),onClick:s,children:r.length?null:o})]})}var zo,Fo=n(865),No=n(866),Qo=n(867),Uo=n(868),Ko=n(869),Vo=n(208),Yo=[{name:"line",title:"Line",icon:Object(_.jsx)(Fo.a,{})},{name:"area",title:"Area",icon:Object(_.jsx)(No.a,{})},{name:"bar",title:"Bar",icon:Object(_.jsx)(Qo.a,{})},{name:"pie",title:"Pie",icon:Object(_.jsx)(Uo.a,{})},{name:"table",title:"Table",icon:Object(_.jsx)(Ko.a,{})},{name:"number",title:"Number",icon:Object(_.jsx)(Vo.a,{})}],Jo=function(e){var t=e.chartType,n=e.updateChartType,r=Object(_.jsx)(M.a,{"data-testid":"chart-type-dropdown",children:Yo.map((function(e){return Object(_.jsxs)(M.a.Item,{onClick:function(){return n(e.name)},children:[e.icon," ",e.title]},e.title)}))}),a=Yo.find((function(e){return e.name===t}));return Object(_.jsx)(ko,{"data-testid":"chart-type-btn",overlay:r,icon:null===a||void 0===a?void 0:a.icon,style:{border:0},children:(null===a||void 0===a?void 0:a.title)||""})},Go=n(832),Wo=n(127),Ho=n.n(Wo),Zo=D.d.div(zo||(zo=Object(k.a)(["\n  color: var(--dark-04-color);\n  line-height: 32px;\n"]))),$o=Go.a.RangePicker,Xo=[{title:"Custom",value:"custom"},{title:"All time",value:void 0},{value:"Today"},{value:"Yesterday"},{value:"This week"},{value:"This month"},{value:"This quarter"},{value:"This year"},{value:"Last 7 days"},{value:"Last 30 days"},{value:"Last week"},{value:"Last month"},{value:"Last quarter"},{value:"Last year"}],ec=function(e){var t,n=e.members,r=void 0===n?[]:n,a=e.disabled,i=void 0!==a&&a,o=e.availableMembers,c=e.missingMembers,s=e.addMemberName,u=e.updateMethods,l=e.parsedDateRange,d=Array.isArray(null===(t=r[0])||void 0===t?void 0:t.dateRange),p=Object(w.useState)(!1),h=Object(Q.a)(p,2),m=h[0],f=h[1];return Object(_.jsxs)(da,{children:[r.map((function(e,t){var n,r,a,s=c.includes(e.dimension.title),p=Object(_.jsx)(Po,{disabled:i,className:i?"disabled":null,color:s?"danger":"primary",onRemoveClick:function(){return u.remove(e)},children:Object(_.jsx)(Do,{"data-testid":"TimeDimension",disabled:i,availableCubes:o,onClick:function(t){return u.update(e,Object(b.a)(Object(b.a)({},e),{},{dimension:t}))},children:e.dimension.title})});return Object(_.jsxs)(w.Fragment,{children:[s?Object(_.jsx)(Lo,{children:p}):p,Object(_.jsx)(Zo,{children:"for"}),Object(_.jsx)(ko,{disabled:i,overlay:(a=function(t){"custom"===t.value?f(!0):(u.update(e,Object(b.a)(Object(b.a)({},e),{},{dateRange:t.value})),f(!1))},Object(_.jsx)(M.a,{children:Xo.map((function(e){return Object(_.jsx)(M.a.Item,{onClick:function(){return a(e)},children:e.title||e.value},e.title||e.value)}))})),children:m||d?"Custom":e.dateRange||"All time"}),m||d?Object(_.jsx)($o,{disabled:i,format:"YYYY-MM-DD",defaultValue:(l||[]).map((function(e){return Ho()(e)})),onChange:function(t){return function(e,t){t&&!t.some((function(e){return!e}))&&u.update(e,Object(b.a)(Object(b.a)({},e),{},{dateRange:t.map((function(e){return e.format("YYYY-MM-DD")}))}))}(e,t)}}):null,Object(_.jsx)(Zo,{children:"by"}),Object(_.jsx)(ko,{disabled:i,overlay:(n=e.dimension,r=function(t){return u.update(e,Object(b.a)(Object(b.a)({},e),{},{granularity:t.name}))},Object(_.jsx)(M.a,{children:n.granularities.length?n.granularities.map((function(e){return Object(_.jsx)(M.a.Item,{onClick:function(){return r(e)},children:e.title},e.title)})):Object(_.jsx)(M.a.Item,{disabled:!0,children:"No members found"})})),children:e.dimension.granularities.find((function(t){return t.name===e.granularity}))&&e.dimension.granularities.find((function(t){return t.name===e.granularity})).title})]},t)})),!r.length&&Object(_.jsx)(Do,{"data-testid":"TimeDimension",disabled:i,availableCubes:o,type:"dashed",icon:Object(_.jsx)(Pa.a,{}),onClick:function(e){return u.add({dimension:e,granularity:"day"})},children:s})]})},tc=n(871),nc=n(855),rc=n(841),ac=Object(w.createContext)({});var ic,oc,cc=n(300);var sc=M.a.SubMenu,uc=Object(D.d)(M.a)(ic||(ic=Object(k.a)(["\n  position: relative;\n  max-height: 600px;\n  overflow-y: scroll;\n\n  li {\n    font-size: var(--font-size-base);\n  }\n\n  .ant-menu-sub.ant-menu-inline {\n    background: white;\n  }\n\n  & li > div.ant-menu-submenu-title {\n    font-weight: 500;\n    color: var(--menu-highlight-color);\n  }\n\n  & li.ant-menu-item-group {\n    & > div {\n      text-transform: uppercase;\n      font-size: 10px;\n    }\n\n    & ul > li {\n      padding-left: 12px !important;\n    }\n  }\n\n  .ant-menu-item-group-list > li {\n    margin: 0 !important;\n\n    &::after {\n      display: none;\n    }\n  }\n\n  .ant-menu-item-selected,\n  .ant-menu-item-active:not(.ant-menu-item-selected) {\n    background: var(--primary-9) !important;\n    color: var(--primary-color);\n  }\n\n  .ant-menu-item-selected.ant-menu-item-active {\n    background: var(--primary-8) !important;\n  }\n\n  .ant-menu-submenu-arrow {\n    left: 10px;\n    right: initial;\n  }\n"]))),lc=D.d.div(oc||(oc=Object(k.a)(["\n  position: relative;\n  border-right: 1px solid rgba(0, 0, 0, 0.06);\n  padding: 16px 12px 10px 12px;\n\n  ::after {\n    z-index: 1;\n    display: block;\n    position: absolute;\n    content: '';\n    width: 100%;\n    left: 0;\n    bottom: -20px;\n    height: 20px;\n    background: linear-gradient(\n      to bottom,\n      rgba(255, 255, 255, 1),\n      rgba(255, 255, 255, 0)\n    );\n  }\n"]))),dc=["measures","dimensions","segments","timeDimensions"];function bc(e){var t=e.memberTypeCubeMap,n=e.openKeys,r=e.selectedKeys,a=e.firstOpenCubeName,i=e.onSelect,o=e.onOpenKeysChange,c=_n((function(){return jn(t).map((function(e){return e.cubeName}))}),[t]),s=function(e){var t=Object(w.useRef)(Oo.a.create({encode:"advanced"})).current,n=Object(w.useState)([]),r=Object(Q.a)(n,2),a=r[0],i=r[1],o=Object(w.useState)(""),c=Object(Q.a)(o,2),s=c[0],u=c[1];return _n((function(){var n=fn([].concat(Object(hn.a)(e.measures),Object(hn.a)(e.dimensions),Object(hn.a)(e.timeDimensions),Object(hn.a)(e.segments)));return n.forEach((function(e){var n=Object(Q.a)(e,2),r=n[0],a=n[1].title;return t.add(r,a)})),Object.fromEntries(n)}),[e]),Object(w.useEffect)((function(){var e=s;return Object(p.a)(d.a.mark((function n(){var r;return d.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.search(s);case 2:if(r=n.sent,e===s){n.next=5;break}return n.abrupt("return");case 5:i(r);case 6:case"end":return n.stop()}}),n)})))(),function(){e=""}}),[t,s]),{keys:a,search:s,inputProps:{value:s,onChange:function(e){u(e.target.value)}}}}(t),u=s.keys,l=s.search,h=s.inputProps,m=l?function(e,t){return e.map((function(e){var n=dc.map((function(n){return[n,(e[n]||[]).filter((function(e){var n=e.name;return t.includes(n)}))]}));return!!n.some((function(e){return Object(Q.a)(e,2)[1].length}))&&Object(b.a)(Object(b.a)({},e),Object.fromEntries(n))})).filter(Boolean)}(jn(t),u):jn(t);return Object(w.useLayoutEffect)((function(){a&&setTimeout((function(){var e,t;null===(e=document.querySelector('[data-menu="cubes"]'))||void 0===e||e.scroll({top:null===(t=document.querySelector('[data-cube="'.concat(a,'"]')))||void 0===t?void 0:t.offsetTop,behavior:"smooth"})}),100)}),[a]),Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(lc,{children:Object(_.jsx)(ee.a,Object(b.a)(Object(b.a)({},h),{},{allowClear:!0,autoFocus:!0,suffix:l?null:Object(_.jsx)(cc.a,{})}))}),Object(_.jsx)(uc,{"data-menu":"cubes",selectedKeys:r,openKeys:l?c:n,mode:"inline",onClick:function(e){var t=e.domEvent.target.dataset.membertype;i(t,e.key.toString().replace("td:",""))},children:m.map((function(e){return Object(_.jsx)(sc,{"data-cube":e.cubeName,title:e.cubeTitle,onTitleClick:function(e){var t=e.key;n.includes(t)?o(n.filter((function(e){return e!==t}))):o([].concat(Object(hn.a)(n),[t]))},children:dc.map((function(t){return e[t].length?Object(_.jsx)(M.a.ItemGroup,{title:"timeDimensions"===t?"time dimensions":t,children:e[t].map((function(e){var n="timeDimensions"===t?"td:".concat(e.name):e.name;return Object(_.jsxs)(M.a.Item,{"data-membertype":t,children:[Object(_.jsx)(oe.a,{style:{visibility:r.includes(n)?"visible":"hidden"}}),e.shortTitle]},n)}))},t):null}))},e.cubeName)}))})]})}var pc,hc,mc=n(492),fc=["name","cubeName"],jc=Object(D.d)(mc.a)(pc||(pc=Object(k.a)(["\n  background-color: var(--primary-9);\n  color: var(--primary-color);\n  padding: 6px 10px;\n  font-size: var(--font-size-base);\n  border: none;\n\n  .ant-tag-close-icon {\n    color: var(--primary-color);\n    padding-left: 6px;\n  }\n\n  b {\n    font-weight: 600;\n  }\n"])));function vc(e){var t=e.name,n=e.cubeName,r=Object(h.a)(e,fc);return Object(_.jsxs)(jc,Object(b.a)(Object(b.a)({"data-testid":"member-tag-".concat(n,".").concat(t),closable:!0,visible:!0},r),{},{children:[n," ",Object(_.jsx)("b",{children:t})]}))}var yc=Object(D.d)(V.a.Paragraph)(hc||(hc=Object(k.a)(["\n  font-size: 10px;\n  text-transform: uppercase;\n  color: rgba(20, 20, 70, 0.5);\n"])));function gc(e){var t=e.title,n=e.members,r=e.onRemove;return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(yc,{children:t}),Object(_.jsx)(re.b,{wrap:!0,children:n.map((function(e){return e?Object(_.jsx)(vc,{name:e.shortTitle,cubeName:e.title.replace(e.shortTitle,"").trim(),onClose:function(){return r(e.name)}}):(console.warn("Rollup Designer received 'undefined' member as ".concat(t)),null)}))})]})}var Oc=n(870),xc=n(368),kc=["Africa/Abidjan","Africa/Accra","Africa/Algiers","Africa/Bissau","Africa/Cairo","Africa/Casablanca","Africa/Ceuta","Africa/El_Aaiun","Africa/Johannesburg","Africa/Juba","Africa/Khartoum","Africa/Lagos","Africa/Maputo","Africa/Monrovia","Africa/Nairobi","Africa/Ndjamena","Africa/Sao_Tome","Africa/Tripoli","Africa/Tunis","Africa/Windhoek","America/Adak","America/Anchorage","America/Araguaina","America/Argentina/Buenos_Aires","America/Argentina/Catamarca","America/Argentina/Cordoba","America/Argentina/Jujuy","America/Argentina/La_Rioja","America/Argentina/Mendoza","America/Argentina/Rio_Gallegos","America/Argentina/Salta","America/Argentina/San_Juan","America/Argentina/San_Luis","America/Argentina/Tucuman","America/Argentina/Ushuaia","America/Asuncion","America/Atikokan","America/Bahia","America/Bahia_Banderas","America/Barbados","America/Belem","America/Belize","America/Blanc-Sablon","America/Boa_Vista","America/Bogota","America/Boise","America/Cambridge_Bay","America/Campo_Grande","America/Cancun","America/Caracas","America/Cayenne","America/Chicago","America/Chihuahua","America/Costa_Rica","America/Creston","America/Cuiaba","America/Curacao","America/Danmarkshavn","America/Dawson","America/Dawson_Creek","America/Denver","America/Detroit","America/Edmonton","America/Eirunepe","America/El_Salvador","America/Fort_Nelson","America/Fortaleza","America/Glace_Bay","America/Godthab","America/Goose_Bay","America/Grand_Turk","America/Guatemala","America/Guayaquil","America/Guyana","America/Halifax","America/Havana","America/Hermosillo","America/Indiana/Indianapolis","America/Indiana/Knox","America/Indiana/Marengo","America/Indiana/Petersburg","America/Indiana/Tell_City","America/Indiana/Vevay","America/Indiana/Vincennes","America/Indiana/Winamac","America/Inuvik","America/Iqaluit","America/Jamaica","America/Juneau","America/Kentucky/Louisville","America/Kentucky/Monticello","America/La_Paz","America/Lima","America/Los_Angeles","America/Maceio","America/Managua","America/Manaus","America/Martinique","America/Matamoros","America/Mazatlan","America/Menominee","America/Merida","America/Metlakatla","America/Mexico_City","America/Miquelon","America/Moncton","America/Monterrey","America/Montevideo","America/Nassau","America/New_York","America/Nipigon","America/Nome","America/Noronha","America/North_Dakota/Beulah","America/North_Dakota/Center","America/North_Dakota/New_Salem","America/Ojinaga","America/Panama","America/Pangnirtung","America/Paramaribo","America/Phoenix","America/Port-au-Prince","America/Port_of_Spain","America/Porto_Velho","America/Puerto_Rico","America/Punta_Arenas","America/Rainy_River","America/Rankin_Inlet","America/Recife","America/Regina","America/Resolute","America/Rio_Branco","America/Santarem","America/Santiago","America/Santo_Domingo","America/Sao_Paulo","America/Scoresbysund","America/Sitka","America/St_Johns","America/Swift_Current","America/Tegucigalpa","America/Thule","America/Thunder_Bay","America/Tijuana","America/Toronto","America/Vancouver","America/Whitehorse","America/Winnipeg","America/Yakutat","America/Yellowknife","Antarctica/Casey","Antarctica/Davis","Antarctica/DumontDUrville","Antarctica/Macquarie","Antarctica/Mawson","Antarctica/Palmer","Antarctica/Rothera","Antarctica/Syowa","Antarctica/Troll","Antarctica/Vostok","Asia/Almaty","Asia/Amman","Asia/Anadyr","Asia/Aqtau","Asia/Aqtobe","Asia/Ashgabat","Asia/Atyrau","Asia/Baghdad","Asia/Baku","Asia/Bangkok","Asia/Barnaul","Asia/Beirut","Asia/Bishkek","Asia/Brunei","Asia/Chita","Asia/Choibalsan","Asia/Colombo","Asia/Damascus","Asia/Dhaka","Asia/Dili","Asia/Dubai","Asia/Dushanbe","Asia/Famagusta","Asia/Gaza","Asia/Hebron","Asia/Ho_Chi_Minh","Asia/Hong_Kong","Asia/Hovd","Asia/Irkutsk","Asia/Jakarta","Asia/Jayapura","Asia/Jerusalem","Asia/Kabul","Asia/Kamchatka","Asia/Karachi","Asia/Kathmandu","Asia/Khandyga","Asia/Kolkata","Asia/Krasnoyarsk","Asia/Kuala_Lumpur","Asia/Kuching","Asia/Macau","Asia/Magadan","Asia/Makassar","Asia/Manila","Asia/Nicosia","Asia/Novokuznetsk","Asia/Novosibirsk","Asia/Omsk","Asia/Oral","Asia/Pontianak","Asia/Pyongyang","Asia/Qatar","Asia/Qostanay","Asia/Qyzylorda","Asia/Riyadh","Asia/Sakhalin","Asia/Samarkand","Asia/Seoul","Asia/Shanghai","Asia/Singapore","Asia/Srednekolymsk","Asia/Taipei","Asia/Tashkent","Asia/Tbilisi","Asia/Tehran","Asia/Thimphu","Asia/Tokyo","Asia/Tomsk","Asia/Ulaanbaatar","Asia/Urumqi","Asia/Ust-Nera","Asia/Vladivostok","Asia/Yakutsk","Asia/Yangon","Asia/Yekaterinburg","Asia/Yerevan","Atlantic/Azores","Atlantic/Bermuda","Atlantic/Canary","Atlantic/Cape_Verde","Atlantic/Faroe","Atlantic/Madeira","Atlantic/Reykjavik","Atlantic/South_Georgia","Atlantic/Stanley","Australia/Adelaide","Australia/Brisbane","Australia/Broken_Hill","Australia/Currie","Australia/Darwin","Australia/Eucla","Australia/Hobart","Australia/Lindeman","Australia/Lord_Howe","Australia/Melbourne","Australia/Perth","Australia/Sydney","Europe/Amsterdam","Europe/Andorra","Europe/Astrakhan","Europe/Athens","Europe/Belgrade","Europe/Berlin","Europe/Brussels","Europe/Bucharest","Europe/Budapest","Europe/Chisinau","Europe/Copenhagen","Europe/Dublin","Europe/Gibraltar","Europe/Helsinki","Europe/Istanbul","Europe/Kaliningrad","Europe/Kiev","Europe/Kirov","Europe/Lisbon","Europe/London","Europe/Luxembourg","Europe/Madrid","Europe/Malta","Europe/Minsk","Europe/Monaco","Europe/Moscow","Europe/Oslo","Europe/Paris","Europe/Prague","Europe/Riga","Europe/Rome","Europe/Samara","Europe/Saratov","Europe/Simferopol","Europe/Sofia","Europe/Stockholm","Europe/Tallinn","Europe/Tirane","Europe/Ulyanovsk","Europe/Uzhgorod","Europe/Vienna","Europe/Vilnius","Europe/Volgograd","Europe/Warsaw","Europe/Zaporozhye","Europe/Zurich","Indian/Chagos","Indian/Christmas","Indian/Cocos","Indian/Kerguelen","Indian/Mahe","Indian/Maldives","Indian/Mauritius","Indian/Reunion","Pacific/Apia","Pacific/Auckland","Pacific/Bougainville","Pacific/Chatham","Pacific/Chuuk","Pacific/Easter","Pacific/Efate","Pacific/Enderbury","Pacific/Fakaofo","Pacific/Fiji","Pacific/Funafuti","Pacific/Galapagos","Pacific/Gambier","Pacific/Guadalcanal","Pacific/Guam","Pacific/Honolulu","Pacific/Kiritimati","Pacific/Kosrae","Pacific/Kwajalein","Pacific/Majuro","Pacific/Marquesas","Pacific/Nauru","Pacific/Niue","Pacific/Norfolk","Pacific/Noumea","Pacific/Pago_Pago","Pacific/Palau","Pacific/Pitcairn","Pacific/Pohnpei","Pacific/Port_Moresby","Pacific/Rarotonga","Pacific/Tahiti","Pacific/Tarawa","Pacific/Tongatapu","Pacific/Wake","Pacific/Wallis","UTC"],wc=n(489),Cc=["timeDimensions"];function Sc(e,t){var n,r,a={measures:[],dimensions:[],segments:[],timeDimensions:[]};if(!e)return a;if(e.leafMeasures.length&&(a.measures=Object(hn.a)(e.leafMeasures)),e.sortedDimensions.length&&(a.dimensions=Object(hn.a)(e.sortedDimensions.filter((function(e){return!t.has(e)}))),a.segments=Object(hn.a)(e.sortedDimensions.filter((function(e){return t.has(e)})))),null===(n=e.sortedTimeDimensions)||void 0===n||null===(r=n[0])||void 0===r?void 0:r[0]){var i=Object(Q.a)(e.sortedTimeDimensions[0],2),o=i[0],c=i[1];a.timeDimensions=[{dimension:o,granularity:c||"day"}]}return a}function Ac(e){for(var t=0,n=Object.entries(e);t<n.length;t++){var r=Object(Q.a)(n[t],2)[1];if(Array.isArray(r)&&r.length>0)return!1}return!0}function Dc(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"main",n=arguments.length>2?arguments[2]:void 0,r=e.timeDimensions,a=Object(h.a)(e,Cc),i=Object(b.a)(Object(b.a)({},Object.entries(a).reduce((function(e,t){var n=Object(Q.a)(t,2),r=n[0],a=n[1];return Object(b.a)(Object(b.a)({},e),Array.isArray(a)&&a.length?Object(ce.a)({},r,a):null)}),{})),n);if(r.length){var o=e.timeDimensions[0],c=o.dimension,s=o.granularity;i.timeDimension=c,s&&(i.granularity="`".concat(s,"`"))}var u=JSON.stringify(i,null,2).replaceAll('"',"");return{code:"".concat(Object(wc.a)(t),": ").concat(u),value:u}}function Ec(e){var t;return"function"===typeof(null===e||void 0===e||null===(t=e.constructor)||void 0===t?void 0:t.isBuffer)&&e.constructor.isBuffer(e)}function Tc(e){return e}function Pc(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.delimiter||".",r=t.maxDepth||100,a=t.transformKey||Tc,i={};function o(e){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;Object.keys(e).forEach((function(u){var l=e[u],d=t.safe&&Array.isArray(l),b=Object.prototype.toString.call(l),p=Ec(l),h="[object Object]"===b||"[object Array]"===b,m=c?c+n+a(u):a(u);if(!d&&!p&&h&&Object.keys(l).length&&(!t.maxDepth||s<r))return o(l,m,s+1);i[m]=l}))}return o(e),i}var qc,Rc=["excludedGranularities"],Mc=D.d.div(qc||(qc=Object(k.a)(["\n  display: flex;\n  gap: 32px;\n  flex-direction: column;\n  padding: 24px;\n"]))),Ic=Tt.filter((function(e){var t=e.name;return!["second","minute"].includes(t||"")})).map((function(e){return e.name?e:Object(b.a)(Object(b.a)({},e),{},{title:"No partition"})}));function Lc(e){var t=e.members,n=e.hasTimeDimension,r=e.onCronExpressionValidityChange,a=e.onChange,i=te.a.useForm(),o=Object(Q.a)(i,1)[0],c={refreshKey:{checked:{every:!0,sql:!1},isCron:!1,sql:"",value:1,granularity:"hour",cron:"",timeZone:void 0},partitionGranularity:"",updateWindow:{value:7,granularity:"day"},incrementalRefresh:!0,buildRange:{since:{option:"relative",fixedDate:void 0,number:1,granularity:"year",time:"ago"},until:{option:"relative",fixedDate:void 0,number:1,granularity:"year",time:"from now"}},automatedRefresh:!0},s=Object(w.useMemo)((function(){var e=Pc(c);return a(e),e}),[]),u=Object(w.useState)(s),l=Object(Q.a)(u,2),d=l[0],p=l[1],h=Object(w.useState)(!1),m=Object(Q.a)(h,2),f=m[0],j=m[1];return Object(w.useEffect)((function(){a(Object(b.a)(Object(b.a)({},d),{},{"refreshKey.isCron":f})),f||Object(xc.isValidCron)(d["refreshKey.cron"])||o.setFields([{name:"refreshKey.cron",value:"",errors:[]}])}),[f]),Object(_.jsx)(te.a,{form:o,validateTrigger:"onBlur",initialValues:Pc(c),onValuesChange:function(e){p((function(t){return a(Object(b.a)(Object(b.a)(Object(b.a)({},t),e),{},{"refreshKey.isCron":f})),Object.keys(e).forEach((function(e){o.getFieldError(e).length&&o.setFields([{name:e,errors:[]}])})),Object(b.a)(Object(b.a)({},t),e)}))},children:Object(_.jsxs)(Mc,{children:[Object(_.jsxs)(K.a,{children:[Object(_.jsx)(Bc,{title:"Refresh Key",children:"Specify how often to refresh your pre-aggregated data"}),Object(_.jsx)(V.a.Paragraph,{children:"If you do not specify any Refresh Key, refreshes will still default to every 1 hour."}),Object(_.jsxs)(Ta.a,{gutter:8,wrap:!1,align:"top",children:[Object(_.jsx)(Ea.a,{flex:"85px",children:Object(_.jsx)(te.a.Item,{name:"refreshKey.checked.every",valuePropName:"checked",children:Object(_.jsx)(lo.a,{children:"Every"})})}),Object(_.jsx)(Ea.a,{flex:"auto",children:Object(_.jsxs)(J,{direction:"column",gap:2,children:[Object(_.jsxs)(re.b,{children:[Object(_.jsx)(po.a,{checked:!f,disabled:!d["refreshKey.checked.every"],onClick:function(){return j(!1)}}),Object(_.jsx)(te.a.Item,{name:"refreshKey.value",noStyle:!0,children:Object(_.jsx)(ee.a,{"data-testid":"rd-input-every",disabled:!d["refreshKey.checked.every"]||f,type:"number",min:0,style:{maxWidth:80}})}),Object(_.jsx)(te.a.Item,{name:"refreshKey.granularity",noStyle:!0,children:Object(_.jsx)(_c,{"data-testid":"rd-select-every-granularity",disabled:!d["refreshKey.checked.every"]||f})})]}),Object(_.jsxs)(re.b,{align:"start",style:{marginBottom:32},children:[Object(_.jsx)(po.a,{disabled:!d["refreshKey.checked.every"],checked:f,style:{paddingTop:5},onClick:function(){return j(!0)}}),Object(_.jsxs)(J,{direction:"column",gap:1,children:[Object(_.jsx)(te.a.Item,{name:"refreshKey.cron",rules:[{validator:function(e,t,n){t&&!Object(xc.isValidCron)(t,{seconds:!0})?(r(!1),n("Cron expression is invalid")):r(!0)}}],children:Object(_.jsx)(ee.a,{allowClear:!0,placeholder:"Cron expression e.g. 30 5 * * 5",disabled:!d["refreshKey.checked.every"]||!f})}),f&&d["refreshKey.checked.every"]?Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(V.a.Paragraph,{children:Object(_.jsx)(V.a.Link,{target:"_blank",href:"https://cube.dev/docs/schema/reference/cube#supported-cron-formats",children:"See how to format your cron expression"})}),Object(_.jsx)(V.a.Paragraph,{strong:!0,children:"Time Zone"}),Object(_.jsx)(te.a.Item,{name:"refreshKey.timeZone",noStyle:!0,children:Object(_.jsx)(ba.a,{showSearch:!0,style:{maxWidth:200},placeholder:"Select Time Zone",children:kc.map((function(e){return Object(_.jsx)(ba.a.Option,{value:e||"",children:e},e)}))})})]}):null]})]})]})})]}),Object(_.jsxs)(Ta.a,{gutter:8,children:[Object(_.jsx)(Ea.a,{flex:"85px",children:Object(_.jsx)(te.a.Item,{name:"refreshKey.checked.sql",valuePropName:"checked",noStyle:!0,children:Object(_.jsx)(lo.a,{children:"SQL"})})}),Object(_.jsx)(Ea.a,{flex:"auto",children:Object(_.jsx)(te.a.Item,{name:"refreshKey.sql",noStyle:!0,children:Object(_.jsx)(ee.a.TextArea,{disabled:!d["refreshKey.checked.sql"],placeholder:"SELECT MAX(createdAt) FROM orders"})})})]})]}),Object(_.jsxs)(K.a,{children:[n?Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(Bc,{title:"Partition Granularity",children:"Partitions are shards of the pre-aggregation dataset. To enable partitions, you must specify here the desired granularity."}),Object(_.jsx)(te.a.Item,{name:"partitionGranularity",children:Object(_.jsx)(ba.a,{showSearch:!0,style:{maxWidth:150},children:Ic.map((function(e){var t=e.name,n=e.title;return Object(_.jsx)(ba.a.Option,{value:t||"",children:n},t)}))})}),d.partitionGranularity?Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(te.a.Item,{name:"incrementalRefresh",valuePropName:"checked",children:Object(_.jsx)(lo.a,{children:"Incremental Refresh"})}),d.incrementalRefresh&&Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(Bc,{title:"Update Window",children:"Any partition which includes this span of time into the past from now will be refreshed according to the Refresh Key set above. Otherwise, if left unset, only the most recent partition will be refreshed regularly."}),Object(_.jsxs)(re.b,{align:"start",children:[Object(_.jsx)(te.a.Item,{name:"updateWindow.value",children:Object(_.jsx)(ee.a,{type:"number",min:0,style:{maxWidth:80}})}),Object(_.jsx)(te.a.Item,{name:"updateWindow.granularity",children:Object(_.jsx)(_c,{excludedGranularities:["second"]})})]})]})]}):null]}):null,Object(_.jsx)(V.a.Paragraph,{strong:!0,children:"Indexes"}),Object(_.jsx)(te.a.Item,{name:"indexes",noStyle:!0,children:Object(_.jsx)(ba.a,{mode:"tags",style:{width:"100%"},placeholder:"(list column names)",children:t.map((function(e){return Object(_.jsx)(ba.a.Option,{value:e,children:e},e)}))})})]})]})})}function _c(e){var t=e.excludedGranularities,n=void 0===t?[]:t,r=Object(h.a)(e,Rc);return Object(_.jsx)(ba.a,Object(b.a)(Object(b.a)({style:{minWidth:100},showSearch:!0},r),{},{children:Tt.filter((function(e){var t=e.name;return null!=t&&!n.includes(t)})).map((function(e){var t=e.name,n=e.title;return Object(_.jsx)(ba.a.Option,{value:t,children:n},t)}))}))}function Bc(e){var t=e.title,n=e.children;return Object(_.jsxs)(re.b,{align:"baseline",style:{display:"flex"},children:[Object(_.jsx)(V.a.Paragraph,{strong:!0,children:t}),Object(_.jsx)(Io.a,{title:n,children:Object(_.jsx)(Oc.a,{style:{color:"#1414464D"}})})]})}function zc(e){var t=e.member,n=e.granularity,r=void 0===n?"day":n,a=e.onGranularityChange,i=e.onRemove;return t?Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(yc,{children:"Time dimension"}),Object(_.jsxs)(re.b,{children:[Object(_.jsx)(vc,{name:t.shortTitle,cubeName:t.title.replace(t.shortTitle,""),onClose:function(){return i(t.name)}}),Object(_.jsx)(_c,{value:r,onChange:a})]})]}):(console.warn("Rollup Designer received `undefined` member as TimeDimension"),null)}var Fc=n(854),Nc=["onAfterClose"],Qc=V.a.Link;function Uc(e){var t=e.onAfterClose,n=Object(h.a)(e,Nc),r=Jc(),a=r.isModalOpen,i=r.toggleModal,o=r.memberTypeCubeMap;return Object(_.jsx)(ne.a,{title:"Rollup Designer",visible:a,bodyStyle:{padding:0},destroyOnClose:!0,wrapClassName:"rollup-designer",footer:Object(_.jsx)(Qc,{href:"https://cube.dev/docs/caching/pre-aggregations/getting-started",target:"_blank",children:Object(_.jsxs)(J,{justifyContent:"center",gap:1,children:[Object(_.jsx)(G,{children:Object(_.jsx)(Vo.a,{})}),Object(_.jsx)(G,{children:"Further reading about pre-aggregations for reference."}),Object(_.jsx)(G,{children:Object(_.jsx)(Fc.a,{})})]})}),width:1190,afterClose:t,onCancel:function(){return i()},children:Object(_.jsx)("div",{"data-testid":"rd-modal",children:Object(_.jsx)(is,{apiUrl:n.apiUrl,memberTypeCubeMap:o})})})}var Kc=["cubejsApi","children"],Vc=Object(w.createContext)({});function Yc(e){var t=e.cubejsApi,n=e.children,r=Object(h.a)(e,Kc),a=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Object(w.useState)(e),n=Object(Q.a)(t,2),r=n[0],a=n[1];return[r,function(){return a((function(e){return!e}))}]}(),i=Object(Q.a)(a,2),o=i[0],c=i[1],s=Object(w.useState)(null),u=Object(Q.a)(s,2),l=u[0],d=u[1],b=Object(w.useState)(null),p=Object(Q.a)(b,2),m=p[0],f=p[1],j=Object(w.useState)(null),v=Object(Q.a)(j,2),y=v[0],g=v[1],O=Object(w.useState)({measures:[],dimensions:[],segments:[],timeDimensions:[]}),x=Object(Q.a)(O,2),k=x[0],C=x[1],S=function(){return di("meta",arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}({skip:!o,cubejsApi:t}),A=function(e){return di("dryRun",pi(pi({},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),{},{query:e}))}(m,{skip:!o||!m,cubejsApi:t});return Object(w.useEffect)((function(){var e=S.isLoading,t=S.error,n=S.response;e||(n?C(n.membersGroupedByCube()):t&&d(t))}),[S.isLoading]),Object(w.useEffect)((function(){var e=A.isLoading,t=A.error,n=A.response;e||(n?g(n.transformedQueries[0]):t&&d(t))}),[A.isLoading]),Object(_.jsxs)(Vc.Provider,{value:{isLoading:S.isLoading||A.isLoading,isModalOpen:o,toggleModal:c,query:m,setQuery:f,transformedQuery:y,setTransformedQuery:g,memberTypeCubeMap:k,error:l},children:[n,Object(_.jsx)(Uc,{apiUrl:r.apiUrl,onAfterClose:function(){g(null),d(null)}})]})}function Jc(){return Object(w.useContext)(Vc)}var Gc,Wc,Hc,Zc=["isCloud"],$c=["order","limit","filters"],Xc=V.a.Paragraph,es=(V.a.Link,V.a.Text),ts=X.a.TabPane,ns=Object(D.d)(G)(Gc||(Gc=Object(k.a)(["\n  & .ant-tabs-nav {\n    padding-left: 24px;\n    margin: 0;\n  }\n"]))),rs=D.d.div(Wc||(Wc=Object(k.a)(["\n  padding: 0 24px 32px;\n  background: #f6f6f8;\n  width: 420px;\n  min-width: 420px;\n\n  & .ant-tabs-nav {\n    margin-bottom: 24px;\n  }\n\n  & .ant-tabs-tab {\n    div,\n    .ant-typography {\n      font-weight: 500;\n    }\n  }\n\n  & .ant-typography > .anticon {\n    padding-left: 12px;\n  }\n"])));function as(e){var t=new Set;return["measures","dimensions","timeDimensions","segments"].map((function(n){if("timeDimensions"===n){var r,a=((null===(r=e[n])||void 0===r?void 0:r[0])||{}).dimension;a&&t.add("td:".concat(a))}else{var i;null===(i=e[n])||void 0===i||i.map((function(e){return t.add(e)}))}})),Array.from(t.values())}function is(e){var t,n,r=e.apiUrl,a=e.memberTypeCubeMap,i=Mn(),o=Tn().token,c=Object(w.useContext)(ac),s=c.isCloud,u=Object(h.a)(c,Zc),l=Jc(),m=l.query,f=l.transformedQuery,j=l.isLoading,v=l.error,y=Object(w.useState)(!0),g=Object(Q.a)(y,2),O=g[0],x=g[1],k=Object(w.useState)({}),C=Object(Q.a)(k,2),S=C[0],D=C[1],E=Object(w.useState)([]),T=Object(Q.a)(E,2),P=T[0],q=T[1],R=Object(w.useState)(null),M=Object(Q.a)(R,2),I=M[0],L=M[1],B=(Boolean(null===f||void 0===f?void 0:f.leafMeasureAdditive),Object(w.useState)(!0)),z=Object(Q.a)(B,2),F=z[0],N=z[1],U=Object(w.useState)(!1),K=Object(Q.a)(U,2),W=K[0],H=K[1],Z=Object(w.useState)("main"),$=Object(Q.a)(Z,2),te=$[0],ne=$[1],ie=m||{},oe=(ie.order,ie.limit,ie.filters,Object(h.a)(ie,$c)),ce=oe.timeDimensions||[],le=Object(Q.a)(ce,1)[0],de=(null===le||void 0===le?void 0:le.dimension)&&!(null===le||void 0===le?void 0:le.dateRange)&&!(null===le||void 0===le?void 0:le.granularity),be=new Set;a.segments.forEach((function(e){e.members.forEach((function(e){var t=e.name;return be.add(t)}))}));var pe=Object(w.useState)(Sc(f,be)),he=Object(Q.a)(pe,2),me=he[0],fe=he[1];Ln((function(){var e=Sc(f,be);fe(e);var t=as(e).map((function(e){return e.split(".")[0]}));q(t),L(t[0]||null)}),[f,be]);var je=_n((function(){return as(me)}),[me]);Ln((function(){var e=!0,t=me.measures,n=me.segments,a=me.dimensions,c=me.timeDimensions;function s(){return(s=Object(p.a)(d.a.mark((function s(){var u,l;return d.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,yn("".concat(r,"/pre-aggregations/can-use"),"POST",{token:o,body:{transformedQuery:f,references:{measures:t,dimensions:a.concat(n),timeDimensions:c}}});case 2:u=s.sent,l=u.json,i()&&e&&N(l.canUsePreAggregationForTransformedQuery);case 5:case"end":return s.stop()}}),s)})))).apply(this,arguments)}return null!=o&&f&&function(){s.apply(this,arguments)}(),function(){return e=!1}}),[i,me,o,f]);var ve,ye=Object(w.useMemo)((function(){var e=null;if(f)e=((null===f||void 0===f?void 0:f.leafMeasures[0])||(null===f||void 0===f?void 0:f.sortedDimensions[0])||"CubeName").split(".")[0];else if(!Ac(me)){var t=as(me);e=Object(Q.a)(t,1)[0].split(".")[0]||null}return e}),[f,me]),ge=Object.fromEntries(fn([].concat(Object(hn.a)(a.measures),Object(hn.a)(a.dimensions),Object(hn.a)(a.timeDimensions),Object(hn.a)(a.segments))));function Oe(){return xe.apply(this,arguments)}function xe(){return(xe=Object(p.a)(d.a.mark((function e(){var t,n,r,a,i,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=function(){se.a.success({message:"Rollup has been added to the ".concat(ye," cube")})},ye){e.next=3;break}return e.abrupt("return");case 3:if(t={preAggregationName:te,cubeName:ye,code:Dc(me,te,S).value},H(!0),s){e.next=12;break}return e.next=8,yn("/playground/schema/pre-aggregation","POST",{body:t});case 8:(r=e.sent).ok?n():(a=r.json.error,se.a.error({message:a})),e.next=19;break;case 12:if(null!=u.addPreAggregationToSchema){e.next=14;break}throw new Error("cloud.addPreAggregationToSchema is not defined");case 14:return e.next=16,u.addPreAggregationToSchema(t);case 16:i=e.sent,(o=i.error)?se.a.error({message:o}):n();case 19:H(!1);case 20:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ke(e){return function(t){fe(function(e,t,n){var r,a,i,o,c=JSON.parse(JSON.stringify(e));return"timeDimensions"===t?(null===(r=c.timeDimensions)||void 0===r||null===(a=r[0])||void 0===a?void 0:a.dimension)===n?c.timeDimensions=[]:c.timeDimensions=[Object(b.a)(Object(b.a)({granularity:"day"},null===(i=c.timeDimensions)||void 0===i?void 0:i[0]),{},{dimension:n})]:(null===(o=c[t])||void 0===o?void 0:o.includes(n))?c[t]=c[t].filter((function(e){return n!==e})):c[t]=[].concat(Object(hn.a)(c[t]||[]),[n]),c}(me,e,t))}}return j?Object(_.jsxs)(J,{gap:4,style:{margin:24},children:[Object(_.jsx)(G,{style:{minWidth:256},children:Object(_.jsx)(rc.a,{})}),Object(_.jsxs)(G,{grow:1,children:[Object(_.jsx)(rc.a,{}),Object(_.jsx)(rc.a,{})]}),Object(_.jsx)(G,{style:{width:420,minWidth:420},children:Object(_.jsx)(rc.a,{})})]}):v?Object(_.jsx)("div",{style:{margin:"32px 24px"},children:Object(_.jsx)(yr,{error:v})}):Object(_.jsxs)(J,{justifyContent:"space-between",margin:[0,0,2,0],children:[Object(_.jsx)(ns,{grow:1,children:Object(_.jsxs)(X.a,{style:{minHeight:"100%"},children:[Object(_.jsx)(ts,{tab:Object(_.jsx)("span",{"data-testid":"rd-members-tab",children:"Members"}),children:Object(_.jsxs)(J,{gap:2,children:[Object(_.jsx)(G,{style:{minWidth:256},children:Object(_.jsx)(bc,{openKeys:P,selectedKeys:je,memberTypeCubeMap:a,firstOpenCubeName:I,onSelect:function(e,t){ke(e)(t)},onOpenKeysChange:q})}),Object(_.jsxs)(G,{grow:1,style:{marginTop:24},children:[(null===(t=me.measures)||void 0===t?void 0:t.length)?Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(gc,{title:"Measures",members:me.measures.map((function(e){return ge[e]})),onRemove:ke("measures")}),Object(_.jsx)(eo.a,{})]}):null,(null===(n=me.dimensions)||void 0===n?void 0:n.length)?Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(gc,{title:"Dimensions",members:me.dimensions.map((function(e){return ge[e]})),onRemove:ke("dimensions")}),Object(_.jsx)(eo.a,{})]}):null,me.segments.length?Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(gc,{title:"Segments",members:me.segments.map((function(e){return ge[e]})),onRemove:ke("segments")}),Object(_.jsx)(eo.a,{})]}):null,me.timeDimensions.length?Object(_.jsx)(zc,{member:ge[me.timeDimensions[0].dimension],granularity:me.timeDimensions[0].granularity,onGranularityChange:function(e){fe(Object(b.a)(Object(b.a)({},me),{},{timeDimensions:[Object(b.a)(Object(b.a)({},me.timeDimensions[0]||{}),e?{granularity:e}:null)]}))},onRemove:ke("timeDimensions")}):null]})]})},"members"),Object(_.jsx)(ts,{tab:Object(_.jsx)("span",{"data-testid":"rd-settings-tab",children:"Settings"}),children:Object(_.jsx)(Lc,{hasTimeDimension:me.timeDimensions.length>0,members:me.measures.concat(me.dimensions).concat(me.timeDimensions.map((function(e){return e.dimension}))),onCronExpressionValidityChange:x,onChange:function(e){return D(function(e){var t={};if(e["refreshKey.checked.every"]&&(e["refreshKey.isCron"]&&(e["refreshKey.cron"]||e["refreshKey.timeZone"])?(t.refreshKey={},e["refreshKey.cron"]&&(t.refreshKey.every="`".concat(e["refreshKey.cron"],"`")),e["refreshKey.timeZone"]&&(t.refreshKey.timezone="`".concat(e["refreshKey.timeZone"],"`"))):t.refreshKey={every:"`".concat(e["refreshKey.value"]," ").concat(e["refreshKey.granularity"],"`")}),e["refreshKey.checked.sql"]&&e["refreshKey.sql"]&&(t.refreshKey=Object(b.a)(Object(b.a)({},t.refreshKey),{},{sql:"`".concat(e["refreshKey.sql"],"`")})),e.partitionGranularity){if(t.partitionGranularity="`".concat(e.partitionGranularity,"`"),e["updateWindow.value"]){var n=[e["updateWindow.value"],e["updateWindow.granularity"]].join(" ");t.refreshKey=Object(b.a)(Object(b.a)({},t.refreshKey),{},{updateWindow:"`".concat(n,"`")})}t.refreshKey=Object(b.a)(Object(b.a)({},t.refreshKey),{},{incremental:Boolean(e.incrementalRefresh)})}return Array.isArray(e.indexes)&&e.indexes.length>0&&(t.indexes={indexName:{columns:e.indexes}}),t}(e))}})},"settings")]})}),Object(_.jsx)(rs,{children:Object(_.jsxs)(X.a,{children:[Object(_.jsx)(ts,{tab:Object(_.jsx)("span",{"data-testid":"rd-definition-tab",children:"Rollup Definition"}),children:Object(_.jsxs)(J,{direction:"column",justifyContent:"flex-start",children:[!Ac(me)&&!me.timeDimensions.length&&Object(_.jsx)(G,{style:{marginBottom:24},children:Object(_.jsx)(A.a,{type:"warning",message:"This rollup has no time dimension so it cannot be partitioned"})}),Object(_.jsxs)(G,{style:{marginBottom:16},children:[Ac(me)?Object(_.jsx)(A.a,{type:"warning",message:"Add some references"}):Object(_.jsxs)(Xc,{children:["Add the following rollup pre-aggregation",Object(_.jsx)("br",{})," to the ",Object(_.jsx)("b",{children:ye})," cube:"]}),Object(_.jsx)(Xc,{style:{margin:"24px 0 4px"},children:"Rollup Name"}),Object(_.jsx)(ee.a,{value:te,suffix:Object(_.jsx)(ae.a,{}),onChange:function(e){return ne(e.target.value)}})]}),Object(_.jsx)(G,{children:Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(Rr,{style:{marginBottom:16},code:Dc(me,te,S).code,copyMessage:"Rollup definition is copied",theme:"light"}),ye?Object(_.jsx)(Y.a,{"data-testid":"rd-add-btn",type:"primary",loading:W,disabled:!O,style:{width:"100%"},onClick:Oe,children:"Add to the Data Schema"}):null]})})]})},"rollup"),Rt(m)?Object(_.jsx)(ts,{tab:F?Object(_.jsx)("span",{"data-testid":"rd-query-tab",children:"Query Compatibility"}):Object(_.jsxs)(V.a.Text,{"data-testid":"rd-query-tab",children:["Query Compatibility",Object(_.jsx)(nc.a,{style:{color:"#FBBC05"}})]}),children:Object(_.jsxs)(J,{direction:"column",justifyContent:"flex-start",children:[Object(_.jsx)(G,{style:{marginBottom:32},children:F?Object(_.jsx)(es,{children:"This rollup will match the following query:"}):Object(_.jsxs)(re.b,{direction:"vertical",children:[Object(_.jsx)(A.a,{"data-testid":"rd-incompatible-query",type:"warning",message:Object(_.jsxs)(es,{children:["This rollup does ",Object(_.jsx)("b",{children:"NOT"})," match the following query:"]})}),!de&&Object(_.jsx)(Y.a,{"data-testid":"rd-match-rollup-btn",type:"primary",ghost:!0,onClick:function(){fe(Sc(f,be)),N(!0)},children:"Match Rollup"})]})}),Object(_.jsx)(Rr,{style:{minWidth:200},code:(ve=oe,Object(ue.pretty)(ve,2).replaceAll(/([^\\]|)'/g,"\\'").replaceAll(/"/g,"'").replaceAll(/\[[\s]+\]/g,"[]")),copyMessage:"Query is copied",theme:"light"})]})},"query"):null]})})]})}var os,cs,ss=D.d.div(Hc||(Hc=Object(k.a)(["\n  display: flex;\n  align-items: center;\n  padding: 2px 4px;\n  border-radius: 4px;\n  background: var(--warning-bg-color);\n"])));function us(e){var t=e.isAggregated,n=e.external,r=e.extDbType,a=e.preAggregationType,i=function(e){var t=Pn(),n=t.serverCoreVersion,r=void 0===n?"":n,a=t.coreServerVersion,i=void 0===a?"":a,o=!1;try{var c=(r||i).split(".").map(Number),s=Object(Q.a)(c,3),u=s[1],l=s[2],d=e.split(".").map(Number),b=Object(Q.a)(d,3),p=b[1],h=b[2];o=u>p||u===p&&l>=h}catch(m){}return o}("0.28.4"),o=Jc().toggleModal;return Object(_.jsx)(_.Fragment,{children:Object(_.jsxs)(re.b,{style:{marginLeft:"auto"},children:[t&&Object(_.jsx)(ss,{children:Object(_.jsx)(re.b,{size:4,children:Object(_.jsx)(T.a,{style:{color:"var(--warning-color)"},component:function(){return Object(_.jsx)(tc.a,{})}})})}),t?Object(_.jsx)(V.a.Text,{children:"Query was accelerated with pre-aggregation"}):i?Object(_.jsxs)(Y.a,{"data-testid":"not-pre-agg-query-btn",type:"link",onClick:function(){return o()},children:["Query was not accelerated with pre-aggregation ","->"]}):null,t&&n&&"cubestore"!==r?Object(_.jsx)(A.a,{message:"Consider migrating your pre-aggregations to Cube Store for better performance with larger datasets",type:"warning"}):null,t&&!n&&"originalSql"!==a?Object(_.jsx)(A.a,{message:Object(_.jsxs)(_.Fragment,{children:["For optimized performance, consider using ",Object(_.jsx)("b",{children:"external"})," ",a," pre-aggregation, rather than the source database (internal)"]}),type:"warning"}):null]})})}var ls,ds,bs,ps=D.d.div(os||(os=Object(k.a)(["\n  display: flex;\n  flex-flow: column;\n  margin-right: 24px;\n  margin-bottom: 16px;\n\n  > *:first-child {\n    margin-bottom: 8px;\n  }\n"]))),hs=D.d.div(cs||(cs=Object(k.a)(["\n  background-color: var(--layout-body-background);\n  padding-bottom: 16px;\n"]))),ms={react:[{value:"chartjs",title:"Chart.js"},{value:"bizcharts",title:"Bizcharts"},{value:"recharts",title:"Recharts"},{value:"d3",title:"D3"}],angular:[{value:"angular-ng2-charts",title:"ng2"}],vue:[{value:"chartkick",title:"Chartkick"}]},fs=function(e,t){return Object.keys(e).map((function(n){return Object(ce.a)({},n,(function(r,a){var i="".concat(n.split("").map((function(e,t){return 0===t?e.toUpperCase():e})).join("")," Member");(null===a||void 0===a?void 0:a.values)&&(i="Update Filter Values"),(null===a||void 0===a?void 0:a.dateRange)&&(i="Update Date Range"),(null===a||void 0===a?void 0:a.granularity)&&(i="Update Granularity"),Vr(i,{memberName:t});for(var o=arguments.length,c=new Array(o>2?o-2:0),s=2;s<o;s++)c[s-2]=arguments[s];return e[n].apply(null,[r,a].concat(c))}))})).reduce((function(e,t){return Object(b.a)(Object(b.a)({},e),t)}),{})};function js(e){var t=e.iframeRef,n=e.pivotConfig,r=e.chartType;return Ln((function(){(null===t||void 0===t?void 0:t.current)&&["table","bar"].includes(r)&&be(t.current.contentDocument,"chart",{pivotConfig:n})}),[t,n]),null}function vs(e){var t=e.query1,n=e.query2,r=e.onChange;return Ln((function(){Pt(t,n)||r()}),[t,n]),null}function ys(e){var t=e.apiUrl,n=e.cubejsToken,r=e.defaultQuery,a=e.queryId,i=e.dashboardSource,o=e.schemaVersion,c=void 0===o?0:o,s=e.initialVizState,u=e.extra,l=e.onSchemaChange,h=e.onVizStateChanged,m=Mn(),f=Vi(a),j=f.isChartRendererReady,v=f.queryStatus,y=f.queryError,g=f.queryRequestId,O=Yi(),x=O.setQueryStatus,k=O.setQueryLoading,C=O.setChartRendererReady,S=O.setQueryError,A=Se().refreshToken,D=Object(w.useRef)(null),E=Object(w.useRef)(null),T=Object(w.useState)(!1),P=Object(Q.a)(T,2),q=P[0],R=P[1],M=Object(w.useState)("react"),I=Object(Q.a)(M,2),L=I[0],B=I[1],z=Object(w.useState)("chartjs"),F=Object(Q.a)(z,2),N=F[0],U=F[1];function K(e){var t=e.query,n=e.pivotConfig,r=e.chartType;D.current&&(Pt(t,E.current)?(be(D.current.contentDocument,"chart",{pivotConfig:n,query:t,chartType:r,chartingLibrary:N}),be(D.current.contentDocument,"refetch")):be(D.current.contentDocument,"chart",{pivotConfig:n,query:t,chartType:r,chartingLibrary:N})),S(a,null),E.current=t}return Object(w.useEffect)((function(){Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A();case 2:m()&&R(!0);case 3:case"end":return e.stop()}}),e)})))()}),[m]),Object(w.useEffect)((function(){j&&D.current&&be(D.current.contentDocument,"credentials",{token:n,apiUrl:t})}),[D,n,t,j]),q?Object(_.jsx)(ii,{defaultQuery:r,initialVizState:s,wrapWithQueryRenderer:!1,schemaVersion:c,onSchemaChange:l,onVizStateChanged:h,render:function(e){var r,o,c,s=e.query,l=e.error,h=e.metaError,m=e.isQueryPresent,f=e.chartType,O=e.updateChartType,w=e.measures,S=e.updateMeasures,T=e.dimensions,P=e.updateDimensions,q=e.segments,R=e.updateSegments,M=e.filters,I=e.updateFilters,z=e.timeDimensions,F=e.updateTimeDimensions,Q=e.orderMembers,V=e.updateOrder,Y=e.pivotConfig,J=e.updatePivotConfig,G=e.missingMembers,W=e.isFetchingMeta,H=e.dryRunResponse,Z=e.availableMembers,$=e.availableFilterMembers;if(H){var X,ee=(H.pivotQuery||{}).timeDimensions;c=null===(X=(void 0===ee?[]:ee)[0])||void 0===X?void 0:X.dateRange}else Array.isArray(null===(r=s.timeDimensions)||void 0===r||null===(o=r[0])||void 0===o?void 0:o.dateRange)&&(c=s.timeDimensions[0].dateRange);return Object(_.jsxs)(hs,{"data-testid":"query-builder-".concat(a),children:[Object(_.jsx)(Ta.a,{justify:"space-around",align:"top",gutter:24,style:{marginBottom:12},children:Object(_.jsxs)(Ea.a,{span:24,children:[Object(_.jsx)(Cr,{bordered:!1,style:{borderRadius:0},children:Object(_.jsxs)(Ta.a,{align:"top",gutter:0,style:{marginBottom:-12},children:[Object(_.jsxs)(ps,{children:[Object(_.jsx)(la,{children:"Measures"}),Object(_.jsx)(Bo,{disabled:W,members:w,availableMembers:(null===Z||void 0===Z?void 0:Z.measures)||[],missingMembers:G,addMemberName:"Measure",updateMethods:fs(S,"Measure")})]}),Object(_.jsxs)(ps,{children:[Object(_.jsx)(la,{children:"Dimensions"}),Object(_.jsx)(Bo,{disabled:W,members:T,availableMembers:(null===Z||void 0===Z?void 0:Z.dimensions)||[],missingMembers:G,addMemberName:"Dimension",updateMethods:fs(P,"Dimension")})]}),Object(_.jsxs)(ps,{children:[Object(_.jsx)(la,{children:"Segment"}),Object(_.jsx)(Bo,{disabled:W,members:q,availableMembers:(null===Z||void 0===Z?void 0:Z.segments)||[],missingMembers:G,addMemberName:"Segment",updateMethods:fs(R,"Segment")})]}),Object(_.jsxs)(ps,{children:[Object(_.jsx)(la,{children:"Time"}),Object(_.jsx)(ec,{disabled:W,members:z,availableMembers:(null===Z||void 0===Z?void 0:Z.timeDimensions)||[],missingMembers:G,addMemberName:"Time",updateMethods:fs(F,"Time"),parsedDateRange:c})]}),Object(_.jsxs)(ps,{children:[Object(_.jsx)(la,{children:"Filters"}),Object(_.jsx)(_o,{disabled:W,members:M,availableMembers:$,missingMembers:G,addMemberName:"Filter",updateMethods:fs(I,"Filter")})]})]})}),Object(_.jsxs)(da,{style:{margin:16,marginBottom:0},children:[Object(_.jsx)(Jo,{chartType:f||"line",updateChartType:function(e){Vr("Change Chart Type"),O(e),D.current&&be(D.current.contentDocument,"chart",{chartType:e,chartingLibrary:N})}}),Object(_.jsx)(fo,{isQueryPresent:m,limit:s.limit||5e3,pivotConfig:Y,disabled:W,orderMembers:Q,onReorder:V.reorder,onOrderChange:V.set,onMove:J.moveItem,onUpdate:J.update}),Object(_.jsxs)(re.b,{style:{marginLeft:"auto"},children:[u?Object(_.jsx)(u,{queryRequestId:g,queryStatus:v}):null,v?Object(_.jsx)(us,Object(b.a)({apiUrl:t,availableMembers:Z,query:s},v)):null]})]})]})}),Object(_.jsx)(Ta.a,{justify:"space-around",align:"top",gutter:32,style:{margin:0},children:Object(_.jsxs)(Ea.a,{span:24,children:[!m&&h?Object(_.jsx)(Cr,{children:Object(_.jsx)(yr,{error:h})}):null,!m&&!h&&Object(_.jsx)("h2",{style:{textAlign:"center"},children:"Choose a measure or dimension to get started"}),m&&Object(_.jsx)(qi,{apiUrl:t,cubejsToken:n,iframeRef:D,isChartRendererReady:j,query:s,error:l,chartType:f||"line",pivotConfig:Y,framework:L,chartingLibrary:N,dashboardSource:i,setFramework:function(e){e!==L&&(k(a,!1),B(e))},setChartLibrary:function(e){D.current&&be(D.current.contentDocument,"chart",{chartingLibrary:e}),U(e)},chartLibraries:ms,isFetchingMeta:W,render:function(e){var t=e.framework;return h?Object(_.jsx)(yr,{error:h}):Object(_.jsx)(Xi,{queryId:a,areQueriesEqual:Pt(s,E.current),isFetchingMeta:W,queryError:y,framework:t,chartType:f||"line",query:s,pivotConfig:Y,iframeRef:D,queryHasMissingMembers:G.length>0,onRunButtonClick:Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!j||!D.current||0!==G.length){e.next=4;break}return e.next=3,A();case 3:K({query:s,pivotConfig:Y,chartType:f||"line"});case 4:case"end":return e.stop()}}),e)})))})},onChartRendererReadyChange:function(e){return C(a,e)}})]})}),Object(_.jsx)(js,{iframeRef:D,chartType:f||"line",pivotConfig:Y}),Object(_.jsx)(vs,{query1:s,query2:E.current,onChange:function(){k(a,!1),x(a,null)}})]})}}):null}var gs=function(e){var t=e.children;return Object(_.jsx)("div",{style:{margin:25},children:t})},Os=D.d.div(ls||(ls=Object(k.a)(["\n  position: relative;\n  width: 100%;\n  height: 100%;\n  margin: auto;\n  max-width: 1024px;\n  background-size: cover;\n  background-repeat: no-repeat;\n  background-position: center;\n  background-image: ",";\n"])),(function(e){return'url("'.concat(e.src,'")')})),xs=Object(D.d)(Cr)(ds||(ds=Object(k.a)(["\n  && {\n    border: none;\n    border-radius: 8px;\n    margin-bottom: 24px;\n    padding: 16px;\n    ","\n\n    &:hover {\n      padding: 16px;\n      ","\n    }\n\n    button {\n      display: none;\n      position: absolute;\n      margin-left: -64px;\n      top: 80px;\n      left: 50%;\n    }\n\n    svg path {\n      transition: stroke 0.25s ease;\n    }\n\n    && .ant-card-cover {\n      height: 168px;\n      border-radius: 8px 8px 0 0;\n      background: ",";\n      display: flex;\n      align-items: center;\n      position: relative;\n      margin: -16px -16px 0 -16px;\n      padding: 24px 24px 0 24px;\n\n      &::after {\n        content: '';\n        position: absolute;\n        width: 100%;\n        height: 100%;\n        top: 0;\n        left: 0;\n        background: rgba(81, 87, 125, 0.3);\n        opacity: 0;\n        transition: all 0.25s;\n        border-radius: 8px 8px 0 0;\n      }\n\n      div {\n        //box-shadow: 0 -1px 6px rgba(20, 20, 70, .06);\n        background-position: top;\n        border-radius: 4px 4px 0 0;\n      }\n    }\n\n    &&.ant-card-hoverable:hover {\n      box-shadow: 0 15px 20px rgba(67, 67, 107, 0.1);\n      button {\n        display: block;\n      }\n      &:hover .ant-card-cover:after {\n        opacity: ",";\n      }\n    }\n\n    svg path {\n      stroke: var(--primary-color);\n    }\n\n    && .ant-card-body {\n      min-height: 175px;\n      display: flex;\n      place-items: stretch;\n      place-content: start stretch;\n      text-align: left;\n      z-index: 1;\n      padding: 24px 0 16px;\n    }\n\n    && .ant-card-meta {\n      text-align: left;\n    }\n\n    && .ant-card-meta-title {\n      white-space: unset;\n      color: ",";\n      text-align: ",";\n      margin-bottom: 16px;\n    }\n\n    && .ant-card-meta-description {\n      color: ",";\n      opacity: ",";\n      font-size: 13px;\n      text-align: ",";\n      ","\n    }\n  }\n"])),(function(e){return e.createYourOwn?"\n      background: transparent;\n      border: 1px solid var(--purple-03-color);\n    ":""}),(function(e){return e.createYourOwn?"\n        border: 1px solid var(--purple-03-color);\n      ":"border: none;"}),(function(e){return e.createYourOwn?"transparent":"#DEDEF1"}),(function(e){return e.createYourOwn?"0":"1"}),(function(e){return e.createYourOwn?"var(--primary-color)":"var(--text-color)"}),(function(e){return e.createYourOwn?"center":"left"}),(function(e){return e.createYourOwn?"var(--primary-color)":"var(--dark-04-color)"}),(function(e){return e.createYourOwn?"0.8":1}),(function(e){return e.createYourOwn?"center":"left"}),(function(e){return e.createYourOwn?"padding: 0 32px;":""})),ks=Object(D.d)(V.a.Text)(bs||(bs=Object(k.a)(["\n  display: block;\n  font-size: 16px;\n  margin-bottom: 24px;\n"]))),ws=function(e){Object(O.a)(n,e);var t=Object(x.a)(n);function n(e){var r;return Object(y.a)(this,n),(r=t.call(this,e)).dashboardSource=new aa,r.state={chartLibrary:ms.react[0].value,framework:"react",templatePackageName:"react-antd-dynamic",templates:null},r}return Object(g.a)(n,[{key:"componentDidMount",value:function(){var e=Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dashboardSource.load(!0);case 2:return e.t0=this,e.t1=this.dashboardSource.loadError,e.next=6,this.dashboardSource.templates();case 6:e.t2=e.sent,e.t3={loadError:e.t1,templates:e.t2},e.t0.setState.call(e.t0,e.t3);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t,n=this,r=this.state,a=r.loadError,i=r.templates;if(a&&-1===a.indexOf("Dashboard app not found"))return Object(_.jsx)(j.a,{to:"/dashboard"});if(null==i)return Object(_.jsx)(pr,{});var o=this.state,c=o.chartLibrary,s=o.framework,u=o.templatePackageName,l=o.createOwnModalVisible,b=o.enableWebSocketTransport,h=this.props.history,m=ms[s].find((function(e){return e.value===c})),f=Oi.find((function(e){return e.id===s})),v=null===(e=this.dashboardSource)||void 0===e?void 0:e.templatePackages(s).find((function(e){return e.name===u})),y=i.map((function(e){var t=e.name,r=e.description,a=e.coverUrl;return Object(_.jsx)(Ea.a,{xs:{span:24},md:{span:12},lg:{span:8},xl:{span:6},style:{display:"flex"},children:Object(_.jsxs)(xs,{hoverable:!0,bordered:!1,cover:Object(_.jsx)(Os,{src:a}),children:[Object(_.jsx)(Cr.Meta,{title:t,description:r}),Object(_.jsx)(Or,{type:"primary",onClick:Object(p.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.dashboardSource.applyTemplatePackages(t);case 2:h.push("/dashboard");case 3:case"end":return e.stop()}}),e)}))),children:"Create App"})]})},t)})).concat([Object(_.jsxs)(Ea.a,{xs:{span:24},md:{span:12},lg:{span:8},xl:{span:6},style:{display:"flex"},children:[Object(_.jsx)(xs,{onClick:function(){return n.setState({createOwnModalVisible:!0})},hoverable:!0,createYourOwn:!0,bordered:!1,cover:Object(_.jsx)(Pa.a,{style:{fontSize:60}}),children:Object(_.jsx)(Cr.Meta,{title:"Create your Own",description:"Mix different templates together to create your own dashboard application"})}),Object(_.jsx)(Fi,{visible:l,onOk:Object(p.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],n.setState({createOwnModalVisible:!1}),t="react"===s.toLowerCase()?["create-react-app",u,"".concat(c,"-charts"),"".concat(u.match(/^react-(\w+)/)[1],"-tables"),"react-credentials"].concat(b?["react-web-socket-transport"]:[]):"angular"===s.toLowerCase()?["create-ng-app",u,"ng2-charts","ng-credentials"]:["create-vue-app",u,"vue-chartkick-charts"],e.next=5,n.dashboardSource.applyTemplatePackages(t);case 5:h.push("/dashboard");case 6:case"end":return e.stop()}}),e)}))),onCancel:function(){return n.setState({createOwnModalVisible:!1})},onChange:function(e,t){if("framework"===e&&s!==t){var r,a,i,o=(null===(r=n.dashboardSource)||void 0===r?void 0:r.templatePackages(t))||[];n.setState({templatePackageName:null===(a=o[0])||void 0===a?void 0:a.name,chartLibrary:null===(i=ms[t.toLowerCase()])||void 0===i?void 0:i[0].value})}n.setState(Object(ce.a)({},e,t))},chartLibraries:ms[s],currentLibraryItem:m,frameworks:Oi.filter((function(e){return"vanilla"!==e.id})),framework:s,frameworkItem:f,templatePackages:(null===(t=this.dashboardSource)||void 0===t?void 0:t.templatePackages(s))||[],templatePackage:v,enableWebSocketTransport:b&&"angular"!==s.toLowerCase()})]},"own")]);return Object(_.jsxs)(gs,{children:[Object(_.jsxs)(ks,{children:["Build your app from one the popular templates below or"," ",Object(_.jsx)("a",{onClick:function(){return n.setState({createOwnModalVisible:!0})},children:"create your own"})]}),Object(_.jsx)(Ta.a,{gutter:24,children:y})]})}}]),n}(w.Component),Cs=Object(j.g)(ws),Ss=n.p+"static/media/postgres.e67db92e.svg",As=n.p+"static/media/mysql.376b985e.svg",Ds=n.p+"static/media/athena.3d08e54a.svg",Es=n.p+"static/media/clickhouse.15d7a0f1.svg",Ts=n.p+"static/media/hive.b33891fc.svg",Ps=n.p+"static/media/redshift.b80154fa.svg",qs=n.p+"static/media/presto.bf9e7a80.svg",Rs=n.p+"static/media/snowflake.7e110f33.svg",Ms=n.p+"static/media/oracle.e2b7363b.svg",Is=n.p+"static/media/mssql.7dc54d0e.svg",Ls=n.p+"static/media/bigquery.47cbd6db.svg",_s=n.p+"static/media/mongodb.23376a66.svg",Bs=n.p+"static/media/druid.7ac8cbb7.svg",zs=[{env:"CUBEJS_DB_HOST",title:"Hostname"},{env:"CUBEJS_DB_PORT",title:"Port"}],Fs=[{env:"CUBEJS_DB_USER",title:"Username"},{env:"CUBEJS_DB_PASS",title:"Password"}],Ns={env:"CUBEJS_DB_NAME",title:"Database"},Qs=[{databases:[{title:"PostgreSQL",driver:"postgres",logo:Ss},{title:"MySQL",driver:"mysql",logo:As},{title:"AWS Redshift",driver:"redshift",logo:Ps},{title:"ClickHouse",driver:"clickhouse",logo:Es},{title:"Hive/SparkSQL",driver:"hive",logo:Ts},{title:"Oracle",driver:"oracle",logo:Ms}],settings:[].concat(zs,[Ns],Fs)},{databases:[{title:"MS SQL",driver:"mssql",logo:Is}],settings:[].concat(zs,Fs,[Ns,{env:"CUBEJS_DB_DOMAIN",title:"Domain Name"}])},{databases:[{title:"AWS Athena",driver:"athena",logo:Ds,instructions:'\nSpecify the AWS access and secret keys with the <a href="https://docs.aws.amazon.com/athena/latest/ug/security-iam-athena.html" target="_blank">access necessary to run Athena queries</a>, \nand the target AWS region and <a href="https://docs.aws.amazon.com/athena/latest/ug/querying.html" target="_blank">S3 output location</a> where query results are stored.\n    '}],settings:[{env:"CUBEJS_AWS_KEY",title:"AWS Access Key ID"},{env:"CUBEJS_AWS_SECRET",title:"AWS Secret Access Key"},{env:"CUBEJS_AWS_REGION",title:"AWS Region"},{env:"CUBEJS_AWS_S3_OUTPUT_LOCATION",title:"S3 Output Location"}]},{databases:[{title:"Google Bigquery",driver:"bigquery",logo:Ls,instructions:"\nUpload a service account JSON keyfile to connect to BigQuery.<br/>Alternatively, you can encode the key file with base64 and specify it manually.\n    "}],settings:[{env:"CUBEJS_DB_BQ_KEY_FILE",title:"Upload a Service Account JSON file",type:"base64upload",uploadTarget:"CUBEJS_DB_BQ_CREDENTIALS",extractField:{jsonField:"project_id",formField:"CUBEJS_DB_BQ_PROJECT_ID"}},{env:"CUBEJS_DB_BQ_PROJECT_ID",title:"Project ID"},{env:"CUBEJS_DB_BQ_CREDENTIALS",title:"Encoded Key File"}]},{databases:[{title:"MongoDB",driver:"mongobi",logo:_s}],settings:[].concat(zs,Fs,[Ns])},{databases:[{title:"Snowflake",driver:"snowflake",logo:Rs}],settings:[].concat(Fs,[Ns,{env:"CUBEJS_DB_SNOWFLAKE_ACCOUNT",title:"Account"},{env:"CUBEJS_DB_SNOWFLAKE_REGION",title:"Region"},{env:"CUBEJS_DB_SNOWFLAKE_WAREHOUSE",title:"Warehouse"},{env:"CUBEJS_DB_SNOWFLAKE_ROLE",title:"Role"}])},{databases:[{title:"Presto",driver:"prestodb",logo:qs}],settings:[].concat(zs,Fs,[{env:"CUBEJS_DB_CATALOG",title:"Catalog"},{env:"CUBEJS_DB_SCHEMA",title:"Schema"}])},{databases:[{title:"Druid",driver:"druid",logo:Bs}],settings:[{env:"CUBEJS_DB_URL",title:"URL"}].concat(Fs)}],Us=n(151);function Ks(e){var t=e.loading,n=e.result;return t?Object(_.jsxs)(re.b,{align:"center",size:"middle",children:[Object(_.jsx)(na.a,{"data-testid":"wizard-test-connection-spinner"}),Object(_.jsx)(V.a.Text,{children:"Testing database connection"})]}):(null===n||void 0===n?void 0:n.success)?Object(_.jsxs)(V.a.Text,{type:"success",children:[Object(_.jsx)(Us.a,{}),"\xa0\xa0Connection successful"]}):(null===n||void 0===n?void 0:n.error)?Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(V.a.Text,{type:"danger",children:"We couldn\u2019t connect. Please double check the provided data and try again"}),Object(_.jsx)(A.a,{"data-testid":"wizard-connection-error",style:{marginTop:20},message:"Runtime Error",type:"error",description:Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("p",{style:{paddingLeft:20},children:"Cube.js was unable to connect to the specified database."}),Object(_.jsx)("p",{style:{paddingLeft:20},children:"The database returned the following error:"}),Object(_.jsx)("br",{}),Object(_.jsx)("p",{style:{paddingLeft:40},children:">Database Error"}),Object(_.jsx)("p",{style:{paddingLeft:40},children:n.error.toString()}),Object(_.jsx)("br",{}),Object(_.jsx)("p",{children:"Check your database credentials and try again. For more information, visit:"}),Object(_.jsx)("a",{href:"https://cube.dev/docs/config/databases",target:"_blank",children:"https://cube.dev/docs/config/databases"})]})})]}):null}var Vs,Ys=n(834);function Js(e){var t=e.db;return Object(_.jsx)(K.a,{"data-testid":"wizard-db-card",children:Object(_.jsxs)(Ta.a,{align:"middle",justify:"space-between",children:[Object(_.jsx)(Ea.a,{flex:"40px",children:Object(_.jsx)(Ys.a,{src:t.logo,preview:!1})}),Object(_.jsx)(Ea.a,{children:Object(_.jsx)(V.a.Text,{strong:!0,children:t.title})})]})})}var Gs=D.d.div(Vs||(Vs=Object(k.a)(["\n  background-color: #f8f8f9;\n  padding: 15px 20px;\n  border-radius: 4px;\n"])));function Ws(e){var t=e.db;return Object(_.jsx)(Gs,{children:Object(_.jsxs)(Ta.a,{align:"middle",justify:"space-between",children:[Object(_.jsx)(Ea.a,{flex:"40px",children:Object(_.jsx)(Ys.a,{src:t.logo,preview:!1})}),Object(_.jsx)(Ea.a,{children:Object(_.jsx)(V.a.Text,{strong:!0,children:t.title})})]})})}var Hs,Zs,$s=n(833),Xs=n(872),eu=["onInput"],tu=V.a.Text;function nu(e){var t=e.onInput,n=(Object(h.a)(e,eu),Object(w.useState)("")),r=Object(Q.a)(n,2),a=r[0],i=r[1],o=Object(w.useState)(""),c=Object(Q.a)(o,2),s=c[0],u=c[1],l={name:"file",headers:{authorization:"authorization-text"},accept:"application/json, .json",beforeUpload:function(e){var n=new FileReader;return n.onload=function(e){var n="",r=e.target.result.toString();try{JSON.parse(r),n=btoa(r)}catch(a){u("Invalid JSON file"),console.error(a)}t&&t({encoded:n,raw:JSON.parse(r)})},n.readAsText(e),!1},onChange:function(e){"uploading"!==e.file.status&&console.log(e.file,e.fileList),"done"===e.file.status?i(e.file.name):"error"===e.file.status&&(console.log("".concat(e.file.name," file upload failed.")),u("Invalid file"))},onRemove:function(){u("")}};return Object(_.jsxs)(re.b,{direction:"vertical",children:[Object(_.jsx)($s.a,Object(b.a)(Object(b.a)({},l),{},{children:Object(_.jsx)(Y.a,{icon:Object(_.jsx)(Xs.a,{}),children:"Choose file"})})),a||s?null:Object(_.jsx)(tu,{type:"secondary",children:"No file selected"}),s&&Object(_.jsx)(tu,{type:"danger",children:s})]})}function ru(e){var t=e.db,n=e.deployment,r=e.loading,a=void 0!==r&&r,i=e.disabled,o=void 0!==i&&i,c=e.hostname,s=void 0===c?"":c,u=e.onSubmit,l=te.a.useForm(),d=Object(Q.a)(l,1)[0];Object(w.useEffect)((function(){d.setFieldsValue({CUBEJS_DB_HOST:s})}),[s]);var b=(n.envVariables||[]).reduce((function(e,t){return e[t.name]=t.value,e}),{});return Object(_.jsxs)(te.a,{"data-testid":"wizard-db-form",form:d,layout:"vertical",onFinish:function(e){e.CUBEJS_DB_TYPE=t.driver,u(e)},initialValues:b,children:[t.settings.map((function(e){return"base64upload"===e.type?Object(_.jsx)(nu,{onInput:function(t){var n=t.raw,r=t.encoded;e.uploadTarget&&d.setFieldsValue(Object(ce.a)({},e.uploadTarget,r)),e.extractField&&d.setFieldsValue(Object(ce.a)({},e.extractField.formField,n[e.extractField.jsonField]))}}):Object(_.jsx)(te.a.Item,{label:e.title||e.env,name:e.env,children:e.title?"CUBEJS_DB_PASS"===e.env?Object(_.jsx)(ee.a.Password,{"data-testid":e.env}):Object(_.jsx)(ee.a,{"data-testid":e.env}):Object(_.jsx)(ee.a.TextArea,{"data-testid":e.env,rows:1,style:{overflow:"hidden",resize:"none"}})},e.env)})),Object(_.jsx)(Y.a,{"data-testid":"wizard-form-submit-btn",type:"primary",htmlType:"submit",loading:a,disabled:o,children:"Apply"})]})}var au,iu,ou=Object(D.d)(A.a)(Hs||(Hs=Object(k.a)(["\n  border: none;\n  padding: 16px;\n"]))),cu=Object(D.d)(te.a)(Zs||(Zs=Object(k.a)(["\n  .ant-form-item {\n    margin-bottom: 20px;\n  }\n\n  .ant-form-item:last-child {\n    margin-bottom: 0;\n  }\n\n  .ant-form-item-label {\n    padding-bottom: 4px;\n  }\n"])));function su(e){var t=e.onHostnameCopy;return Object(_.jsx)(ou,{"data-testid":"wizard-localhost-tipbox",type:"warning",message:Object(_.jsxs)(re.b,{direction:"vertical",size:"middle",children:[Object(_.jsxs)(V.a.Text,{children:["To connect to the database running on the localhost use the following ",Object(_.jsx)("b",{children:"hostname"})," value"]}),Object(_.jsxs)(cu,{children:[Object(_.jsx)(Nn,{label:"Mac",value:"host.docker.internal",onCopyClick:t}),Object(_.jsx)(Nn,{label:"Windows",value:"host.docker.internal",onCopyClick:t}),Object(_.jsx)(Nn,{label:"Linux",value:"localhost",onCopyClick:t}),Object(_.jsxs)(re.b,{direction:"vertical",size:"middle",children:[Object(_.jsxs)(V.a.Text,{children:["Please note, for Linux, you need to run Cube.js Docker container in the"," ",Object(_.jsx)(V.a.Link,{href:"https://docs.docker.com/network/host/",target:"_blank",children:'network mode "host"'})," ","to be able to connect to the database running on localhost."]}),Object(_.jsx)(Nn,{value:"docker run --network host",onCopyClick:function(e){return he(e)}})]})]})]})})}var uu=V.a.Title,lu=V.a.Paragraph,du="installing",bu="installed",pu=D.d.div(au||(au=Object(k.a)(["\n  cursor: pointer;\n"]))),hu=D.d.div(iu||(iu=Object(k.a)(["\n  width: auto;\n  min-height: 100vh;\n  max-width: 960px;\n  padding: 48px 24px;\n  margin: 0 auto;\n  background-color: #fff;\n"]))),mu=Qs.reduce((function(e,t){var n=t.databases,r=t.settings;return[].concat(Object(hn.a)(e),Object(hn.a)(n.map((function(e){return Object(b.a)(Object(b.a)({},e),{},{settings:r})}))))}),[]);function fu(e){return ju.apply(this,arguments)}function ju(){return(ju=Object(p.a)(d.a.mark((function e(t){var n,r,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pe("/playground/test-connection",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({variables:t})},5e3);case 2:return n=e.sent,e.next=5,n.json();case 5:if(r=e.sent,!(a=r.error)){e.next=9;break}throw new Error(a);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function vu(e){return yu.apply(this,arguments)}function yu(){return(yu=Object(p.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/playground/env",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({variables:t})});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function gu(e){var t=e.history,n=Pn(),r=Object(w.useState)(""),a=Object(Q.a)(r,2),i=a[0],o=a[1],c=Object(w.useState)(!1),s=Object(Q.a)(c,2),u=s[0],l=s[1],b=Object(w.useState)(!1),h=Object(Q.a)(b,2),m=h[0],f=h[1],j=Object(w.useState)(null),v=Object(Q.a)(j,2),y=v[0],g=v[1],O=Object(w.useState)(null),x=Object(Q.a)(O,2),k=x[0],C=x[1],S=Object(w.useState)(!1),D=Object(Q.a)(S,2),E=D[0],T=D[1],P=Object(w.useState)(null),q=Object(Q.a)(P,2),R=q[0],M=q[1],I=Object(w.useState)(null),L=Object(Q.a)(I,2),B=L[0],z=L[1];function F(e){return Object(p.a)(d.a.mark((function t(){var r,a,i,o,c,s,u,l;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(null===n||void 0===n?void 0:n.isDocker)){t.next=2;break}return t.abrupt("return",C(e));case 2:return t.next=4,fetch("/playground/driver?driver=".concat(e.driver||""));case 4:return r=t.sent,t.next=7,r.json();case 7:if(a=t.sent,i=a.status,o=a.error,!r.ok){t.next=18;break}if(i!==bu){t.next=15;break}return t.abrupt("return",C(e));case 15:i===du&&(T(!0),C(e));case 16:t.next=19;break;case 18:z(o);case 19:return t.next=21,fetch("/playground/driver",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({driver:e.driver})});case 21:return c=t.sent,t.next=24,c.json();case 24:s=t.sent,u=s.dependency,l=s.error,c.ok?(M(u),T(!0),C(e)):z(l);case 28:case"end":return t.stop()}}),t)})))}return Object(w.useEffect)((function(){Vr("connection_wizard_open")}),[]),Object(w.useLayoutEffect)((function(){(null===n||void 0===n?void 0:n.dbType)&&!(null===n||void 0===n?void 0:n.isDocker)&&C(mu.find((function(e){return e.driver.toLowerCase()===n.dbType}))||null)}),[n]),Object(w.useEffect)((function(){var e;return E&&k&&(e=function(e,t,n,r){var a=0,i=!1;function o(){i=!0}function c(){return s.apply(this,arguments)}function s(){return(s=Object(p.a)(d.a.mark((function s(){var u;return d.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,fetch(e,r);case 2:u=s.sent,i||(n({response:u,cancel:o,retries:a}),setTimeout(c,t)),a++;case 5:case"end":return s.stop()}}),s)})))).apply(this,arguments)}return c(),{cancel:o,retries:a}}("/playground/driver?driver=".concat(k.driver),1e3,function(){var e=Object(p.a)(d.a.mark((function e(t){var n,r,a,i,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.response,r=t.cancel,e.next=3,n.json();case 3:a=e.sent,i=a.status,o=a.error,n.ok&&i===bu&&(r(),T(!1)),n.ok||(r(),T(!1),z(o));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),function(){var t;k&&(null===(t=e)||void 0===t||t.cancel())}}),[k,E]),Object(w.useEffect)((function(){f(!1),g(null),z(null),o("")}),[null===k||void 0===k?void 0:k.driver]),B?Object(_.jsx)(hu,{children:Object(_.jsx)(yr,{error:B})}):E&&R?Object(_.jsxs)(hu,{children:[Object(_.jsx)(uu,{children:"Set Up a Database connection"}),Object(_.jsxs)(re.b,{align:"center",size:"middle",children:[Object(_.jsx)(na.a,{}),Object(_.jsxs)(V.a.Text,{children:["Installing ",Object(_.jsx)("b",{children:R})]})]})]}):Object(_.jsxs)(hu,{children:[Object(_.jsx)(uu,{children:"Set Up a Database connection"}),k?Object(_.jsx)(_.Fragment,{children:Object(_.jsxs)(re.b,{direction:"vertical",size:"large",style:{width:"100%"},children:[Object(_.jsxs)(re.b,{size:"middle",children:[Object(_.jsx)(Ws,{db:k}),Object(_.jsx)(Or,{"data-testid":"wizard-change-db-btn",type:"link",onClick:function(){return C(null)},children:"Change"})]}),Object(_.jsxs)(V.a,{children:[k.instructions?Object(_.jsx)("div",{dangerouslySetInnerHTML:{__html:k.instructions}}):Object(_.jsxs)(V.a.Paragraph,{children:["Enter database credentials to connect to your database. ",Object(_.jsx)("br",{}),"Cube.js will store your credentials into the ",Object(_.jsx)("code",{children:".env"})," ","file for future use."]}),Object(_.jsx)(A.a,{type:"info",message:Object(_.jsxs)(_.Fragment,{children:["For advanced configuration, use the ",Object(_.jsx)("b",{children:"cube.js"})," or"," ",Object(_.jsx)("b",{children:".env"})," configuration files in your cube.js project. Note these files are on the mount volume if you are running Docker.",Object(_.jsx)("br",{}),Object(_.jsx)(V.a.Link,{href:"https://cube.dev/docs/config/databases",target:"_blank",children:"Learn more about connecting to databases in the documentation."})]})}),"MongoDB"===k.title?Object(_.jsx)(A.a,{message:"The MongoDB Connector for BI is required to connect to MongoDB.",type:"info"}):null]}),Object(_.jsxs)(Ta.a,{gutter:[40,12],children:[Object(_.jsx)(Ea.a,{span:12,children:Object(_.jsxs)(re.b,{direction:"vertical",size:"large",style:{width:"100%"},children:[Object(_.jsx)(ru,{db:k,deployment:{},loading:u,disabled:m,hostname:i,onSubmit:function(){var e=Object(p.a)(d.a.mark((function e(n){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,g(null),f(!0),e.next=5,fu(n);case 5:return g({success:!0}),l(!0),e.next=9,vu(n);case 9:l(!1),Kr("test_database_connection_success:frontend",{database:k.title}),t.push("/schema"),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(0),g({success:!1,error:e.t0}),Kr("test_database_connection_error:frontend",{error:e.t0.message||e.t0.toString(),database:k.title});case 18:f(!1);case 19:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t){return e.apply(this,arguments)}}()}),Object(_.jsx)(Ks,{loading:m,result:y})]})}),["MySQL","PostgreSQL","Druid","ClickHouse"].includes((null===k||void 0===k?void 0:k.title)||"")&&(null===n||void 0===n?void 0:n.isDocker)?Object(_.jsx)(Ea.a,{span:12,children:Object(_.jsx)(su,{onHostnameCopy:o})}):null]})]})}):Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(lu,{children:"Select a database type"}),Object(_.jsx)(Ta.a,{gutter:[12,12],children:mu.map((function(e){return Object(_.jsx)(Ea.a,{xl:8,lg:8,md:12,sm:24,xs:24,children:Object(_.jsx)(pu,{onClick:F(e),children:Object(_.jsx)(Js,{db:e})})},e.title)}))})]})]})}var Ou=n(873),xu=n(874),ku=function(e,t){var n=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.reduce((function(t,n){return n.children?[].concat(Object(hn.a)(t),Object(hn.a)(e(n.children))):[].concat(Object(hn.a)(t),[n])}),[])}(e).reduce((function(e,t){return Object(b.a)(Object(b.a)({},e),{},Object(ce.a)({},t.dataIndex,t))}),{});function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.type,r=t.format;return void 0==e?e:"boolean"===n?Boolean(e).toString():"number"===n&&"percent"===r?[parseFloat(e).toFixed(2),"%"].join(""):e.toString()}return t.map((function(e){return Object.fromEntries(Object.entries(e).map((function(e){var t=Object(Q.a)(e,2),a=t[0];return[a,r(t[1],n[a])]})))}))};function wu(e){var t=e.resultSet,n=e.pivotConfig,r=_n((function(){var e=t.tableColumns(n);return[e,ku(e,t.tablePivot(n))]}),[t,n]),a=Object(Q.a)(r,2),i=a[0],o=a[1];return Object(_.jsx)(ji.a,{pagination:{pageSize:50},columns:i,dataSource:o})}var Cu,Su={top:50,minWidth:450};function Au(e){var t=e.query,n=e.onClose,r=e.pivotConfig,a=C.a.useState(!0),i=Object(Q.a)(a,2),o=i[0],c=i[1],s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object(w.useRef)({}),r=Object(w.useRef)(!0),a=Object(w.useState)(null),i=Ve()(a,2),o=i[0],c=i[1],s=Object(w.useState)(!1),u=Ve()(s,2),l=u[0],d=u[1],b=Object(w.useState)(null),p=Ve()(b,2),h=p[0],m=p[1],f=Object(w.useState)(null),j=Ve()(f,2),v=j[0],y=j[1],g=Object(w.useState)(null),O=Ve()(g,2),x=O[0],k=O[1],C=Object(w.useContext)(Ya),S=null,A=function(e){var t=e.progressResponse;return y(t)};function D(){return E.apply(this,arguments)}function E(){return(E=Le()(Be.a.mark((function a(){var i,o,c;return Be.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(i=t.resetResultSetOnChange,o=t.cubejsApi||(null===C||void 0===C?void 0:C.cubejsApi)){a.next=4;break}throw new Error("Cube.js API client is not provided");case 4:return i&&m(null),k(null),d(!0),a.prev=7,a.next=10,o.load(e,{mutexObj:n.current,mutexKey:"query",progressCallback:A});case 10:c=a.sent,r.current&&(m(c),y(null)),a.next=17;break;case 14:a.prev=14,a.t0=a.catch(7),r.current&&(k(a.t0),m(null),y(null));case 17:r.current&&d(!1);case 18:case"end":return a.stop()}}),a,null,[[7,14]])})))).apply(this,arguments)}return Object(w.useEffect)((function(){return function(){r.current=!1}}),[]),Object(w.useEffect)((function(){var a=t.skip,i=void 0!==a&&a,s=t.resetResultSetOnChange,u=t.cubejsApi||(null===C||void 0===C?void 0:C.cubejsApi);if(!u)throw new Error("Cube.js API client is not provided");function l(){return(l=Le()(Be.a.mark((function a(){return Be.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(i||!Rt(e)){a.next=20;break}if(Pt(o,e)||((null==s||s)&&m(null),c(e)),k(null),d(!0),a.prev=4,!S){a.next=9;break}return a.next=8,S.unsubscribe();case 8:S=null;case 9:if(!t.subscribe){a.next=13;break}S=u.subscribe(e,{mutexObj:n.current,mutexKey:"query",progressCallback:A},(function(e,t){r.current&&(e?k(e):m(t),d(!1),y(null))})),a.next=15;break;case 13:return a.next=15,D();case 15:a.next=20;break;case 17:a.prev=17,a.t0=a.catch(4),r.current&&(k(a.t0),m(null),d(!1),y(null));case 20:case"end":return a.stop()}}),a,null,[[4,17]])})))).apply(this,arguments)}return function(){l.apply(this,arguments)}(),function(){S&&(S.unsubscribe(),S=null)}}),ci([e,Object.keys(e&&e.order||{}),t,C])),{isLoading:l,resultSet:h,error:x,progress:v,previousQuery:o,refetch:D}}(t,{skip:!t}),u=s.resultSet,l=s.isLoading,d=s.error,b=function(){c(!1)};return Object(_.jsxs)(ne.a,{style:Su,visible:o,onCancel:b,width:"auto",footer:Object(_.jsx)(Y.a,{onClick:b,children:"Close"},"close"),afterClose:n,centered:!0,children:[d?Object(_.jsx)(yr,{error:d}):null,l&&!d?Object(_.jsx)(pr,{}):null,u&&!l?Object(_.jsx)(wu,{resultSet:u,pivotConfig:r}):null]})}var Du=X.a.TabPane,Eu=Object(D.d)(X.a)(Cu||(Cu=Object(k.a)(["\n  & .ant-tabs-nav {\n    background: #fff;\n    padding: 12px 16px 0;\n    margin: 0;\n  }\n\n  & .ant-tabs-extra-content {\n    margin-left: 32px;\n  }\n"])));function Tu(e){var t=e.query,n=e.children,r=e.sidebar,a=void 0===r?null:r,i=e.onTabChange,o=Yi(),c=o.setChartRendererReady,s=o.setQueryStatus,u=o.setQueryError,l=o.setResultSetExists,d=o.setQueryLoading,p=o.setBuildInProgress,h=o.setSlowQuery,m=o.setSlowQueryFromCache,f=o.setQueryRequestId,j=Object(w.useState)(!1),v=Object(Q.a)(j,2),y=v[0],g=v[1],O=Rn("queryTabs",{activeId:"1",tabs:[{id:"1",query:t||{}}]}),x=Object(Q.a)(O,2),k=x[0],C=x[1],S=Object(w.useState)({}),A=Object(Q.a)(S,2),D=A[0],E=A[1];Object(w.useEffect)((function(){window.__cubejsPlayground=Object(b.a)(Object(b.a)({},window.__cubejsPlayground),{},{forQuery:function(e){return{onChartRendererReady:function(){c(e,!0)},onQueryStart:function(){d(e,!0)},onQueryLoad:function(t){var n,r=t.resultSet,a=t.error;if(r){var i,o=r.serialize().loadResponse,c=o.results[0]||{},p=c.requestId,j=c.external,v=c.dbType,y=c.extDbType,g=c.usedPreAggregations,O=void 0===g?{}:g;p&&f(e,p),m(e,Boolean(o.slowQuery)),Boolean(o.slowQuery)&&h(e,!1),l(e,!0),n=Object.keys(O).length>0,Kr(n?"load_request_success_aggregated:frontend":"load_request_success:frontend",Object(b.a)(Object(b.a)({dbType:v},n?{external:j}:null),j?{extDbType:y}:null));var x=r.serialize(),k=Object(Q.a)(x.loadResponse.results,1)[0],w=null===(i=Object.values(k.usedPreAggregations||{})[0])||void 0===i?void 0:i.type,C=k.transformedQuery;s(e,{resultSet:r,error:a,isAggregated:n,preAggregationType:w,transformedQuery:C,extDbType:y,external:j})}a&&(s(e,null),u(e,a)),(r||a)&&d(e,!1)},onQueryProgress:function(t){var n,r;p(e,Boolean(null===t||void 0===t||null===(n=t.stage)||void 0===n?void 0:n.stage.includes("pre-aggregation")));var a=(null===t||void 0===t||null===(r=t.stage)||void 0===r?void 0:r.stage.includes("Executing query"))&&(t.stage.timeElapsed||0)>=5e3;h(e,a),a&&m(e,!1)},onQueryDrilldown:function(e,t){E({query:e,pivotConfig:t})}}}})}),[]),Object(w.useEffect)((function(){if(!y){var e=k.tabs.find((function(e){return e.id===k.activeId}));if(t&&!H()(null===e||void 0===e?void 0:e.query,t)){var n=q();C({activeId:n,tabs:[].concat(Object(hn.a)(k.tabs),[{id:n,query:t}])})}g(!0)}}),[y]),Object(w.useEffect)((function(){if(y&&k.activeId){var e=k.tabs.find((function(e){return e.id===k.activeId}));e&&(null===i||void 0===i||i(e))}}),[y,k.activeId]);var T=k.activeId,P=k.tabs;function q(){for(var e=P.map((function(e){return e.id})),t=1;t<=P.length+1;t++)if(!e.includes(t.toString()))return t.toString();return(P.length+1).toString()}function R(e){C(Object(b.a)(Object(b.a)({},k),{},{tabs:P.map((function(t){return T===t.id?Object(b.a)(Object(b.a)({},t),e):t}))}))}function M(){E({})}return y&&k.activeId?Object(_.jsx)(Eu,{"data-testid":"query-tabs",activeKey:T,type:"editable-card",tabBarExtraContent:{right:a},hideAdd:!1,onChange:function(e){C({activeId:e,tabs:P})},onEdit:function(e){if("string"===typeof e){var t=Number.MAX_VALUE,n=P.filter((function(n,r){var a=n.id;return a===e&&(t=r),a!==e}));C({activeId:n[Math.min(t,n.length-1)].id,tabs:n})}else{var r=q();C({activeId:r,tabs:[].concat(Object(hn.a)(P),[{id:r,query:{}}])})}},children:P.map((function(e){return Object(_.jsxs)(Du,{"data-testid":"query-tab-".concat(e.id),tab:"Query ".concat(e.id),closable:P.length>1,children:[n(e,R),D.query?Object(_.jsx)(Au,{query:D.query,pivotConfig:D.pivotConfig,onClose:M}):null]},e.id)}))}):null}var Pu,qu=["apiUrl","token"],Ru=["apiUrl","token","securityContextToken","dashboardSource","schemaVersion","onSecurityContextModalOpen"],Mu=Object(D.d)(K.a)(Pu||(Pu=Object(k.a)(["\n  border-radius: 0;\n  border-bottom: 1px;\n  min-height: 100%;\n  background: var(--layout-body-background);\n\n  & .ant-card-body {\n    padding: 0;\n  }\n"])));function Iu(e){var t=e.apiUrl,n=e.token,r=Object(h.a)(e,qu),a=Se(),i=a.token,o=a.setIsModalOpen,c=i||n;Object(w.useLayoutEffect)((function(){t&&c&&(window.__cubejsPlayground=Object(b.a)(Object(b.a)({},window.__cubejsPlayground),{},{apiUrl:t,token:c}))}),[t,c]);var s=function(e,t){return Object(w.useMemo)((function(){return t&&e&&"undefined"!==t?pn(t,{apiUrl:e}):null}),[e,t])}(t,c);return s?Object(_.jsx)(oi,{cubejsApi:s,children:Object(_.jsx)(Yc,{apiUrl:t,children:Object(_.jsx)(Ki,{children:Object(_.jsx)(Mu,{bordered:!1,children:Object(_.jsx)(Lu,{apiUrl:t,token:c,dashboardSource:r.dashboardSource,securityContextToken:i,onTabChange:r.onTabChange,extra:r.extra,onSecurityContextModalOpen:function(){return o(!0)}})})})})}):Object(_.jsx)(pr,{})}function Lu(e){var t=e.apiUrl,n=e.token,r=e.securityContextToken,a=e.dashboardSource,i=e.schemaVersion,o=e.onSecurityContextModalOpen,c=Object(h.a)(e,Ru),s=Object(j.f)().location,u=Jc(),l=u.setQuery,d=u.toggleModal,b=new URLSearchParams(s.search),p=JSON.parse(b.get("query")||"null");return Object(_.jsx)(Tu,{query:p,sidebar:Object(_.jsxs)(re.b,{direction:"horizontal",children:[Object(_.jsxs)(Or,{"data-testid":"security-context-btn",icon:Object(_.jsx)(Ou.a,{}),size:"small",type:r?"primary":"default",onClick:o,children:[r?"Edit":"Add"," Security Context"]}),Object(_.jsx)(Or,{"data-testid":"rd-btn",icon:Object(_.jsx)(xu.a,{}),size:"small",onClick:function(){return d()},children:"Add Rollup to Schema"})]}),onTabChange:function(e){var t;null===(t=c.onTabChange)||void 0===t||t.call(c,e),l(e.query)},children:function(e,r){var o=e.id,s=e.query,u=e.chartType;return Object(_.jsx)(ys,{queryId:o,apiUrl:t,cubejsToken:n,initialVizState:{query:s,chartType:u},dashboardSource:a,schemaVersion:i,extra:c.extra,onVizStateChanged:function(e){var t;r({query:e.query||{},chartType:e.chartType}),null===(t=c.onVizStateChanged)||void 0===t||t.call(c,e),e.query&&l(e.query)}})}})}function _u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/cubejs-api";return"".concat(e).concat(t,"/v1")}function Bu(){var e=Object(j.f)().push,t=Object(w.useMemo)((function(){return new aa}),[]),n=wn(),r=Tn(),a=r.apiUrl,i=r.token,o=r.schemaVersion,c=r.setContext,s=r.playgroundContext,u=Se().token,l=s.basePath,d=s.cubejsToken;function b(t){var n=t.query;n&&e({search:"?query=".concat(JSON.stringify(n))})}return Ln((function(){if(!l||null!==n&&n.statusLivePreview.active){if((null===n||void 0===n?void 0:n.statusLivePreview.active)&&n.credentials){var e=n.credentials,t=e.token,r=e.apiUrl;c({apiUrl:_u(r,l),token:t})}}else c({token:u||d,apiUrl:_u(window.location.href.split("#")[0].replace(/\/$/,""),l)})}),[l,n,d,u]),Object(_.jsx)(Iu,{apiUrl:a,token:i,schemaVersion:o,dashboardSource:t,onVizStateChanged:b,onTabChange:b})}var zu=["search"],Fu=Object(v.b)();function Nu(e,t){return Qu.apply(this,arguments)}function Qu(){return(Qu=Object(p.a)(d.a.mark((function e(t,n){var r,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n){e.next=2;break}return e.abrupt("return",n);case 2:return e.next=4,fetch("/playground/token",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({payload:t})});case 4:return r=e.sent,e.next=7,r.json();case 7:return a=e.sent,e.abrupt("return",a.token);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Fu.listen((function(e){e.search;!function(e){var t;null===(t=Nr)||void 0===t||t(Object(b.a)({event:"page"},e),Mr)}(Object(h.a)(e,zu))})),"3080"===window.location.port&&window.location.pathname.includes("/playground/live-preview/start")&&fetch(window.location.pathname).then((function(){return window.close()})),f.a.render(Object(_.jsx)(j.c,{history:Fu,children:Object(_.jsx)(Dn,{playgroundContext:{isCloud:!1},children:Object(_.jsxs)(ta,{children:[Object(_.jsx)(j.b,{exact:!0,path:"/",component:function(){var e=Object(j.f)().push,t=Mn(),n=Pn(),r=Object(w.useState)(null),a=Object(Q.a)(r,2),i=a[0],o=a[1];return Object(w.useEffect)((function(){function e(){return(e=Object(p.a)(d.a.mark((function e(){var n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/playground/files");case 2:return n=e.sent,e.next=5,n.json();case 5:r=e.sent,t()&&o(r.files);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),Object(w.useLayoutEffect)((function(){n&&null!=i&&(n.shouldStartConnectionWizardFlow?e("/connection"):!i.length||1===i.length&&"Orders.js"===i[0].fileName?e("/schema"):e("/build"))}),[n,i]),null}},"index"),Object(_.jsx)(j.b,{path:"/build",component:function(e){return Object(_.jsx)(Ce,{onTokenPayloadChange:Nu,children:Object(_.jsx)(Bu,Object(b.a)({},e))})}},"build"),Object(_.jsx)(j.b,{path:"/schema",component:Da},"schema"),Object(_.jsx)(j.b,{path:"/connection",component:function(){return Object(_.jsx)(gu,{history:Fu})}},"connection"),Object(_.jsx)(j.b,{path:"/dashboard",component:sa},"dashboard"),Object(_.jsx)(j.b,{path:"/template-gallery",component:Cs},"template-gallery")]})})}),document.getElementById("playground-root"))}},[[815,1,2]]]);