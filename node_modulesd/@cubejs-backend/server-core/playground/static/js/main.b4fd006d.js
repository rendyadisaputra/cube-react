!function(e){function t(t){for(var r,o,s=t[0],u=t[1],l=t[2],d=0,p=[];d<s.length;d++)o=s[d],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&p.push(a[o][0]),a[o]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);for(c&&c(t);p.length;)p.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,s=1;s<n.length;s++){var u=n[s];0!==a[u]&&(r=!1)}r&&(i.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},a={1:0},i=[];function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="./";var s=this["webpackJsonp@cubejs-client/playground"]=this["webpackJsonp@cubejs-client/playground"]||[],u=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var c=u;i.push([539,0,2]),n()}({377:function(e,t){var n={pink:"255, 100, 146",purple:"122, 119, 255","purple-03":"175, 173, 255","purple-04":"202, 201, 255",text:"91, 92, 125","dark-01":"20, 20, 70","dark-02":"67, 67, 107","dark-03":"114, 114, 144","dark-04":"161, 161, 181","dark-05":"213, 213, 226",light:"243, 243, 251"};function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return"rgba(".concat(n[e],", ").concat(t,")")}e.exports={"active-bg":r("purple",.1),"primary-bg":r("purple",.1),"primary-1":r("purple",.9),"primary-2":r("purple",.8),"primary-3":r("purple",.7),"primary-4":r("purple",.6),"primary-5":r("purple",.5),"primary-6":r("purple",.4),"primary-7":r("purple",.3),"primary-8":r("purple",.2),"primary-9":r("purple",.1),"primary-10":r("purple",0),"light-5":r("light",.5),"remove-btn-bg":r("purple",.1),"remove-btn-hover-bg":r("purple",.2),"primary-color":r("purple"),"heading-color":r("dark",.65),"link-color":r("purple"),"info-color":r("purple"),"layout-body-background":"#f3f3fc","layout-header-background":"#eeeef5","menu-highlight-color":r("dark-01"),"item-hover-bg":r("light"),"layout-header-height":"48px","font-family":'Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", "Avenir Next", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif',"menu-item-font-size":"15px","btn-primary-shadow":"none","btn-text-shadow":"none","modal-body-padding":"32px","form-item-margin-bottom":"23px","disabled-color":r("dark-04"),"disabled-bg":r("dark-05",.2),"menu-item-active-bg":r("light"),"font-size-base":"14px","border-radius-base":"4px","padding-lg":"16px"},Object.keys(n).forEach((function(t){e.exports["".concat(t,"-color")]=r(t)}))},539:function(e,t,n){e.exports=n(979)},895:function(e,t,n){},896:function(e,t,n){},979:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(27),o=n.n(i),s=n(49),u=n(79),l=n(15),c=n.n(l),d=n(38),p=n(60),m=n(57),f=n(63),h=n(62),b=n(110),y=n(497),v=function(e){Object(f.a)(i,e);var t,n,r=Object(h.a)(i);function i(e){var t;return Object(p.a)(this,i),(t=r.call(this,e)).state={},t}return Object(m.a)(i,[{key:"componentDidMount",value:(n=Object(d.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadFiles();case 2:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"loadFiles",value:(t=Object(d.a)(c.a.mark((function e(){var t,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(b.a)("/playground/files");case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,this.setState({files:n.files});case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"render",value:function(){return this.state.files?a.a.createElement(s.a,{to:!this.state.files.length||1===this.state.files.length&&"Orders.js"===this.state.files[0].fileName?"/schema":"/build"}):a.a.createElement("div",{style:{textAlign:"center",padding:24}},a.a.createElement(y.a,null))}}]),i}(r.Component),g=n(99),k=n.n(g),x=(n(427),n(647),n(648),n(650),n(665),n(73)),O=n.n(x),E=n(159),j=n.n(E),w=n(368),C=n.n(w),S=n(219),D=n.n(S),R=n(369),q=n.n(R),M=n(370),P=n.n(M),T=n(220),A=n.n(T),L=n(533),Q=n(983),F=n(984),z=n(996),I=n(994),N=n(990),U=(n(498),n(371)),V=n.n(U),Y=(n(673),n(674),n(675),n(676),n(678),n(679),n(681),n(685),n(125)),B=n.n(Y),_=(n(454),n(221)),K=n.n(_),H=n(186),G=n.n(H),J=function(e){return(Array.isArray(e)?e:[e]).every((function(e){return e.measures&&e.measures.length||e.dimensions&&e.dimensions.length||e.timeDimensions&&e.timeDimensions.length}))},W=Object(r.createContext)(null);function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach((function(t){j()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function X(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=A()(e);if(t){var a=A()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return P()(this,n)}}var ee=function(e){q()(n,e);var t=X(n);function n(e){var r;return C()(this,n),(r=t.call(this,e)).state={},r.mutexObj={},r}return D()(n,null,[{key:"isQueryPresent",value:function(e){return J(e)}}]),D()(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.query,n=e.queries;t&&this.load(t),n&&this.loadQueries(n)}},{key:"shouldComponentUpdate",value:function(e,t){var n=this.props,r=n.query,a=n.queries,i=n.render,o=n.cubejsApi,s=n.loadSql,u=n.updateOnlyOnStateChange;return!u||(!Object(L.a)(e.query,r)||!Object(L.a)(e.queries,a)||(null==e.render||null==i)&&e.render!==i||e.cubejsApi!==o||e.loadSql!==s||!Object(L.a)(t,this.state)||e.updateOnlyOnStateChange!==u)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.query,r=t.queries;Object(L.a)(e.query,n)||this.load(n),Object(L.a)(e.queries,r)||this.loadQueries(r)}},{key:"cubejsApi",value:function(){return this.props.cubejsApi||this.context&&this.context.cubejsApi}},{key:"load",value:function(e){var t=this,r=this.props.resetResultSetOnChange;this.setState(Z({isLoading:!0,error:null,sqlQuery:null},r?{resultSet:null}:{}));var a=this.props.loadSql,i=this.cubejsApi();e&&n.isQueryPresent(e)&&("only"===a?i.sql(e,{mutexObj:this.mutexObj,mutexKey:"sql"}).then((function(e){return t.setState({sqlQuery:e,error:null,isLoading:!1})})).catch((function(e){return t.setState(Z(Z({},r?{resultSet:null}:{}),{},{error:e,isLoading:!1}))})):a?Promise.all([i.sql(e,{mutexObj:this.mutexObj,mutexKey:"sql"}),i.load(e,{mutexObj:this.mutexObj,mutexKey:"query"})]).then((function(e){var n=O()(e,2),r=n[0],a=n[1];return t.setState({sqlQuery:r,resultSet:a,error:null,isLoading:!1})})).catch((function(e){return t.setState(Z(Z({},r?{resultSet:null}:{}),{},{error:e,isLoading:!1}))})):i.load(e,{mutexObj:this.mutexObj,mutexKey:"query"}).then((function(e){return t.setState({resultSet:e,error:null,isLoading:!1})})).catch((function(e){return t.setState(Z(Z({},r?{resultSet:null}:{}),{},{error:e,isLoading:!1}))})))}},{key:"loadQueries",value:function(e){var t=this,n=this.cubejsApi(),r=this.props.resetResultSetOnChange;this.setState(Z(Z({isLoading:!0},r?{resultSet:null}:{}),{},{error:null})),Promise.all(Object(Q.a)(e).map((function(e){var r=O()(e,2),a=r[0],i=r[1];return n.load(i,{mutexObj:t.mutexObj,mutexKey:a}).then((function(e){return[a,e]}))}))).then((function(e){return t.setState({resultSet:Object(F.a)(e),error:null,isLoading:!1})})).catch((function(e){return t.setState(Z(Z({},r?{resultSet:null}:{}),{},{error:e,isLoading:!1}))}))}},{key:"render",value:function(){var e=this.state,t=e.error,n=e.queries,r=e.resultSet,a=e.isLoading,i=e.sqlQuery,o=this.props.render;return o?o({error:t,resultSet:n?r||{}:r,loadingState:{isLoading:a},sqlQuery:i}):null}}]),n}(a.a.Component);ee.contextType=W,ee.defaultProps={cubejsApi:null,query:null,render:null,queries:null,loadSql:null,updateOnlyOnStateChange:!1,resetResultSetOnChange:!0};function te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?te(Object(n),!0).forEach((function(t){j()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):te(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function re(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=A()(e);if(t){var a=A()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return P()(this,n)}}var ae=[{name:void 0,title:"w/o grouping"},{name:"second",title:"Second"},{name:"minute",title:"Minute"},{name:"hour",title:"Hour"},{name:"day",title:"Day"},{name:"week",title:"Week"},{name:"month",title:"Month"},{name:"year",title:"Year"}],ie=function(e){q()(i,e);var t,n,r=re(i);function i(e){var t;return C()(this,i),(t=r.call(this,e)).state=ne({query:e.query,chartType:"line",orderMembers:[],pivotConfig:null,validatedQuery:e.query},e.vizState),t.mutexObj={},t}return D()(i,null,[{key:"getDerivedStateFromProps",value:function(e,t){var n=ne(ne({},t),e.vizState||{});if(Array.isArray(e.query))throw new Error("Array of queries is not supported.");return ne(ne({},n),{},{query:ne(ne({},n.query),e.query||{})})}},{key:"resolveMember",value:function(e,t){var n=t.meta,r=t.query;return n?Array.isArray(r)?r.reduce((function(t,r){return t.concat(i.resolveMember(e,{meta:n,query:r}))}),[]):"timeDimensions"===e?(r.timeDimensions||[]).map((function(e,t){return ne(ne({},e),{},{dimension:ne(ne({},n.resolveMember(e.dimension,"dimensions")),{},{granularities:ae}),index:t})})):(r[e]||[]).map((function(t,r){return ne({index:r},n.resolveMember(t,e))})):[]}},{key:"getOrderMembers",value:function(e){var t=e.query;if(!e.meta)return[];var n=function(e){return{id:e.name,title:e.title}};return Object(z.a)(Object(I.a)("id"),[].concat(G()(i.resolveMember("measures",e).map(n)),G()(i.resolveMember("dimensions",e).map(n)),G()(i.resolveMember("timeDimensions",e).map((function(e){return n(e.dimension)})))).map((function(e){var n;return ne(ne({},e),{},{order:(null===(n=t.order)||void 0===n?void 0:n[e.id])||"none"})})))}}]),D()(i,[{key:"componentDidMount",value:(n=K()(B.a.mark((function e(){var t,n,r,a,o,s,u;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.state,n=t.query,r=t.pivotConfig,!this.isQueryPresent()){e.next=10;break}return e.next=4,Promise.all([this.cubejsApi().meta(),this.cubejsApi().dryRun(n)]);case 4:s=e.sent,u=O()(s,2),a=u[0],o=u[1].pivotQuery,e.next=13;break;case 10:return e.next=12,this.cubejsApi().meta();case 12:a=e.sent;case 13:this.setState({meta:a,orderMembers:i.getOrderMembers({meta:a,query:n}),pivotConfig:g.ResultSet.getNormalizedPivotConfig(o||{},r)});case 14:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"cubejsApi",value:function(){var e=this.props.cubejsApi;return e||this.context&&this.context.cubejsApi}},{key:"isQueryPresent",value:function(){var e=this.state.query;return ee.isQueryPresent(e)}},{key:"prepareRenderProps",value:function(e){var t=this,n=function(e){return e.name},r=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n;return{add:function(n){var a=t.state.query;t.updateQuery(j()({},e,(a[e]||[]).concat(r(n))))},remove:function(n){var r=(t.state.query[e]||[]).concat([]);return r.splice(n.index,1),t.updateQuery(j()({},e,r))},update:function(n,a){var i=(t.state.query[e]||[]).concat([]);return i.splice(n.index,1,r(a)),t.updateQuery(j()({},e,i))}}},a=this.state,o=a.meta,s=a.query,u=a.orderMembers,l=void 0===u?[]:u,c=a.chartType,d=a.pivotConfig,p=a.validatedQuery,m=Object(z.a)(Object(I.a)("member"),Object(g.flattenFilters)(o&&s.filters||[]).map((function(e){return ne(ne({},e),{},{member:e.member||e.dimension})}))).map((function(e,t){return ne(ne({},e),{},{dimension:o.resolveMember(e.member||e.dimension,["dimensions","measures"]),operators:o.filterOperatorsForMember(e.member||e.dimension,["dimensions","measures"]),index:t})}));return ne({meta:o,query:s,validatedQuery:p,isQueryPresent:this.isQueryPresent(),chartType:c,measures:i.resolveMember("measures",this.state),dimensions:i.resolveMember("dimensions",this.state),timeDimensions:i.resolveMember("timeDimensions",this.state),segments:(o&&s.segments||[]).map((function(e,t){return ne({index:t},o.resolveMember(e,"segments"))})),filters:m,orderMembers:l,availableMeasures:o&&o.membersForQuery(s,"measures")||[],availableDimensions:o&&o.membersForQuery(s,"dimensions")||[],availableTimeDimensions:(o&&o.membersForQuery(s,"dimensions")||[]).filter((function(e){return"time"===e.type})),availableSegments:o&&o.membersForQuery(s,"segments")||[],updateQuery:function(e){return t.updateQuery(e)},updateMeasures:r("measures"),updateDimensions:r("dimensions"),updateSegments:r("segments"),updateTimeDimensions:r("timeDimensions",(function(e){var t=e.compareDateRange?{compareDateRange:e.compareDateRange}:{dateRange:e.dateRange};return ne({dimension:e.dimension.name,granularity:e.granularity},t)})),updateFilters:r("filters",(function(e){return{dimension:e.dimension.name,operator:e.operator,values:e.values}})),updateChartType:function(e){return t.updateVizState({chartType:e})},updateOrder:{set:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";t.updateVizState({orderMembers:l.map((function(t){return ne(ne({},t),{},{order:t.id===e?n:t.order})}))})},update:function(e){t.updateQuery({order:e})},reorder:function(e,n){null!=e&&null!=n&&t.updateVizState({orderMembers:Object(g.moveItemInArray)(l,e,n)})}},pivotConfig:d,updatePivotConfig:{moveItem:function(e){var n=e.sourceIndex,r=e.destinationIndex,a=e.sourceAxis,i=e.destinationAxis,o=ne(ne({},d),{},{x:G()(d.x),y:G()(d.y)}),s=d[a][n],u=o[i].length-1;"measures"===s?r=u+1:r>=u&&"measures"===o[i][u]&&(r=u-1),o[a].splice(n,1),o[i].splice(r,0,s),t.updateVizState({pivotConfig:o})},update:function(e){var n=e.limit;null==n?t.updateVizState({pivotConfig:ne(ne({},d),e)}):t.updateQuery({limit:n})}}},e)}},{key:"updateQuery",value:function(e){var t=this.state.query;this.updateVizState({query:ne(ne({},t),e)})}},{key:"updateVizState",value:(t=K()(B.a.mark((function e(t){var n,r,a,o,s,u,l,c,d,p,m,f,h,b,y;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.props,r=n.setQuery,a=n.setVizState,o=this.state,s=o.query,u=o.pivotConfig,l=this.applyStateChangeHeuristics(t),c=ne({},l.query||s),d=function(e){if(a){e.meta,e.validatedQuery;var t=V()(e,["meta","validatedQuery"]);a(t)}e.query&&r&&r(e.query)},l.shouldApplyHeuristicOrder&&(c.order=Object(g.defaultOrder)(c)),p=Object(N.a)(Object(I.a)("id"),i.getOrderMembers(ne(ne({},this.state),l))),m=(l.orderMembers||[]).map((function(e){return e.id})),f=(l.orderMembers||[]).filter((function(e){var t=e.id;return Boolean(p[t])})),Object.entries(p).forEach((function(e){var t=O()(e,2),n=t[0],r=t[1];m.includes(n)||f.push(r)})),h=ne(ne({},c),{},{order:Object(F.a)(f.map((function(e){var t=e.id,n=e.order;return"none"!==n&&[t,n]})).filter(Boolean))}),l.pivotConfig=g.ResultSet.getNormalizedPivotConfig(h,void 0!==l.pivotConfig?l.pivotConfig:u),d(ne(ne({},t),{},{query:h,orderMembers:f})),this.setState(ne(ne({},l),{},{query:h,orderMembers:f})),b={},!ee.isQueryPresent(c)){e.next=28;break}return e.prev=16,e.next=19,this.cubejsApi().dryRun(c,{mutexObj:this.mutexObj});case 19:y=e.sent,b=y.pivotQuery,l.shouldApplyHeuristicOrder&&(h.order=(y.queryOrder||[]).reduce((function(e,t){return ne(ne({},e),t)}),{})),ee.isQueryPresent(s)&&(l=ne(ne({},l),{},{query:h,pivotConfig:g.ResultSet.getNormalizedPivotConfig(b,l.pivotConfig)}),this.setState(ne(ne({},l),{},{validatedQuery:this.validatedQuery(l)})),d(ne(ne({},this.state),l))),e.next=28;break;case 25:e.prev=25,e.t0=e.catch(16),console.error(e.t0);case 28:case"end":return e.stop()}}),e,this,[[16,25]])}))),function(e){return t.apply(this,arguments)})},{key:"validatedQuery",value:function(e){var t=(e||this.state).query;return ne(ne({},t),{},{filters:(t.filters||[]).filter((function(e){return e.operator}))})}},{key:"defaultHeuristics",value:function(e){var t=this.state,n=t.query,r=t.sessionGranularity||"day";if(Array.isArray(n))return e;if(e.query){var a=n,i=e.query,o=this.state.meta;if(1===(a.timeDimensions||[]).length&&1===(i.timeDimensions||[]).length&&i.timeDimensions[0].granularity&&a.timeDimensions[0].granularity!==i.timeDimensions[0].granularity&&(e=ne(ne({},e),{},{sessionGranularity:i.timeDimensions[0].granularity})),0===(a.measures||[]).length&&(i.measures||[]).length>0||1===(a.measures||[]).length&&1===(i.measures||[]).length&&a.measures[0]!==i.measures[0]){var s=o.defaultTimeDimensionNameFor(i.measures[0]);return i=ne(ne({},i),{},{timeDimensions:s?[{dimension:s,granularity:r}]:[]}),ne(ne({},e),{},{pivotConfig:null,shouldApplyHeuristicOrder:!0,query:i,chartType:s?"line":"number"})}return 0===(a.dimensions||[]).length&&(i.dimensions||[]).length>0?(i=ne(ne({},i),{},{timeDimensions:(i.timeDimensions||[]).map((function(e){return ne(ne({},e),{},{granularity:void 0})}))}),ne(ne({},e),{},{pivotConfig:null,shouldApplyHeuristicOrder:!0,query:i,chartType:"table"})):(a.dimensions||[]).length>0&&0===(i.dimensions||[]).length?(i=ne(ne({},i),{},{timeDimensions:(i.timeDimensions||[]).map((function(e){return ne(ne({},e),{},{granularity:e.granularity||r})}))}),ne(ne({},e),{},{pivotConfig:null,shouldApplyHeuristicOrder:!0,query:i,chartType:(i.timeDimensions||[]).length?"line":"number"})):((a.dimensions||[]).length>0||(a.measures||[]).length>0)&&0===(i.dimensions||[]).length&&0===(i.measures||[]).length?(i=ne(ne({},i),{},{timeDimensions:[],filters:[]}),ne(ne({},e),{},{pivotConfig:null,shouldApplyHeuristicOrder:!0,query:i,sessionGranularity:null})):e}if(e.chartType){var u=e.chartType;if(("line"===u||"area"===u)&&1===(n.timeDimensions||[]).length&&!n.timeDimensions[0].granularity){var l=O()(n.timeDimensions,1)[0];return ne(ne({},e),{},{pivotConfig:null,query:ne(ne({},n),{},{timeDimensions:[ne(ne({},l),{},{granularity:r})]})})}if(("pie"===u||"table"===u||"number"===u)&&1===(n.timeDimensions||[]).length&&n.timeDimensions[0].granularity){var c=O()(n.timeDimensions,1)[0];return ne(ne({},e),{},{pivotConfig:null,shouldApplyHeuristicOrder:!0,query:ne(ne({},n),{},{timeDimensions:[ne(ne({},c),{},{granularity:void 0})]})})}}return e}},{key:"applyStateChangeHeuristics",value:function(e){var t=this.props,n=t.stateChangeHeuristics;return t.disableHeuristics?e:n&&n(this.state,e)||this.defaultHeuristics(e)}},{key:"render",value:function(){var e=this,t=this.state.query,n=this.props,r=n.cubejsApi,i=n.render;return n.wrapWithQueryRenderer?a.a.createElement(ee,{query:t,cubejsApi:r,resetResultSetOnChange:!1,render:function(t){return i?i(e.prepareRenderProps(t)):null}}):i?i(this.prepareRenderProps()):null}}]),i}(a.a.Component);ie.contextType=W,ie.defaultProps={cubejsApi:null,query:{},setQuery:null,setVizState:null,stateChangeHeuristics:null,disableHeuristics:!1,render:null,wrapWithQueryRenderer:!0,vizState:{}};var oe=function(e){var t=e.cubejsApi,n=e.children;return a.a.createElement(W.Provider,{value:{cubejsApi:t}},n)};function se(e){var t=Object(r.useRef)([]);return Object(L.a)(e,t.current)||(t.current=e),t.current}var ue=n(16),le=n(112),ce=function e(t,n){var r=n||{},a=r.retries,i=Object(le.a)(r,["retries"]);return a=a||0,Object(b.a)(t,i).then(function(){var e=Object(d.a)(c.a.mark((function e(t){var n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(500!==t.status){e.next=6;break}return e.next=3,t.text();case 3:n=e.sent;try{r=JSON.parse(n),n=r.error}catch(e){}throw n;case 6:return e.abrupt("return",t);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(r){if("Network request failed"===r.message&&a>0)return e(t,{options:n,retries:a-1});throw r}))},de=function(e,t,n){return ce(e,Object(ue.a)(Object(ue.a)({},t),{},{retries:n}))},pe=function(){function e(){Object(p.a)(this,e)}var t,n,r,a,i,o;return Object(m.a)(e,[{key:"load",value:(o=Object(d.a)(c.a.mark((function e(t){var n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadError=null,e.next=3,de("/playground/dashboard-app-create-status".concat(t?"?instant=true":""),void 0,10);case 3:return n=e.sent,e.next=6,n.json();case 6:(r=e.sent).error?this.loadError=r.error:(this.dashboardCreated="created"===r.status,this.installedTemplates=r.installedTemplates);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"applyTemplatePackages",value:(i=Object(d.a)(c.a.mark((function e(t){var n,r=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.length>1&&void 0!==r[1]?r[1]:null,this.playgroundContext){e.next=5;break}return e.next=4,this.loadContext();case 4:this.playgroundContext=e.sent;case 5:return e.abrupt("return",de("/playground/apply-template-packages",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({toApply:t,templateConfig:n||{credentials:this.playgroundContext}})}));case 6:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"loadContext",value:(a=Object(d.a)(c.a.mark((function e(){var t,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce("/playground/context");case 2:return t=e.sent,e.next=5,t.json();case 5:return n=e.sent,e.abrupt("return",{cubejsToken:n.cubejsToken,apiUrl:n.apiUrl||window.location.href.split("#")[0].replace(/\/$/,"")});case 7:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)})},{key:"templatePackages",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"react";return"react"===e.toLowerCase()?[{name:"react-antd-dynamic",description:"React Antd Dynamic"},{name:"react-antd-static",description:"React Antd Static"},{name:"react-material-static",description:"React Material UI Static"}]:"angular"===e.toLowerCase()?[{name:"ng-material-dynamic",description:"Angular Material UI Dynamic"}]:[]}},{key:"canAddChart",value:(r=Object(d.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:if(!this.loadError){e.next=4;break}return e.abrupt("return",this.loadError);case 4:return e.abrupt("return",!!Object.keys(this.installedTemplates).find((function(e){return e.match(/-static$/)})));case 5:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"addChart",value:(n=Object(d.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:if(!this.loadError){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,this.applyTemplatePackages(["create-react-app",Object.keys(this.installedTemplates).find((function(e){return e.match(/-static$/)})),"static-chart"],{chartCode:t});case 6:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"templates",value:(t=Object(d.a)(c.a.mark((function e(){var t,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce("/playground/manifest");case 2:return e.next=4,e.sent.json();case 4:return t=e.sent,n=t.templates,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})}]),e}(),me=n(97),fe=n(19),he=n(187),be=n(102),ye=n(279),ve=n.n(ye),ge=n(372),ke=n.n(ge),xe=null,Oe=[],Ee={},je=function(){var e=Object(d.a)(c.a.mark((function e(t){var n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ve()("playground_anonymous")||ve()("playground_anonymous",ke()()),Oe.push(Object(ue.a)(Object(ue.a)(Object(ue.a)({},Ee),t),{},{id:ke()(),clientAnonymousId:ve()("playground_anonymous"),clientTimestamp:(new Date).toJSON()})),n=function(){var e=Object(d.a)(c.a.mark((function e(t,r){var a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t||(t=Oe,Oe=[]),t.length){e.next=3;break}return e.abrupt("return",null);case 3:return null==r&&(r=10),e.prev=4,a=(new Date).toJSON(),e.next=8,Object(b.a)("https://track.cube.dev/track",{method:"post",body:JSON.stringify(t.map((function(e){return Object(ue.a)(Object(ue.a)({},e),{},{sentAt:a})}))),headers:{"Content-Type":"application/json"}});case 8:if(!(200!==e.sent.status&&r>0)){e.next=11;break}return e.abrupt("return",n(t,r-1));case 11:e.next=17;break;case 13:if(e.prev=13,e.t0=e.catch(4),!(r>0)){e.next=17;break}return e.abrupt("return",n(t,r-1));case 17:return e.abrupt("return",null);case 18:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(t,n){return e.apply(this,arguments)}}(),r=(xe||Promise.resolve()).then((function(){return n()})).then((function(){r===xe&&(xe=null)})),xe=r,e.abrupt("return",xe);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),we=function(e,t){je(Object(ue.a)({event:e},t))},Ce=function(e,t){we("Playground Action",Object(ue.a)({name:e},t))},Se=n(1003),De=n(158),Re=n(277),qe=n(20),Me=n(66);function Pe(){var e=Object(fe.a)(["\n  &&& .ant-btn-primary:not([disabled]) {\n    background-color: var(--primary-bg);\n    color: var(--primary-color);\n    border: 1px solid var(--primary-color);\n    \n    &:not(:first-child):not(:last-child) {\n      border-left-color: var(--primary-color);\n      border-right-color: var(--primary-color);\n    }\n    \n    &:first-child {\n      border-right-color: var(--primary-color);\n    }\n    \n    &:last-child {\n      border-left-color: var(--primary-color);\n    }\n  }\n\n  && .ant-btn-primary:not([disabled]) + .ant-btn:not(.ant-btn-primary):not([disabled]) {\n    border-left-color: var(--primary-color);\n    \n    &:hover, &:active, &:focus {\n      border-left-color: var(--primary-color);\n    }\n  }\n"]);return Pe=function(){return e},e}function Te(){var e=Object(fe.a)(["\n  && {\n    padding: 5px 12px;\n    height: auto;\n    border-color: var(--dark-05-color); \n    color: var(--text-color);\n    box-shadow: none;\n\n    &:hover, &:active, &:focus {\n      border-color: var(--purple-04-color);\n      color: var(--primary-color);\n    }\n    \n    &.ant-btn-primary:not([disabled]) {\n      background: var(--primary-color);\n      color: white;\n      border-color: var(--primary-color);\n      place-self: center;\n    }\n    \n    &.ant-btn-icon-only {\n      display: inline-flex;\n      place-items: center;\n      padding: 5px 8px;\n      font-size: 14px;\n      \n      svg {\n        width: 15px;\n        height: 14px;\n      }\n    }\n    \n    .anticon {\n      display: inline-block;\n      height: 14px;\n    }\n    \n    &.ant-btn-sm {\n      padding: 0 8px;\n    }\n  }\n"]);return Te=function(){return e},e}var Ae=Object(qe.b)(Me.a)(Te());Ae.Group=Object(qe.b)(Me.a.Group)(Pe());var Le=Ae;function Qe(){var e=Object(fe.a)(["\n  font-weight: 500;\n  font-size: 12px;\n  line-height: 18px;\n  letter-spacing: 0.04em;\n  text-transform: uppercase;\n  color: var(--dark-04-color);\n  margin-bottom: 8px;\n"]);return Qe=function(){return e},e}var Fe=qe.b.div(Qe());function ze(){var e=Object(fe.a)(["\n  display: flex;\n  flex-flow: row wrap; \n  margin-right: -8px;\n  margin-bottom: -8px;\n  \n  && > * {\n    margin-right: 8px !important;\n    margin-bottom: 8px !important;\n  }\n"]);return ze=function(){return e},e}var Ie=qe.b.div(ze()),Ne=n(217);function Ue(){var e=Object(fe.a)(["\n  &&& {\n    &.ant-select-single {\n      .ant-select-selector {\n        padding: 5px 12px;\n        \n        .ant-select-selection-placeholder {\n        line-height: 22px;\n        }\n      }\n    }\n    \n    &.ant-select-multiple {\n      .ant-select-selector {\n        padding: 3px 12px;      \n      }\n      \n      .ant-select-selection-item {\n        margin-top: 0;\n        margin-bottom: 0;\n      }\n    }\n    \n    .ant-select-selection-item {\n      font-size: 14px;\n      line-height: 22px;\n    }\n      \n    .ant-select-selector {  \n      height: auto;\n      border-color: 1px solid var(--dark-05-color);\n      color: var(--text-color);\n      font-size: 14px;\n      line-height: 22px;\n      \n      &:hover, &:active, &:focus {\n        border-color: var(--purple-04-color);\n        color: var(--primary-color);\n      }    \n    }\n    \n    .ant-select-selector::after {\n      font-size: 14px;\n      line-height: 22px;\n    }\n  }\n"]);return Ue=function(){return e},e}var Ve=Object(qe.b)(Ne.a)(Ue()),Ye=n(995);function Be(){var e=Object(fe.a)(["\n  && .ant-select-selector {\n    padding: 5px 12px;\n    height: auto;\n    border-color: 1px solid var(--dark-05-color);\n    color: var(--text-color);\n    \n    &:hover, &:active, &:focus {\n      border-color: var(--purple-04-color);\n      color: var(--primary-color);\n    }\n  }\n"]);return Be=function(){return e},e}Object(qe.b)(Ye.a)(Be());var _e=n(997);function Ke(){var e=Object(fe.a)(["\n  && {\n    border-radius: 8px;\n    border: none;\n  \n    .ant-card-head {\n      border-bottom: 1px solid #D7D7F488;\n      padding: 8px 16px;\n    }\n    \n    .ant-card-head-title {\n      padding: 0;\n      flex: initial;\n    }\n    \n    .ant-card-extra {\n      padding: 0;\n    }\n    \n    .ant-card-head-wrapper {\n      flex-flow: row wrap;\n      place-content: space-between;\n    }\n    \n    .ant-card-head-title {\n      font-size: 18px;\n      line-height: 40px;\n    }\n    \n    .ant-card-body {\n      padding: 16px;\n    }\n  }\n"]);return Ke=function(){return e},e}var He=Object(qe.b)(_e.a)(Ke());function Ge(){var e=Object(fe.a)(["\n  &&& {\n    border-radius: 4px;\n    margin-bottom: 0;\n    margin-top: 0;\n    \n    &::after {\n      border-color: transparent;\n    }\n  \n    &.ant-menu-item-selected {\n      color: var(--primary-color);\n    \n      &::after {\n        border-color: transparent;\n      }\n    }\n  }\n"]);return Ge=function(){return e},e}function Je(){var e=Object(fe.a)(["\n  && {\n    user-select: none;\n    \n    &.ant-menu-inline .ant-menu-item:not(:last-child) {\n      margin-bottom: 0;\n    }\n  }\n"]);return Je=function(){return e},e}var We=Object(qe.b)(De.a)(Je());We.Item=Object(qe.b)(De.a.Item)(Ge());var $e=We,Ze=n(378);function Xe(){var e=Object(fe.a)(["\n  && {\n        \n  }\n"]);return Xe=function(){return e},e}function et(){var e=Object(fe.a)(["\n  && {\n    .ant-tabs-nav {\n      padding: 0 16px;\n      user-select: none;\n    }\n    \n    .ant-tabs-content-holder {\n      padding: 0 16px;\n    }\n  }\n"]);return et=function(){return e},e}var tt=Object(qe.b)(Ze.a)(et());tt.TabPane=Object(qe.b)(Ze.a.TabPane)(Xe());var nt=tt,rt=n(993);function at(){var e=Object(fe.a)(["\n  && {\n    \n  }\n"]);return at=function(){return e},e}function it(){var e=Object(fe.a)(["\n  && {\n    user-select: none;\n    \n    .ant-tree-node-content-wrapper.ant-tree-node-selected {\n      color: white;\n    }\n  }\n"]);return it=function(){return e},e}var ot=Object(qe.b)(rt.a)(it());ot.TreeNode=Object(qe.b)(rt.a.TreeNode)(at());var st=ot,ut=n(998);function lt(){var e=Object(fe.a)(["\n  && {\n    background: ",";\n    border: 1px solid ",";\n    box-sizing: border-box;\n    border-radius: 2px;\n  }\n"]);return lt=function(){return e},e}var ct={error:{border:"#FFCCC7",background:"#FFF1F0"},warning:{border:"#FFE58F",background:"#FFFBE6"},info:{border:"#91D5FF",background:"#E6F7FF"},success:{border:"#B7EB8F",background:"#F6FFED"}},dt=Object(qe.b)(ut.a)(lt(),(function(e){return ct[e.type||"info"].background}),(function(e){return ct[e.type||"info"].border})),pt=n(1e3);function mt(){var e=Object(fe.a)(["\n  && {\n    .ant-popover-inner-content {\n      padding: 0;\n    }\n  }\n"]);return mt=function(){return e},e}var ft=Object(qe.b)(pt.a)(mt()),ht=function(e){var t=e.overlay,n=Object(le.a)(e,["overlay"]);return a.a.createElement(Re.a,{overlay:t,placement:"bottomLeft",trigger:["click"]},a.a.createElement(Le,n))};function bt(){var e=Object(fe.a)(["\n  max-height: 320px;\n  overflow: hidden auto;\n"]);return bt=function(){return e},e}var yt=Object(qe.b)(De.a)(bt()),vt=function(e,t){return a.a.createElement(yt,null,t.length?t.map((function(t){return a.a.createElement(yt.Item,{key:t.name,onClick:function(){return e(t)}},t.title)})):a.a.createElement(yt.Item,{disabled:!0},"No members found"))},gt=function(e){var t=e.onClick,n=e.availableMembers,r=Object(le.a)(e,["onClick","availableMembers"]);return a.a.createElement(ht,Object.assign({overlay:vt(t,n)},r))},kt=n(1002);function xt(){var e=Object(fe.a)(["\n  && {\n    border: 1px solid var(--primary-color);\n    color: var(--primary-color);\n    border-radius: calc(var(--border-radius-base) + 1px);\n  \n    .ant-btn {\n      background-color: var(--primary-9);\n      color: var(--primary-color);\n      border: none;\n      \n      span {\n        color: var(--primary-color);\n      }\n      \n      &:hover {\n        background-color: var(--primary-8);\n        border: none;\n        box-shadow: none;\n      }\n      \n      & + .ant-btn {\n        margin-left: 0;\n      }\n    }\n\n    .remove-btn {\n      background-color: white !important;    \n      color: var(--primary-color);\n      padding: 8px;\n      \n      &:hover {\n        background-color: var(--remove-btn-hover-bg) !important;\n      }\n      \n      .anticon {\n        height: 14px;\n        display: block;\n        vertical-align: initial;\n      }\n    }\n  }\n"]);return xt=function(){return e},e}var Ot=Object(qe.b)((function(e){var t=e.onRemoveClick,n=e.children,r=Object(le.a)(e,["onRemoveClick","children"]);return a.a.createElement(Le.Group,r,n,a.a.createElement(Le,{ghost:!0,onClick:t,className:"remove-btn"},a.a.createElement(kt.a,null)))}))(xt()),Et=function(e){var t=e.members,n=e.availableMembers,r=e.addMemberName,i=e.updateMethods;return a.a.createElement(Ie,null,t.map((function(e){return a.a.createElement(Ot,{key:e.index||e.name,onRemoveClick:function(){return i.remove(e)}},a.a.createElement(gt,{availableMembers:n,onClick:function(t){return i.update(e,t)}},e.title))})),a.a.createElement(gt,{onClick:function(e){return i.add(e)},availableMembers:n,type:"dashed",icon:a.a.createElement(Se.a,null)},t.length?null:r))},jt=n(39),wt={string:function(e){var t=e.values,n=e.onChange;return a.a.createElement(Ve,{key:"input",style:{width:300},mode:"tags",onChange:n,value:t})},number:function(e){var t=e.values,n=e.onChange;return a.a.createElement(Ye.a,{key:"input",style:{width:300},onChange:function(e){return n([e.target.value])},value:t&&t[0]||""})}};wt.string.propTypes={values:jt.array,onChange:jt.func.isRequired},wt.string.defaultProps={values:[]},wt.number.propTypes={values:jt.array,onChange:jt.func.isRequired},wt.number.defaultProps={values:[]};var Ct=function(e){var t=e.member,n=e.updateMethods,r=wt[t.dimension.type]||wt.string;return a.a.createElement(r,{key:"filter",values:t.values,onChange:function(e){return n.update(t,Object(ue.a)(Object(ue.a)({},t),{},{values:e}))}})},St=function(e){var t=e.members,n=e.availableMembers,i=e.addMemberName,o=e.updateMethods;return a.a.createElement(Ie,null,t.map((function(e){return a.a.createElement(r.Fragment,{key:e.index},a.a.createElement(Ot,{onRemoveClick:function(){return o.remove(e)}},a.a.createElement(gt,{onClick:function(t){return o.update(e,Object(ue.a)(Object(ue.a)({},e),{},{dimension:t}))},availableMembers:n,style:{width:150,textOverflow:"ellipsis",overflow:"hidden"}},e.dimension.title)),a.a.createElement(Ve,{value:e.operator,onChange:function(t){return o.update(e,Object(ue.a)(Object(ue.a)({},e),{},{operator:t}))},style:{width:200}},e.operators.map((function(e){return a.a.createElement(Ve.Option,{key:e.name,value:e.name},e.title)}))),a.a.createElement(Ct,{member:e,key:"filterInput",updateMethods:o}))})),a.a.createElement(gt,{onClick:function(e){return o.add({dimension:e})},availableMembers:n,type:"dashed",icon:a.a.createElement(Se.a,null)},t.length?null:i))},Dt=n(988),Rt=n(113),qt=n.n(Rt);function Mt(){var e=Object(fe.a)(["\n  color: var(--dark-04-color);\n  line-height: 32px;\n"]);return Mt=function(){return e},e}var Pt=qe.b.div(Mt()),Tt=Dt.a.RangePicker,At=[{title:"Custom",value:"custom"},{title:"All time",value:void 0},{value:"Today"},{value:"Yesterday"},{value:"This week"},{value:"This month"},{value:"This quarter"},{value:"This year"},{value:"Last 7 days"},{value:"Last 30 days"},{value:"Last week"},{value:"Last month"},{value:"Last quarter"},{value:"Last year"}],Lt=function(e){var t,n=e.members,i=void 0===n?[]:n,o=e.availableMembers,s=e.addMemberName,u=e.updateMethods,l=e.parsedDateRange,c=Array.isArray(null===(t=i[0])||void 0===t?void 0:t.dateRange),d=Object(r.useState)(!1),p=Object(me.a)(d,2),m=p[0],f=p[1];return a.a.createElement(Ie,null,i.map((function(e,t){return a.a.createElement(r.Fragment,{key:t},a.a.createElement(Ot,{onRemoveClick:function(){return u.remove(e)}},a.a.createElement(gt,{onClick:function(t){return u.update(e,Object(ue.a)(Object(ue.a)({},e),{},{dimension:t}))},availableMembers:o},e.dimension.title)),a.a.createElement(Pt,null,"for"),a.a.createElement(ht,{overlay:(s=function(t){"custom"===t.value?f(!0):(u.update(e,Object(ue.a)(Object(ue.a)({},e),{},{dateRange:t.value})),f(!1))},a.a.createElement(De.a,null,At.map((function(e){return a.a.createElement(De.a.Item,{key:e.title||e.value,onClick:function(){return s(e)}},e.title||e.value)}))))},m||c?"Custom":e.dateRange||"All time"),m||c?a.a.createElement(Tt,{format:"YYYY-MM-DD",defaultValue:(l||[]).map((function(e){return qt()(e)})),onChange:function(t){return function(e,t){t&&!t.some((function(e){return!e}))&&u.update(e,Object(ue.a)(Object(ue.a)({},e),{},{dateRange:t.map((function(e){return e.format("YYYY-MM-DD")}))}))}(e,t)}}):null,a.a.createElement(Pt,null,"by"),a.a.createElement(ht,{overlay:(n=e.dimension,i=function(t){return u.update(e,Object(ue.a)(Object(ue.a)({},e),{},{granularity:t.name}))},a.a.createElement(De.a,null,n.granularities.length?n.granularities.map((function(e){return a.a.createElement(De.a.Item,{key:e.title,onClick:function(){return i(e)}},e.title)})):a.a.createElement(De.a.Item,{disabled:!0},"No members found")))},e.dimension.granularities.find((function(t){return t.name===e.granularity}))&&e.dimension.granularities.find((function(t){return t.name===e.granularity})).title));var n,i,s})),!i.length&&a.a.createElement(gt,{availableMembers:o,type:"dashed",icon:a.a.createElement(Se.a,null),onClick:function(e){return u.add({dimension:e,granularity:"day"})}},s))},Qt=n(1004),Ft=n(1005),zt=n(1006),It=n(1007),Nt=n(1008),Ut=n(1009),Vt=[{name:"line",title:"Line",icon:a.a.createElement(Qt.a,null)},{name:"area",title:"Area",icon:a.a.createElement(Ft.a,null)},{name:"bar",title:"Bar",icon:a.a.createElement(zt.a,null)},{name:"pie",title:"Pie",icon:a.a.createElement(It.a,null)},{name:"table",title:"Table",icon:a.a.createElement(Nt.a,null)},{name:"number",title:"Number",icon:a.a.createElement(Ut.a,null)}],Yt=function(e){var t=e.chartType,n=e.updateChartType,r=a.a.createElement(De.a,null,Vt.map((function(e){return a.a.createElement(De.a.Item,{key:e.title,onClick:function(){return n(e.name)}},e.icon," ",e.title)}))),i=Vt.find((function(e){return e.name===t}));return a.a.createElement(ht,{overlay:r,icon:i.icon,style:{border:0}},i.title)},Bt=n(985),_t=n(96),Kt=n(991),Ht=n(1010);function Gt(e){var t=e.id,n=e.index;return a.a.createElement(_t.b,{draggableId:t,index:n},(function(e){var n=e.draggableProps,r=e.dragHandleProps,i=e.innerRef;return a.a.createElement("div",Object.assign({ref:i},n,r,{style:Object(ue.a)(Object(ue.a)({},n.style),{},{border:"1px dashed var(--dark-05-color)",borderRadius:4,padding:"5px 12px",lineHeight:"22px"})}),a.a.createElement(Kt.a.Text,{ellipsis:!0,style:{maxWidth:"100%"}},a.a.createElement(Ht.a,{style:{marginRight:8}}),t))}))}function Jt(e){var t=e.pivotConfig,n=e.axis;return a.a.createElement(a.a.Fragment,null,a.a.createElement(Kt.a.Text,{strong:!0,style:{display:"flex",justifyContent:"center",padding:"8px 16px",background:"var(--light-5)",borderBottom:"1px solid var(--light-color)"}},n),a.a.createElement("div",{style:{padding:"8px"}},a.a.createElement(_t.c,{droppableId:n},(function(e){return a.a.createElement("div",Object.assign({ref:e.innerRef},e.droppableProps,{style:{display:"grid",gridTemplateColumns:"minmax(0, 1fr)",gap:"8px",height:"100%",minHeight:"32px"}}),t[n].map((function(e,t){return a.a.createElement(Gt,{key:e,id:e,index:t})})),e.placeholder)}))))}function Wt(e){var t=e.pivotConfig,n=e.onMove;return a.a.createElement(_t.a,{onDragEnd:function(e){var t=e.source,r=e.destination;Object(le.a)(e,["source","destination"]);r&&n({sourceIndex:t.index,destinationIndex:r.index,sourceAxis:t.droppableId,destinationAxis:r.droppableId})}},a.a.createElement(he.a,null,a.a.createElement(be.a,{span:12,style:{minWidth:160}},a.a.createElement(Jt,{pivotConfig:t,axis:"x"})),a.a.createElement(be.a,{span:12,style:{minWidth:160}},a.a.createElement(Jt,{pivotConfig:t,axis:"y"}))))}var $t=n(218);function Zt(e){var t=e.pivotConfig,n=e.onUpdate;return a.a.createElement($t.a,{checked:t.fillMissingDates,onChange:function(){return n({fillMissingDates:!t.fillMissingDates})}},"Fill Missing Dates")}var Xt=n(276);function en(e){var t=e.id,n=e.index,r=e.order,i=void 0===r?"none":r,o=e.children,s=e.onOrderChange;return a.a.createElement(_t.b,{draggableId:t,index:n},(function(e){var n=e.draggableProps,r=e.dragHandleProps,u=e.innerRef;return a.a.createElement("div",Object.assign({ref:u},n,r,{style:Object(ue.a)({display:"flex",flexWrap:"nowrap",justifyContent:"space-between",alignItems:"center",marginBottom:8},n.style)}),a.a.createElement(Ht.a,null),a.a.createElement(Kt.a.Text,{ellipsis:!0,style:{margin:"0 auto 0 8px",padding:"5px 0"}},o),a.a.createElement(Xt.a.Group,{onChange:function(e){return s(t,e.target.value)},defaultValue:i,size:"small",style:{marginLeft:"8px"}},a.a.createElement(Xt.a.Button,{value:"asc"},"ASC"),a.a.createElement(Xt.a.Button,{value:"desc"},"DESC"),a.a.createElement(Xt.a.Button,{value:"none"},"NONE")))}))}function tn(e){var t=e.orderMembers,n=e.onOrderChange,r=e.onReorder;return a.a.createElement(_t.a,{onDragEnd:function(e){var t=e.source,n=e.destination;r(t&&t.index,n&&n.index)}},a.a.createElement(_t.c,{droppableId:"droppable"},(function(e){return a.a.createElement("div",Object.assign({ref:e.innerRef},e.droppableProps),t.map((function(e,t){var r=e.id,i=e.title,o=e.order;return a.a.createElement(en,{key:r,id:r,index:t,order:o,onOrderChange:n},i)})),e.placeholder)})))}var nn=n(999);function rn(e){var t=e.limit,n=void 0===t?1e4:t,r=e.onUpdate;return a.a.createElement("label",null,"Limit"," ",a.a.createElement(nn.a,{prefix:"Limit",value:n,step:1e3,onChange:function(e){return r({limit:e})}}))}var an=n(516),on=n.n(an);function sn(e){var t=e.pivotConfig,n=e.orderMembers,r=e.limit,i=e.onMove,o=e.onUpdate,s=e.onReorder,u=e.onOrderChange,l=e.isQueryPresent;return a.a.createElement(a.a.Fragment,null,a.a.createElement(on.a,{style:{lineHeight:"32px"}},"Settings:"),a.a.createElement(ft,{content:null===t?a.a.createElement(y.a,null):a.a.createElement(a.a.Fragment,null,a.a.createElement(Wt,{pivotConfig:t,onMove:i}),a.a.createElement(Bt.a,{style:{margin:0}}),a.a.createElement("div",{style:{padding:"8px"}},a.a.createElement(Zt,{pivotConfig:t,onUpdate:o}))),placement:"bottomLeft",trigger:"click"},a.a.createElement(Le,{disabled:!l,style:{border:0}},"Pivot")),a.a.createElement(ft,{content:a.a.createElement("div",{style:{padding:"8px"}},a.a.createElement(tn,{orderMembers:n,onReorder:s,onOrderChange:u})),placement:"bottomLeft",trigger:"click"},a.a.createElement(Le,{disabled:!l,style:{border:0}},"Order")),a.a.createElement(ft,{content:a.a.createElement("div",{style:{padding:"8px"}},a.a.createElement(rn,{limit:r,onUpdate:o})),placement:"bottomLeft",trigger:"click"},a.a.createElement(Le,{disabled:!l,style:{border:0}},"Limit")))}var un={"angular-cli":{files:{"src/polyfills.ts":{content:"import 'core-js/proposals/reflect-metadata';\nimport 'zone.js/dist/zone"},"src/main.ts":{content:"import { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\n\nplatformBrowserDynamic().bootstrapModule(AppModule)\n  .catch(err => console.error(err));"},"src/index.html":{content:'<!DOCTYPE html>\n        <html lang="en">\n          <head>\n            <meta charset="utf-8" />\n            <title>AngularCharts</title>\n            <base href="/" />\n            <meta name="viewport" content="width=device-width, initial-scale=1" />\n            <link rel="icon" type="image/x-icon" href="favicon.ico" />\n          </head>\n          <body>\n            <app-root></app-root>\n          </body>\n        </html>\n        '},".angular-cli.json":{content:'{\n          "apps": [\n            {\n              "root": "src",\n              "outDir": "dist",\n              "index": "index.html",\n              "main": "main.ts",\n              "polyfills": "polyfills.ts",\n              "styles": [],\n              "scripts": []\n            }\n          ]\n        }'}},dependencies:{"zone.js":"latest","@angular/platform-browser-dynamic":"latest","@angular/platform-browser":"latest","@angular/compiler":"latest",rxjs:"latest","@angular/common":"latest"}},"create-react-app":{dependencies:{"react-dom":"latest"}}};function ln(e,t){var n=new CustomEvent("cubejs",{bubbles:!0,composed:!0,detail:t});e.dispatchEvent(n)}var cn=n(517),dn=n.n(cn);function pn(e){var t,n,i=e.iframeRef,o=e.framework,s=e.isChartRendererReady,u=e.chartingLibrary,l=e.chartType,c=e.query,d=e.pivotConfig,p=e.onChartRendererReadyChange;return Object(r.useEffect)((function(){return function(){p(!1)}}),[]),Object(r.useEffect)((function(){i.current&&i.current.addEventListener("load",(function(){p(!0)}))}),[i]),Object(r.useEffect)((function(){s&&i.current&&ln(i.current.contentDocument,{pivotConfig:d,query:c,chartType:l,chartingLibrary:u})}),(t=[i,s,d,c,l],n=Object(r.useRef)([]),dn()(t,n.current)||(n.current=t),n.current)),a.a.createElement("div",null,s?null:a.a.createElement(y.a,null),a.a.createElement("iframe",{ref:i,style:{width:"100%",minHeight:400,border:"none",visibility:s?"visible":"hidden"},title:"Chart renderer",src:"./chart-renderers/".concat(o,"/index.html")}))}var mn=n(1012),fn=n(1013),hn=n(1014),bn=n(1015),yn=n(1016),vn=n(1017),gn=n(1018),kn=n(992),xn=n(537),On=n(518),En=n(216),jn=n.n(En),wn=n(374),Cn=n.n(wn),Sn=function(e){Object(f.a)(n,e);var t=Object(h.a)(n);function n(){return Object(p.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"componentDidMount",value:function(){Cn.a.highlightAll()}},{key:"componentDidUpdate",value:function(){Cn.a.highlightAll()}},{key:"render",value:function(){return a.a.createElement("pre",{style:this.props.style},a.a.createElement("code",{className:"language-javascript"},this.props.code))}}]),n}(a.a.Component),Dn=n(1011),Rn=n(987),qn=function(e){var t=e.query,n=e.cubejsApi;return a.a.createElement(ee,{loadSql:!0,query:Object(ue.a)(Object(ue.a)({},t),{},{renewQuery:!0}),cubejsApi:n,render:function(e){var t=e.sqlQuery,n=e.resultSet;return a.a.createElement(Ze.a,{defaultActiveKey:"refreshKeys",tabBarExtraContent:a.a.createElement("span",null,"Last Refresh Time: ",a.a.createElement("b",null,n&&n.loadResponse.lastRefreshTime))},a.a.createElement(Ze.a.TabPane,{tab:"Refresh Keys",key:"refreshKeys"},a.a.createElement(Rn.a,{loading:!t,pagination:!1,scroll:{x:!0},columns:[{title:"Refresh Key SQL",key:"refreshKey",render:function(e,t){return a.a.createElement(Sn,{code:jn.a.format(t[0])})}},{title:"Value",key:"value",render:function(e,r){return a.a.createElement(Sn,{code:n&&n.loadResponse.refreshKeyValues&&JSON.stringify(n.loadResponse.refreshKeyValues[t.sqlQuery.sql.cacheKeyQueries.queries.indexOf(r)],null,2)})}}],dataSource:t&&t.sqlQuery.sql&&t.sqlQuery.sql.cacheKeyQueries.queries})),a.a.createElement(Ze.a.TabPane,{tab:"Pre-aggregations",key:"preAggregations"},a.a.createElement(Rn.a,{loading:!t,pagination:!1,scroll:{x:!0},columns:[{title:"Table Name",key:"tableName",dataIndex:"tableName",render:function(e){return a.a.createElement("b",null,e)}},{title:"Refresh Key SQL",key:"refreshKey",dataIndex:"invalidateKeyQueries",render:function(e){return e.map((function(e){return a.a.createElement(Sn,{key:e[0],code:jn.a.format(e[0])})}))}},{title:"Refresh Key Value",key:"value",render:function(e,t){return n&&n.loadResponse.usedPreAggregations&&n.loadResponse.usedPreAggregations[t.tableName].refreshKeyValues&&n.loadResponse.usedPreAggregations[t.tableName].refreshKeyValues.map((function(e){return a.a.createElement(Sn,{key:JSON.stringify(e),code:JSON.stringify(e,null,2)})}))}}],dataSource:t&&t.sqlQuery.sql&&t.sqlQuery.sql.preAggregations})),a.a.createElement(Ze.a.TabPane,{tab:"Rollup Match Results",key:"rollupMatchResults"},a.a.createElement(Rn.a,{loading:!t,pagination:!1,scroll:{x:!0},columns:[{title:"Rollup Name",key:"name",dataIndex:"name",render:function(e){return a.a.createElement("b",null,e)}},{title:"Rollup Definition",key:"rollup",dataIndex:"references",render:function(e){return a.a.createElement(Sn,{code:JSON.stringify(e,null,2)})}},{title:"Can Be Used",key:"canUsePreAggregation",dataIndex:"canUsePreAggregation",render:function(e){return e?a.a.createElement(Dn.a,{style:{color:"#52c41a",fontSize:"2em"}}):a.a.createElement(kt.a,{style:{color:"#c2371b",fontSize:"2em"}})}}],dataSource:t&&t.sqlQuery.sql&&t.sqlQuery.sql.rollupMatchResults})))}})};function Mn(){var e=Object(fe.a)(["\n  .ant-card-head {\n    position: sticky;\n    top: 0;\n    z-index: 100;\n    background: white;\n  }\n\n  .ant-card-body {\n    max-width: 100%;\n    overflow: auto;\n  }\n"]);return Mn=function(){return e},e}var Pn={react:"create-react-app",angular:"angular-cli",vue:"vue-cli"},Tn=Object(qe.b)(He)(Mn()),An=[{id:"vanilla",title:"Vanilla JavaScript",docsLink:"https://cube.dev/docs/@cubejs-client-core"},{id:"react",title:"React",supported:!0,scaffoldingSupported:!0},{id:"angular",title:"Angular",supported:!0,scaffoldingSupported:!0},{id:"vue",title:"Vue.js",docsLink:"https://cube.dev/docs/@cubejs-client-vue"}],Ln=function(e){Object(f.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).state={showCode:!1,framework:"react"},r}return Object(m.a)(n,null,[{key:"getDerivedStateFromProps",value:function(e,t){if(e.isChartRendererReady&&null!=e.iframeRef.current&&e.chartingLibrary){var n=e.iframeRef.current.contentWindow.__cubejsPlayground,r=n.getCodesandboxFiles(e.chartingLibrary,{chartType:e.chartType,query:JSON.stringify(e.query,null,2),pivotConfig:JSON.stringify(e.pivotConfig,null,2),apiUrl:"".concat(e.apiUrl,"/cubejs-api/v1"),cubejsToken:e.cubejsToken}),a="";return"react"===t.framework?a=r["index.js"]:"angular"===t.framework&&(a=r["src/app/query-renderer/query-renderer.component.ts"]),Object(ue.a)(Object(ue.a)({},t),{},{dependencies:n.getDependencies(e.chartingLibrary),codeExample:a,codesandboxFiles:r})}return t}}]),Object(m.a)(n,[{key:"render",value:function(){var e=this,t=this.state,n=t.codeExample,r=t.codesandboxFiles,i=t.dependencies,o=t.redirectToDashboard,u=t.showCode,l=t.addingToDashboard,p=t.framework,m=this.props,f=m.isChartRendererReady,h=m.resultSet,b=m.error,y=m.render,v=m.dashboardSource,g=m.hideActions,k=m.query,x=m.cubejsApi,O=m.chartingLibrary,E=m.setChartLibrary,j=m.chartLibraries,w=m.history,C=m.onChartRendererReadyChange;if(o)return a.a.createElement(s.a,{to:"/dashboard"});var S,D=f?Object(On.getParameters)(function(e,t){var n,r,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return{files:Object(ue.a)(Object(ue.a)(Object(ue.a)({},null===(n=un[e])||void 0===n?void 0:n.files),Object.entries(t).map((function(e){var t=Object(me.a)(e,2);return{[t[0]]:{content:t[1]}}})).reduce((function(e,t){return Object(ue.a)(Object(ue.a)({},e),t)}),{})),{},{"package.json":{content:{dependencies:Object(ue.a)(Object(ue.a)({},null===(r=un[e])||void 0===r?void 0:r.dependencies),a.reduce((function(e,t){return Object(ue.a)(Object(ue.a)({},e),{},{[t]:"latest"})}),{}))}}}),template:e}}(Pn[p],r,i)):null,R=(j[p]||[]).length>0?a.a.createElement(De.a,{onClick:function(e){Ce("Set Chart Library",{chartingLibrary:e.key}),E(e.key)}},(j[p]||[]).map((function(e){return a.a.createElement(De.a.Item,{key:e.value},e.title)}))):null,q=a.a.createElement(De.a,{onClick:function(t){var n,r;Ce("Set Framework",{framework:t.key}),e.setState({framework:t.key}),C(!1),E((null===(n=j[t.key])||void 0===n||null===(r=n[0])||void 0===r?void 0:r.value)||null)}},An.map((function(e){return a.a.createElement(De.a.Item,{key:e.id},e.title)}))),M=(j[p]||[]).find((function(e){return e.value===O})),P=An.find((function(e){return e.id===p})),T=a.a.createElement("form",{action:"https://codesandbox.io/api/v1/sandboxes/define",method:"POST",target:"_blank"},null!=D?a.a.createElement("input",{type:"hidden",name:"parameters",value:D}):null,a.a.createElement(Ie,null,a.a.createElement(Le.Group,null,a.a.createElement(Re.a,{overlay:q},a.a.createElement(Le,{size:"small"},null==P?void 0:P.title,a.a.createElement(mn.a,null))),R?a.a.createElement(Re.a,{overlay:R,disabled:!P.supported},a.a.createElement(Le,{size:"small"},null==M?void 0:M.title,a.a.createElement(mn.a,null))):null),a.a.createElement(Le.Group,null,a.a.createElement(Le,{onClick:function(){Ce("Show Chart"),e.setState({showCode:null})},size:"small",type:u?"default":"primary",disabled:!P.supported},"Chart"),a.a.createElement(Le,{onClick:function(){Ce("Show Query"),e.setState({showCode:"query"})},icon:a.a.createElement(fn.a,null),size:"small",type:"query"===u?"primary":"default",disabled:!P.supported},"JSON Query"),a.a.createElement(Le,{onClick:function(){Ce("Show Code"),e.setState({showCode:"code"})},icon:a.a.createElement(hn.a,null),size:"small",type:"code"===u?"primary":"default",disabled:!P.supported},"Code"),a.a.createElement(Le,{onClick:function(){Ce("Show SQL"),e.setState({showCode:"sql"})},icon:a.a.createElement(bn.a,null),size:"small",type:"sql"===u?"primary":"default",disabled:!P.supported},"SQL"),a.a.createElement(Le,{onClick:function(){Ce("Show Cache"),e.setState({showCode:"cache"})},icon:a.a.createElement(yn.a,null),size:"small",type:"cache"===u?"primary":"default",disabled:!P.supported},"Cache")),a.a.createElement(Le,{icon:a.a.createElement(vn.a,null),size:"small",onClick:function(){return Ce("Open Code Sandbox")},htmlType:"submit",disabled:!P.supported},"Edit"),v&&a.a.createElement(Le,{onClick:Object(d.a)(c.a.mark((function t(){var r;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({addingToDashboard:!0}),t.next=3,v.canAddChart();case 3:if("boolean"!=typeof(r=t.sent)||!r){t.next=11;break}return Ce("Add to Dashboard"),t.next=8,v.addChart(n);case 8:e.setState({redirectToDashboard:!0,addingToDashboard:!1}),t.next=12;break;case 11:r?(e.setState({addingToDashboard:!1}),kn.a.error({title:"There is an error loading your dashboard app",content:r,okText:"Fix",okCancel:!0,onOk(){w.push("/dashboard")}})):(e.setState({addingToDashboard:!1}),kn.a.error({title:"Your dashboard app does not support adding of static charts",content:"Please use static dashboard template"}));case 12:case"end":return t.stop()}}),t)}))),icon:a.a.createElement(Se.a,null),size:"small",loading:l,disabled:!P.supported,type:"primary"},l?"Preparing dashboard app. It may take a while. Please check console for progress...":"Add to Dashboard"))),A=JSON.stringify(k,null,2),L=function(){var e=Object(d.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return navigator.clipboard||xn.a.error({message:"Your browser doesn't support copy to clipboard"}),e.prev=1,e.next=4,navigator.clipboard.writeText("query"===u?A:n);case 4:xn.a.success({message:"Copied to clipboard"}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),xn.a.error({message:"Can't copy to clipboard",description:e.t0});case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(){return e.apply(this,arguments)}}();return S="code"===u?a.a.createElement(Ie,null,a.a.createElement("div",null,"Query"),a.a.createElement(Le,{icon:a.a.createElement(gn.a,null),size:"small",onClick:function(){L(),Ce("Copy Code to Clipboard")},type:"primary"},"Copy to Clipboard")):"query"===u?a.a.createElement(Ie,null,a.a.createElement("div",null,"Query"),a.a.createElement(Le,{icon:a.a.createElement(gn.a,null),size:"small",onClick:function(){L(),Ce("Copy Query to Clipboard")},type:"primary"},"Copy to Clipboard")):"sql"===u?"SQL":"Chart",g?y({resultSet:h,error:b}):a.a.createElement(Tn,{title:S,style:{minHeight:420},extra:T},(null==P?void 0:P.supported)?"code"===u?a.a.createElement(Sn,{code:n}):"query"===u?a.a.createElement(Sn,{code:A}):"sql"===u?a.a.createElement(ee,{loadSql:"only",query:k,cubejsApi:x,render:function(e){var t=e.sqlQuery,n=Array.isArray(t)?t:[t],r=Object(me.a)(n,1)[0];return a.a.createElement(Sn,{code:r&&jn.a.format(r.sql())})}}):"cache"===u?a.a.createElement(qn,{query:k,cubejsApi:x}):y({framework:p,error:b}):a.a.createElement("h2",{style:{padding:24,textAlign:"center"}},"We do not support ",P.title," code generation here yet.",a.a.createElement("br",null),"Please refer to ",a.a.createElement("a",{href:P.docsLink,target:"_blank",rel:"noopener noreferrer",onClick:function(){return Ce("Unsupported Framework Docs",{framework:p})}},P.title," docs")," to see on how to use it with Cube.js."))}}]),n}(a.a.Component);Ln.defaultProps={query:{},cubejsApi:null,hideActions:null,dashboardSource:null,codeSandboxSource:null,error:null,resultSet:null};var Qn=Object(s.f)(Ln);function Fn(){var e=Object(fe.a)(["\n  display: flex;\n  flex-flow: column;\n  margin-right: 24px;\n  margin-bottom: 16px;\n\n  > *:first-child {\n    margin-bottom: 8px;\n  }\n"]);return Fn=function(){return e},e}var zn=qe.b.div(Fn()),In={react:[{value:"bizcharts",title:"Bizcharts"},{value:"recharts",title:"Recharts"},{value:"d3",title:"D3"},{value:"chartjs",title:"Chart.js"}],angular:[{value:"angular-ng2-charts",title:"ng2"}]},Nn=function(e,t){return Object.keys(e).map((function(n){return{[n]:function(r,a){var i="".concat(n.split("").map((function(e,t){return 0===t?e.toUpperCase():e})).join("")," Member");a&&a.values&&(i="Update Filter Values"),a&&a.dateRange&&(i="Update Date Range"),a&&a.granularity&&(i="Update Granularity"),Ce(i,{memberName:t});for(var o=arguments.length,s=new Array(o>2?o-2:0),u=2;u<o;u++)s[u-2]=arguments[u];return e[n].apply(null,[r,a].concat(s))}}})).reduce((function(e,t){return Object(ue.a)(Object(ue.a)({},e),t)}),{})};function Un(e){var t,n,i,o,s,u=e.query,l=void 0===u?{}:u,c=e.cubejsApi,d=e.apiUrl,p=e.cubejsToken,m=e.setQuery,f=Object(r.useRef)(null),h=Object(r.useState)("bizcharts"),b=Object(me.a)(h,2),y=b[0],v=b[1],g=Object(r.useState)(!1),k=Object(me.a)(g,2),x=k[0],E=k[1],j=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object(r.useContext)(W),a=Object(r.useRef)({}),i=Object(r.useState)(null),o=O()(i,2),s=o[0],u=o[1],l=Object(r.useState)(!1),c=O()(l,2),d=c[0],p=c[1],m=Object(r.useState)(null),f=O()(m,2),h=f[0],b=f[1];return Object(r.useEffect)((function(){var r=t.skip,i=void 0!==r&&r,o=t.cubejsApi||n&&n.cubejsApi;if(!o)throw new Error("Cube.js API client is not provided");function s(){return(s=K()(B.a.mark((function t(){return B.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i||!e||!J(e)){t.next=16;break}return b(null),p(!0),t.prev=3,t.t0=u,t.next=7,o.dryRun(e,{mutexObj:a.current,mutexKey:"dry-run"});case 7:t.t1=t.sent,(0,t.t0)(t.t1),p(!1),t.next=16;break;case 12:t.prev=12,t.t2=t.catch(3),b(t.t2),p(!1);case 16:case"end":return t.stop()}}),t,null,[[3,12]])})))).apply(this,arguments)}!function(){s.apply(this,arguments)}()}),se([e,Object.keys(e&&e.order||{}),t,n])),{isLoading:d,error:h,response:s}}(l,{skip:"string"!=typeof(null===(t=l.timeDimensions)||void 0===t||null===(n=t[0])||void 0===n?void 0:n.dateRange)}).response;if(j){var w,C=(j.pivotQuery||{}).timeDimensions;s=null===(w=(void 0===C?[]:C)[0])||void 0===w?void 0:w.dateRange}else Array.isArray(null===(i=l.timeDimensions)||void 0===i||null===(o=i[0])||void 0===o?void 0:o.dateRange)&&(s=l.timeDimensions[0].dateRange);return a.a.createElement(ie,{query:l,setQuery:m,cubejsApi:c,wrapWithQueryRenderer:!1,render:function(e){var t=e.error,n=e.isQueryPresent,r=e.chartType,i=e.updateChartType,o=e.measures,u=e.availableMeasures,m=e.updateMeasures,h=e.dimensions,b=e.availableDimensions,g=e.updateDimensions,k=e.segments,O=e.availableSegments,j=e.updateSegments,w=e.filters,C=e.updateFilters,S=e.timeDimensions,D=e.availableTimeDimensions,R=e.updateTimeDimensions,q=e.orderMembers,M=e.updateOrder,P=e.pivotConfig,T=e.updatePivotConfig;return a.a.createElement(a.a.Fragment,null,a.a.createElement(he.a,{justify:"space-around",align:"top",gutter:24,style:{marginBottom:12}},a.a.createElement(be.a,{span:24},a.a.createElement(He,{bordered:!1,style:{borderRadius:0}},a.a.createElement(he.a,{justify:"stretch",align:"top",gutter:0,style:{marginBottom:-12}},a.a.createElement(zn,null,a.a.createElement(Fe,null,"Measures"),a.a.createElement(Et,{members:o,availableMembers:u,addMemberName:"Measure",updateMethods:Nn(m,"Measure")})),a.a.createElement(zn,null,a.a.createElement(Fe,null,"Dimensions"),a.a.createElement(Et,{members:h,availableMembers:b,addMemberName:"Dimension",updateMethods:Nn(g,"Dimension")})),a.a.createElement(zn,null,a.a.createElement(Fe,null,"Segment"),a.a.createElement(Et,{members:k,availableMembers:O,addMemberName:"Segment",updateMethods:Nn(j,"Segment")})),a.a.createElement(zn,null,a.a.createElement(Fe,null,"Time"),a.a.createElement(Lt,{members:S,availableMembers:D,addMemberName:"Time",updateMethods:Nn(R,"Time"),parsedDateRange:s})),a.a.createElement(zn,null,a.a.createElement(Fe,null,"Filters"),a.a.createElement(St,{members:w,availableMembers:b.concat(u),addMemberName:"Filter",updateMethods:Nn(C,"Filter")})))),a.a.createElement(Ie,{style:{marginTop:16,marginLeft:16}},a.a.createElement(Yt,{chartType:r,updateChartType:function(e){Ce("Change Chart Type"),i(e)}}),a.a.createElement(sn,{isQueryPresent:n,limit:l.limit,pivotConfig:P,orderMembers:q,onReorder:M.reorder,onOrderChange:M.set,onMove:T.moveItem,onUpdate:T.update})))),a.a.createElement(he.a,{justify:"space-around",align:"top",gutter:24,style:{marginRight:0,marginLeft:0}},a.a.createElement(be.a,{span:24,style:{paddingLeft:16,paddingRight:16}},n?a.a.createElement(Qn,{apiUrl:d,cubejsToken:p,iframeRef:f,isChartRendererReady:x,query:l,error:t,chartType:r,pivotConfig:P,chartingLibrary:y,setChartLibrary:function(e){f.current&&ln(f.current.contentDocument,{chartingLibrary:e}),v(e)},chartLibraries:In,cubejsApi:c,render:function(e){var t=e.framework;return a.a.createElement(pn,{isChartRendererReady:x,framework:t,chartingLibrary:y,chartType:r,query:l,pivotConfig:P,iframeRef:f,onChartRendererReadyChange:E})},onChartRendererReadyChange:E}):a.a.createElement("h2",{style:{textAlign:"center"}},"Choose a measure or dimension to get started"))))}})}var Vn=function(e){Object(f.a)(r,e);var t,n=Object(h.a)(r);function r(e){var t;return Object(p.a)(this,r),(t=n.call(this,e)).state={},t.dashboardSource=new pe,t}return Object(m.a)(r,[{key:"componentDidMount",value:(t=Object(d.a)(c.a.mark((function e(){var t,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(b.a)("/playground/context");case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,this.setState({cubejsToken:n.cubejsToken,apiUrl:n.apiUrl||window.location.href.split("#")[0].replace(/\/$/,"")});case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"cubejsApi",value:function(){var e=this.state,t=e.cubejsToken,n=e.apiUrl;return!this.cubejsApiInstance&&t&&(this.cubejsApiInstance=k()(t,{apiUrl:"".concat(n,"/cubejs-api/v1")})),this.cubejsApiInstance}},{key:"render",value:function(){var e=this.state,t=e.cubejsToken,n=e.apiUrl,r=this.props,i=r.location,o=r.history,s=new URLSearchParams(i.search),u=s.get("query")&&JSON.parse(s.get("query"))||{};return this.cubejsApi()&&a.a.createElement(oe,{cubejsApi:this.cubejsApi()},a.a.createElement(Un,{query:u,setQuery:function(e){return o.push("/build?query=".concat(JSON.stringify(e)))},cubejsApi:this.cubejsApi(),apiUrl:n,cubejsToken:t,dashboardSource:this.dashboardSource}))||null}}]),r}(r.Component),Yn=n(986),Bn=n(124),_n=Yn.a.Content,Kn=Yn.a.Sider,Hn=st.TreeNode,Gn=nt.TabPane,Jn={},Wn=function(e){Object(f.a)(s,e);var t,n,r,i,o=Object(h.a)(s);function s(e){var t;return Object(p.a)(this,s),(t=o.call(this,e)).state={expandedKeys:[],autoExpandParent:!0,checkedKeys:[],selectedKeys:[],activeTab:"schema",files:[]},t}return Object(m.a)(s,[{key:"componentDidMount",value:(i=Object(d.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadDBSchema();case 2:return e.next=4,this.loadFiles();case 4:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"onExpand",value:function(e){Ce("Expand Tables"),this.setState({expandedKeys:e,autoExpandParent:!1})}},{key:"onCheck",value:function(e){Ce("Check Tables"),this.setState({checkedKeys:e})}},{key:"onSelect",value:function(e){this.setState({selectedKeys:e})}},{key:"cubejsApi",value:function(){var e=this.state,t=e.cubejsToken,n=e.apiUrl;return!this.cubejsApiInstance&&t&&(this.cubejsApiInstance=k()(t,{apiUrl:"".concat(n,"/cubejs-api/v1")})),this.cubejsApiInstance}},{key:"loadDBSchema",value:(r=Object(d.a)(c.a.mark((function e(){var t,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({schemaLoading:!0}),e.prev=1,e.next=4,ce("/playground/db-schema");case 4:return t=e.sent,e.next=7,t.json();case 7:n=e.sent,this.setState({tablesSchema:n.tablesSchema}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),this.setState({schemaLoadingError:e.t0});case 14:return e.prev=14,this.setState({schemaLoading:!1}),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])}))),function(){return r.apply(this,arguments)})},{key:"loadFiles",value:(n=Object(d.a)(c.a.mark((function e(){var t,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce("/playground/files");case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,this.setState({files:n.files});case 7:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"generateSchema",value:(t=Object(d.a)(c.a.mark((function e(){var t,n,r,a,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state,n=t.checkedKeys,r=t.tablesSchema,a=this.props.history,Ce("Generate Schema"),e.next=5,ce("/playground/generate-schema",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tables:n.filter((function(e){return!!Jn[e]})).map((function(e){return Jn[e]})),tablesSchema:r})});case 5:if(200!==(i=e.sent).status){e.next=14;break}return Ce("Generate Schema Success"),e.next=10,this.loadFiles();case 10:this.setState({checkedKeys:[],activeTab:"files"}),kn.a.success({title:"Schema files successfully generated!",content:"You can start building the charts",okText:"Build",cancelText:"Close",okCancel:!0,onOk(){a.push("/build")}}),e.next=20;break;case 14:return e.t0=Ce,e.next=17,i.text();case 17:e.t1=e.sent,e.t2={error:e.t1},(0,e.t0)("Generate Schema Fail",e.t2);case 20:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"selectedFileContent",value:function(){var e=this.selectedFile();return e&&e.content}},{key:"selectedFile",value:function(){var e=this.state,t=e.files,n=e.selectedFile;return t.find((function(e){return e.fileName===n}))}},{key:"renderFilesMenu",value:function(){var e=this,t=this.state,n=t.selectedFile,r=t.files;return a.a.createElement($e,{mode:"inline",onClick:function(t){var n=t.key;Ce("Select File"),e.setState({selectedFile:n})},selectedKeys:n?[n]:[]},r.map((function(e){return a.a.createElement($e.Item,{key:e.fileName},e.fileName)})))}},{key:"render",value:function(){var e=this,t=this.state,n=t.schemaLoading,r=t.schemaLoadingError,i=t.tablesSchema,o=t.selectedFile,s=t.expandedKeys,u=t.autoExpandParent,l=t.checkedKeys,c=t.selectedKeys,d=t.activeTab,p=function e(t){return t.map((function(t){return t.treeData?a.a.createElement(Hn,{title:t.title,key:t.key,dataRef:t},e(t.treeData)):a.a.createElement(Hn,t)}))},m=function(){return Object.keys(i||{}).length>0?a.a.createElement(st,{checkable:!0,onExpand:e.onExpand.bind(e),expandedKeys:s,autoExpandParent:u,onCheck:e.onCheck.bind(e),checkedKeys:l,onSelect:e.onSelect.bind(e),selectedKeys:c},p((t=i||{},Object.keys(t).map((function(e){return{title:e,key:e,treeData:Object.keys(t[e]).map((function(t){var n="".concat(e,".").concat(t);return Jn[n]=[e,t],{title:t,key:n}}))}}))))):a.a.createElement(dt,{message:"Empty DB Schema",description:"Please check connection settings",type:"warning"});var t};return a.a.createElement(Yn.a,{style:{height:"100%"}},a.a.createElement(Kn,{width:340,className:"schema-sidebar"},a.a.createElement(nt,{activeKey:d,onChange:function(t){return e.setState({activeTab:t})},tabBarExtraContent:a.a.createElement(Me.a,{disabled:!l.length,type:"primary",onClick:function(){return e.generateSchema()}},"Generate Schema")},a.a.createElement(Gn,{tab:"Tables",key:"schema"},n?a.a.createElement(y.a,{style:{width:"100%"}}):r?a.a.createElement(dt,{message:"Error while loading DB schema",description:r.toString(),type:"error"}):m()),a.a.createElement(Gn,{tab:"Files",key:"files"},this.renderFilesMenu()))),a.a.createElement(_n,{style:{minHeight:280,padding:24}},o&&a.a.createElement(dt,{message:a.a.createElement("span",null,"This file can be edited at ",a.a.createElement("b",null,this.selectedFile().absPath)),type:"info",style:{paddingTop:10,paddingBottom:11}}),o?a.a.createElement(Sn,{code:this.selectedFileContent(),style:{padding:0,marginTop:24}}):a.a.createElement(Bn.a,{style:{marginTop:50},description:"Select tables to generate Cube.js schema"})))}}]),s}(r.Component),$n=(n(246),n(84)),Zn=function(e){var t=e.children;return a.a.createElement("div",{style:{textAlign:"center",marginTop:50}},t)},Xn=function(){return a.a.createElement("p",{style:{width:450,margin:"20px auto"}},"Dashboard App is a convenient way to setup and deploy frontend app to work with Cube.js backend. You can learn more about in the"," ",a.a.createElement("a",{href:"https://cube.dev/docs/dashboard-app",target:"_blankl"},"Cube.js docs"),".")},er=function(e){Object(f.a)(o,e);var t,n,r,i=Object(h.a)(o);function o(e){var t;return Object(p.a)(this,o),(t=i.call(this,e)).state={},t}return Object(m.a)(o,[{key:"componentDidMount",value:(r=Object(d.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.dashboardSource=new pe,e.next=3,this.loadDashboard();case 3:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"loadDashboard",value:(n=Object(d.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({appCode:null,loadError:null}),e.prev=1,e.next=4,this.dashboardSource.load();case 4:return this.setState({dashboardStarting:!1,appCode:!this.dashboardSource.loadError&&this.dashboardSource.dashboardCreated,loadError:this.dashboardSource.loadError}),e.next=7,ce("/playground/dashboard-app-status");case 7:return e.next=9,e.sent.json();case 9:t=e.sent,this.setState({dashboardRunning:t.running,dashboardPort:t.dashboardPort,dashboardAppPath:t.dashboardAppPath}),e.next=17;break;case 13:throw e.prev=13,e.t0=e.catch(1),this.setState({dashboardStarting:!1,loadError:a.a.createElement("pre",null,e.t0.toString())}),e.t0;case 17:case"end":return e.stop()}}),e,this,[[1,13]])}))),function(){return n.apply(this,arguments)})},{key:"startDashboardApp",value:(t=Object(d.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({dashboardStarting:!0}),e.next=3,ce("/playground/start-dashboard-app");case 3:return e.next=5,this.loadDashboard();case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"render",value:function(){var e=this,t=this.state,n=t.appCode,r=t.dashboardPort,i=t.loadError,o=t.dashboardRunning,u=t.dashboardStarting,l=t.dashboardAppPath;if(i&&"string"==typeof i&&-1!==i.indexOf("Dashboard app not found"))return a.a.createElement(s.a,{to:"/template-gallery"});if(i)return a.a.createElement(Zn,null,a.a.createElement("h2",null,i),a.a.createElement("p",{style:{marginTop:25}},a.a.createElement($n.a,{to:"/template-gallery"},a.a.createElement(Me.a,{type:"primary"},"Create dashboard app in your project directory"))),a.a.createElement(Xn,null));if(!n)return a.a.createElement(Zn,null,a.a.createElement("h2",null," Creating Dashboard App"),a.a.createElement("div",null,a.a.createElement(y.a,{tip:"It may take several minutes. Please check console for progress..."})),a.a.createElement(Xn,null));if(!o)return a.a.createElement(Zn,null,a.a.createElement("h2",null,"Dashboard App is not running"),a.a.createElement("h3",null,"Please start dashboard app or run it manually using",a.a.createElement("code",{className:"inline-code"},"$ npm run start"),a.a.createElement("br",null),"in ",a.a.createElement("b",null,l)," directory."),a.a.createElement("p",{style:{marginTop:25}},a.a.createElement(Me.a,{type:"primary",size:"large",loading:u,onClick:function(){return e.startDashboardApp(!0)}},u?"Dashboard app is starting. It may take a while. Please check console for progress...":"Start dashboard app")),a.a.createElement(Xn,null));var c="http://".concat(window.location.hostname,":").concat(r);return a.a.createElement("div",{style:{height:"100%",width:"100%",padding:"15px 30px 30px 30px",background:"#fff"}},a.a.createElement(ut.a,{message:a.a.createElement("span",null,"This dashboard app can be edited at ",a.a.createElement("b",null,l),". Dev server is running at ",a.a.createElement("a",{href:c,target:"_blank",rel:"noopener noreferrer"},c),". Learn more how to customize and deploy it at ",a.a.createElement("a",{href:"https://cube.dev/docs/dashboard-app"},"Cube.js docs"),". ",a.a.createElement("a",{onClick:function(){return window.location.reload()},style:{cursor:"pointer"}},"Refresh page")," if it is empty."),type:"info",closable:!0,style:{marginBottom:15}}),a.a.createElement("iframe",{src:c,style:{width:"100%",height:"100%",border:0,borderRadius:4,overflow:"hidden"},sandbox:"allow-modals allow-forms allow-popups allow-scripts allow-same-origin",title:"Dashboard"}))}}]),o}(r.Component),tr=Object(s.f)(er),nr=(n(895),n(896),n(1019)),rr=n(1020),ar=n(1021),ir=n(376);function or(){var e=Object(fe.a)(["\n  &&& {\n    float: right;\n    height: 32px;\n    margin: 8px ",";\n    border: 1px solid rgba(255, 255, 255, 0.35);\n    border-radius: 4px;\n    display: flex;\n    align-items: center;\n    color: white;\n    transition: all 0.25s ease;\n    padding: 0 10px;\n  \n    span {\n      font-size: 14px;\n      margin-right: 10px;\n    }\n  \n    &:hover {\n      border-color: white;\n      color: white;\n    }\n  }\n"]);return or=function(){return e},e}function sr(){var e=Object(fe.a)(["\n  &&& {\n    font-size: 15px;\n    font-weight: 500;\n    line-height: 48px;\n    height: 49px;\n    & > a {\n      &, &:hover {\n        opacity: 0.6;\n        color: white;\n      }\n    }\n    &.ant-menu-item-selected,\n    &.ant-menu-item-active {\n      color: white;\n      border-bottom: 2px solid white;\n      \n      &:hover {\n        border-bottom: 2px solid white;      \n      }\n    \n      a {\n        opacity: 1;\n        color: white;\n      }\n    }\n  \n    &:not(.ant-menu-item-selected) {\n      &.ant-menu-item-active,\n      &:hover {\n        color: white;\n        border-bottom: 2px solid white;\n      }\n    }\n  }\n"]);return sr=function(){return e},e}function ur(){var e=Object(fe.a)(["\n  && {\n    background: transparent;\n    border-bottom: 0;\n  }\n"]);return ur=function(){return e},e}function lr(){var e=Object(fe.a)(["\n  && {\n    background-color: var(--dark-02-color);\n    color: white;\n    padding: 0 16px; \n    line-height: 44px; \n    height: 48px;\n  }\n"]);return lr=function(){return e},e}var cr=Object(qe.b)(Yn.a.Header)(lr()),dr=Object(qe.b)(De.a)(ur()),pr=Object(qe.b)(De.a.Item)(sr()),mr=qe.b.a(or(),(function(e){return e.noMargin?"0":"8px"})),fr=function(e){var t=e.selectedKeys,n=Object(ir.useMediaQuery)({query:"(min-device-width: 992px)"}),r=Object(ir.useMediaQuery)({query:"(max-device-width: 991px)"});return a.a.createElement(cr,null,a.a.createElement("div",{style:{float:"left"}},a.a.createElement("img",{src:"./cubejs-playground-logo.svg",style:{height:28,marginRight:28},alt:""})),n&&a.a.createElement(dr,{theme:"light",mode:"horizontal",selectedKeys:t},a.a.createElement(pr,{key:"/build"},a.a.createElement($n.a,{to:"/build"},"Build")),a.a.createElement(pr,{key:"/dashboard"},a.a.createElement($n.a,{to:"/dashboard"},"Dashboard App")),a.a.createElement(pr,{key:"/schema"},a.a.createElement($n.a,{to:"/schema"},"Schema")),a.a.createElement(mr,{noMargin:!0,key:"slack",href:"https://slack.cube.dev",target:"_blank"},a.a.createElement(nr.a,null),"Slack"),a.a.createElement(mr,{key:"docs",href:"https://cube.dev/docs",target:"_blank"},a.a.createElement(rr.a,null),"Docs")),r&&a.a.createElement("div",{style:{float:"right"}},a.a.createElement(Re.a,{overlay:a.a.createElement(De.a,null,a.a.createElement(De.a.Item,{key:"/build"},a.a.createElement($n.a,{to:"/build"},"Build")),a.a.createElement(De.a.Item,{key:"/dashboard"},a.a.createElement($n.a,{to:"/dashboard"},"Dashboard App")),a.a.createElement(De.a.Item,{key:"/schema"},a.a.createElement($n.a,{to:"/schema"},"Schema")))},a.a.createElement(ar.a,null))))},hr=n(377),br=n.n(hr);function yr(){var e=Object(fe.a)(["\n  body {\n    ",'\n  }\n\n  .inline-code {\n    margin: 0 1px;\n    padding: 0.2em 0.4em;\n    font-size: 0.9em;\n    background: #f2f4f5;\n    border: 1px solid #eee;\n    border-radius: 3px;\n  }\n  \n  .ant-dropdown-menu::-webkit-scrollbar-track {\n    background: var(--light-color);\n  }\n  \n  .ant-dropdown-menu::-webkit-scrollbar-thumb {\n    border-radius: 4px;\n    background: var(--dark-03-color);\n  }\n  \n  .ant-dropdown-menu::-webkit-scrollbar {\n    width: 8px;\n    height: 8px;\n  } \n  \n  .schema-sidebar .ant-tabs-top-bar {\n    padding: 0 16px;\n  }\n  \n  .schema-sidebar .ant-menu {\n    border: 0;\n  }\n  \n  .ant-layout-header .ant-menu {\n    height: 100%;\n  }\n  \n  .ant-menu-horizontal .ant-menu-item {\n    top: 0;\n    height: 100%;\n  }\n  \n  .ant-select-item.ant-select-item-option-selected:not(.ant-select-item-option-disabled) {\n    color: white;\n  }\n  \n  .ant-popover .ant-popover-inner-content {\n    padding: 0;\n  }\n  \n  \n  code[class*="language-"],\n  pre[class*="language-"] {\n    color: var(--dark-01-color);\n    background: none;\n    /*text-shadow: 0 1px white;*/\n    font-family: "Roboto Mono", Monaco, \'Andale Mono\', \'Ubuntu Mono\', monospace;\n    text-align: left;\n    font-weight: normal;\n    font-size: 14px;\n    line-height: 20px;\n    white-space: pre;\n    word-spacing: normal;\n    word-break: normal;\n    word-wrap: normal;\n    border-radius: 4px;\n    border: none;\n  \n    -moz-tab-size: 4;\n    -o-tab-size: 4;\n    tab-size: 4;\n  \n    -webkit-hyphens: none;\n    -moz-hyphens: none;\n    -ms-hyphens: none;\n    hyphens: none;\n  }\n  \n  pre[class*="language-"]::-moz-selection, pre[class*="language-"] ::-moz-selection,\n  code[class*="language-"]::-moz-selection, code[class*="language-"] ::-moz-selection {\n    text-shadow: none;\n    /*background: #b3d4fc;*/\n  }\n  \n  pre[class*="language-"]::selection, pre[class*="language-"] ::selection,\n  code[class*="language-"]::selection, code[class*="language-"] ::selection {\n    text-shadow: none;\n    /*background: #b3d4fc;*/\n  }\n  \n  @media print {\n    code[class*="language-"],\n    pre[class*="language-"] {\n      text-shadow: none;\n    }\n  }\n  \n  /* Code blocks */\n  pre[class*="language-"] {\n    padding: 1em;\n    overflow: auto;\n  }\n  \n  :not(pre) > code[class*="language-"],\n  pre[class*="language-"] {\n    background: transparent;\n  }\n  \n  /* Inline code */\n  :not(pre) > code[class*="language-"] {\n    padding: .1em;\n    border-radius: .3em;\n    white-space: normal;\n  }\n  \n  .token.comment,\n  .token.prolog,\n  .token.doctype,\n  .token.cdata {\n    color: var(--dark-04-color);\n  }\n  \n  .token.punctuation {\n    color: var(--dark-04-color);\n  }\n  \n  .namespace {\n    opacity: .7;\n  }\n  \n  .token.property,\n  .token.tag,\n  .token.boolean,\n  .token.number,\n  .token.constant,\n  .token.symbol,\n  .token.deleted {\n    color: var(--pink-color);\n  }\n  \n  .token.selector,\n  .token.attr-name,\n  .token.string,\n  .token.char,\n  .token.builtin,\n  .token.inserted {\n    color: var(--purple-color);\n  }\n  \n  .token.operator,\n  .token.entity,\n  .token.url,\n  .language-css .token.string,\n  .style .token.string {\n    color: var(--dark-01-color);\n  }\n  \n  .token.atrule,\n  .token.attr-value,\n  .token.keyword {\n    color: var(--dark-01-color);\n  }\n  \n  .token.atrule,\n  .token.keyword {\n    font-weight: 500;\n  }\n  \n  .token.function,\n  .token.class-name {\n    color: var(--pink-color);\n  }\n  \n  .token.regex,\n  .token.important,\n  .token.variable {\n    color: var(--pink-color);\n  }\n  \n  .token.important,\n  .token.bold {\n    font-weight: bold;\n  }\n  \n  .token.italic {\n    font-style: italic;\n  }\n  \n  .token.entity {\n    cursor: help;\n  }\n']);return yr=function(){return e},e}var vr={};Object.keys(br.a).forEach((function(e){vr["--".concat(e)]=br.a[e]}));var gr=Object(qe.a)(yr(),Object.entries(vr).map((function(e){var t=Object(me.a)(e,2),n=t[0],r=t[1];return"".concat(n,": ").concat(r,";")})).join("\n    ")),kr=function(e){Object(f.a)(r,e);var t,n=Object(h.a)(r);function r(){return Object(p.a)(this,r),n.apply(this,arguments)}return Object(m.a)(r,[{key:"componentDidMount",value:(t=Object(d.a)(c.a.mark((function e(){var t,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return window.addEventListener("unhandledrejection",(function(e){var t=e.reason;console.log(t);var n=(t.stack||t).toString();we("Playground Error",{error:n}),xn.a.error({message:a.a.createElement("span",null,a.a.createElement("b",null,"Error")," 😢",a.a.createElement("div",null,"Ask about it in ",a.a.createElement("a",{href:"https://slack.cube.dev",target:"_blank",rel:"noopener noreferrer"},"Slack"),". These guys know how to fix this for sure!")),description:n})})),e.next=3,Object(b.a)("/playground/context");case 3:return t=e.sent,e.next=6,t.json();case 6:n=e.sent,r=n.anonymousId,i={coreServerVersion:n.coreServerVersion,projectFingerprint:n.projectFingerprint},Ee=i,je(Object(ue.a)({event:"identify",anonymousId:r},i));case 8:case"end":return e.stop()}var r,i}),e)}))),function(){return t.apply(this,arguments)})},{key:"componentDidCatch",value:function(e,t){we("Playground Error",{error:(e.stack||e).toString(),info:t.toString()})}},{key:"render",value:function(){var e,t=(this.state||{}).fatalError,n=this.props,r=n.location,i=n.children;return a.a.createElement(Yn.a,{style:{height:"100%"}},a.a.createElement(gr,null),a.a.createElement(fr,{selectedKeys:(e=r.pathname,"/template-gallery"===e?["/dashboard"]:[e])}),a.a.createElement(Yn.a.Content,{style:{height:"100%"}},t?a.a.createElement(ut.a,{message:"Error occured while rendering",description:t.stack,type:"error"}):i))}}],[{key:"getDerivedStateFromError",value:function(e){return{fatalError:e}}}]),r}(r.Component);kr.defaultProps={children:[]};var xr=Object(s.f)(kr);function Or(){return(Or=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Er(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var jr=a.a.createElement("path",{d:"M47 92V2",stroke:"#43436B",strokeWidth:3,strokeLinecap:"round"}),wr=a.a.createElement("path",{d:"M92 47L2 47",stroke:"#43436B",strokeWidth:3,strokeLinecap:"round"}),Cr=function(e){var t=e.svgRef,n=e.title,r=Er(e,["svgRef","title"]);return a.a.createElement("svg",Or({width:94,height:94,viewBox:"0 0 94 94",fill:"none",ref:t},r),n?a.a.createElement("title",null,n):null,jr,wr)},Sr=a.a.forwardRef((function(e,t){return a.a.createElement(Cr,Or({svgRef:t},e))})),Dr=(n.p,n(1022)),Rr=n(989),qr=n(1001);function Mr(){var e=Object(fe.a)(["\n  && {\n    &:not(:last-child) {\n      margin-bottom: 16px;\n    }\n    \n    &:last-child {\n      margin-bottom: 0;\n    }\n  }\n"]);return Mr=function(){return e},e}function Pr(){var e=Object(fe.a)(["\n  && {\n    .ant-form-item-label {\n      line-height: 16px;\n      margin-bottom: 7px;\n      label {\n        font-weight: 500;\n        font-size: 12px;\n        line-height: 16px;\n      }\n    }\n\n    .ant-dropdown-trigger {\n      padding: 5px 12px;\n    }\n  }\n"]);return Pr=function(){return e},e}function Tr(){var e=Object(fe.a)(["\n  && {\n    .ant-modal-header {\n      border-bottom: none;\n      padding: 40px 32px 0 32px;\n\n      .ant-modal-title {\n        font-size: 20px;\n      }\n    }\n\n    .ant-modal-footer {\n      border-top: none;\n      padding: 0 32px 34px 32px;\n      text-align: left;\n    }\n  }\n"]);return Tr=function(){return e},e}var Ar=Object(qe.b)(kn.a)(Tr()),Lr=Object(qe.b)(Rr.a)(Pr()),Qr=Object(qe.b)(Rr.a.Item)(Mr()),Fr=function(){return a.a.createElement(Dr.a,{style:{color:"#727290"}})},zr=function(e){var t=e.visible,n=e.onOk,r=e.onCancel,i=e.onChange,o=e.chartLibraries,s=e.currentLibraryItem,u=e.frameworks,l=e.framework,c=e.frameworkItem,d=e.templatePackages,p=e.templatePackage,m=e.enableWebSocketTransport,f=a.a.createElement(De.a,{onClick:function(e){Ce("Set Chart Library",{chartLibrary:e.key}),i("chartLibrary",e.key)}},o.map((function(e){return a.a.createElement(De.a.Item,{key:e.value},e.title)}))),h=a.a.createElement(De.a,{onClick:function(e){Ce("Set Framework",{framework:e.key}),i("framework",e.key)}},u.map((function(e){return a.a.createElement(De.a.Item,{key:e.id},e.title)}))),b=a.a.createElement(De.a,{onClick:function(e){Ce("Set Template Package",{templatePackageName:e.key}),i("templatePackageName",e.key)}},(d||[]).map((function(e){return a.a.createElement(De.a.Item,{key:e.name},e.description)})));return a.a.createElement(Ar,{title:"Create your own Dashboard App",visible:t,onOk:n,onCancel:r,footer:[a.a.createElement(Le,{key:"submit",type:"primary",onClick:n},"Ok"),a.a.createElement(Le,{key:"back",onClick:r},"Cancel")]},a.a.createElement(Lr,null,a.a.createElement(Qr,{label:"Framework"},a.a.createElement(Re.a,{overlay:h},a.a.createElement(Le,null,c&&c.title,a.a.createElement(Fr,null)))),!(null==c?void 0:c.scaffoldingSupported)&&a.a.createElement(ut.a,{style:{marginBottom:23},type:"info",message:a.a.createElement("span",null,"We do not support ",c.title," dashboard scaffolding generation yet. Please refer to ",a.a.createElement("a",{href:c.docsLink,target:"_blank",rel:"noopener noreferrer",onClick:function(){return Ce("Unsupported Dashboard Framework Docs",{framework:l})}},c.title," docs")," to see on how to use it with Cube.js.")}),a.a.createElement(Qr,{label:"Main Template"},a.a.createElement(Re.a,{overlay:b,disabled:!c.scaffoldingSupported},a.a.createElement(Le,null,p&&p.description,a.a.createElement(Fr,null)))),a.a.createElement(Qr,{label:"Charting Library"},a.a.createElement(Re.a,{overlay:f,disabled:!c.scaffoldingSupported},a.a.createElement(Le,null,s&&s.title,a.a.createElement(Fr,null)))),a.a.createElement(Qr,{label:"Web Socket Transport (Real-time)"},a.a.createElement(qr.a,{disabled:"angular"===l.toLowerCase(),checked:m,onChange:function(e){return i("enableWebSocketTransport",e)}}))))};function Ir(){var e=Object(fe.a)(["\n  display: block;\n  font-size: 16px;\n  margin-bottom: 24px;\n"]);return Ir=function(){return e},e}function Nr(){var e=Object(fe.a)(["\n  && {\n    border: none;\n    border-radius: 8px;\n    margin-bottom: 24px;\n    padding: 16px;\n    ","\n\n    &:hover {\n      padding: 16px;\n      ","\n    }\n\n    button {\n      display: none;\n      position: absolute;\n      margin-left: -64px;\n      top: 80px;\n      left: 50%;\n    }\n\n    svg path {\n      transition: stroke 0.25s ease;\n    }\n\n    && .ant-card-cover {\n      height: 168px;\n      border-radius: 8px 8px 0 0;\n      background: ",";\n      display: flex;\n      align-items: center;\n      position: relative;\n      margin: -16px -16px 0 -16px;\n      padding: 24px 24px 0 24px;\n\n      &::after {\n        content: '';\n        position: absolute;\n        width: 100%;\n        height: 100%;\n        top: 0;\n        left: 0;\n        background: rgba(81, 87, 125, 0.3);\n        opacity: 0;\n        transition: all 0.25s;\n        border-radius: 8px 8px 0 0;\n      }\n\n      div {\n        //box-shadow: 0 -1px 6px rgba(20, 20, 70, .06);\n        background-position: top;\n        border-radius: 4px 4px 0 0;\n      }\n    }\n\n    &&.ant-card-hoverable:hover {\n      box-shadow: 0px 15px 20px rgba(67, 67, 107, 0.1);\n      button {\n        display: block;\n      }\n      &:hover .ant-card-cover:after {\n        opacity: ",";\n      }\n    }\n\n    svg path {\n      stroke: var(--primary-color);\n    }\n\n    && .ant-card-body {\n      min-height: 175px;\n      display: flex;\n      place-items: stretch;\n      place-content: start stretch;\n      text-align: left;\n      z-index: 1;\n      padding: 24px 0 16px;\n    }\n\n    && .ant-card-meta {\n      text-align: left;\n    }\n\n    && .ant-card-meta-title {\n      white-space: unset;\n      color: ",";\n      text-align: ",";\n      margin-bottom: 16px;\n    }\n\n    && .ant-card-meta-description {\n      color: ",";\n      opacity: ",";\n      font-size: 13px;\n      text-align: ",";\n      ","\n    }\n  }\n"]);return Nr=function(){return e},e}function Ur(){var e=Object(fe.a)(["\n  position: relative;\n  width: 100%;\n  height: 100%;\n  margin: auto;\n  max-width: 1024px;\n  background-size: cover;\n  background-repeat: no-repeat;\n  background-position: center;\n  background-image: ",";\n"]);return Ur=function(){return e},e}var Vr=function(e){var t=e.children;return a.a.createElement("div",{style:{margin:25}},t)},Yr=qe.b.div(Ur(),(function(e){return'url("'.concat(e.src,'")')})),Br=Object(qe.b)(He)(Nr(),(function(e){return e.createYourOwn?"\n      background: transparent;\n      border: 1px solid var(--purple-03-color);\n    ":""}),(function(e){return e.createYourOwn?"\n        border: 1px solid var(--purple-03-color);\n      ":"border: none;"}),(function(e){return e.createYourOwn?"transparent":"#DEDEF1"}),(function(e){return e.createYourOwn?"0":"1"}),(function(e){return e.createYourOwn?"var(--primary-color)":"var(--text-color)"}),(function(e){return e.createYourOwn?"center":"left"}),(function(e){return e.createYourOwn?"var(--primary-color)":"var(--dark-04-color)"}),(function(e){return e.createYourOwn?"0.8":1}),(function(e){return e.createYourOwn?"center":"left"}),(function(e){return e.createYourOwn?"padding: 0 32px;":""})),_r=Object(qe.b)(Kt.a.Text)(Ir()),Kr=function(e){Object(f.a)(r,e);var t,n=Object(h.a)(r);function r(e){var t;return Object(p.a)(this,r),(t=n.call(this,e)).state={chartLibrary:In.react[0].value,framework:"react",templatePackageName:"react-antd-dynamic",templates:null},t}return Object(m.a)(r,[{key:"componentDidMount",value:(t=Object(d.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.dashboardSource=new pe,e.next=3,this.dashboardSource.load(!0);case 3:return e.t0=this,e.t1=this.dashboardSource.loadError,e.next=7,this.dashboardSource.templates();case 7:e.t2=e.sent,e.t3={loadError:e.t1,templates:e.t2},e.t0.setState.call(e.t0,e.t3);case 10:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"render",value:function(){var e,t=this,n=this.state,r=n.loadError,i=n.templates;if(r&&-1===r.indexOf("Dashboard app not found"))return a.a.createElement(s.a,{to:"/dashboard"});if(null==i)return a.a.createElement(y.a,null);var o=this.state,u=o.chartLibrary,l=o.framework,p=o.templatePackageName,m=o.createOwnModalVisible,f=o.enableWebSocketTransport,h=this.props.history,b=In[l].find((function(e){return e.value===u})),v=An.find((function(e){return e.id===l})),g=null===(e=this.dashboardSource)||void 0===e?void 0:e.templatePackages(l).find((function(e){return e.name===p})),k=i.map((function(e){var n=e.name,r=e.description,i=e.coverUrl;return a.a.createElement(be.a,{xs:{span:24},md:{span:12},lg:{span:8},xl:{span:6},style:{display:"flex"},key:n},a.a.createElement(Br,{hoverable:!0,bordered:!1,cover:a.a.createElement(Yr,{src:i})},a.a.createElement(He.Meta,{title:n,description:r}),a.a.createElement(Le,{type:"primary",onClick:Object(d.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.dashboardSource.applyTemplatePackages(n);case 2:h.push("/dashboard");case 3:case"end":return e.stop()}}),e)})))},"Create App")))})).concat([a.a.createElement(be.a,{xs:{span:24},md:{span:12},lg:{span:8},xl:{span:6},style:{display:"flex"},key:"own"},a.a.createElement(Br,{onClick:function(){return t.setState({createOwnModalVisible:!0})},hoverable:!0,createYourOwn:!0,bordered:!1,cover:a.a.createElement(Sr,null)},a.a.createElement(He.Meta,{title:"Create your Own",description:"Mix different templates together to create your own dashboard application"})),a.a.createElement(zr,{visible:m,onOk:Object(d.a)(c.a.mark((function e(){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],t.setState({createOwnModalVisible:!1}),n="react"===l.toLowerCase()?["create-react-app",p,"".concat(u,"-charts"),"".concat(p.match(/^react-(\w+)/)[1],"-tables"),"react-credentials"].concat(f?["react-web-socket-transport"]:[]):["create-ng-app",p,"ng2-charts","ng-credentials"],e.next=5,t.dashboardSource.applyTemplatePackages(n);case 5:h.push("/dashboard");case 6:case"end":return e.stop()}}),e)}))),onCancel:function(){return t.setState({createOwnModalVisible:!1})},onChange:function(e,n){"framework"===e&&l!==n&&t.setState({templatePackageName:"ng-material-dynamic",chartLibrary:In[n.toLowerCase()][0].value}),t.setState({[e]:n})},chartLibraries:In[l],currentLibraryItem:b,frameworks:An,framework:l,frameworkItem:v,templatePackages:this.dashboardSource&&this.dashboardSource.templatePackages(l),templatePackage:g,enableWebSocketTransport:f&&"angular"!==l.toLowerCase()}))]);return a.a.createElement(Vr,null,a.a.createElement(_r,null,"Build your app from one the popular templates below or"," ",a.a.createElement("a",{onClick:function(){return t.setState({createOwnModalVisible:!0})}},"create your own")),a.a.createElement(he.a,{gutter:24},k))}}]),r}(r.Component),Hr=Object(s.f)(Kr),Gr=Object(u.b)();Gr.listen((function(e){var t;t=e,je(Object(ue.a)({event:"page"},t))})),o.a.render(a.a.createElement(s.c,{history:Gr},a.a.createElement(xr,null,a.a.createElement(s.b,{key:"index",exact:!0,path:"/",component:v}),a.a.createElement(s.b,{key:"build",path:"/build",component:Vn}),a.a.createElement(s.b,{key:"schema",path:"/schema",component:Wn}),a.a.createElement(s.b,{key:"dashboard",path:"/dashboard",component:tr}),a.a.createElement(s.b,{key:"template-gallery",path:"/template-gallery",component:Hr}))),document.getElementById("playground-root"))},99:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(555),n(562),n(564);var r=n(570);n(401);var a=n(571),i=n(572),o=n(402),s=n(573),u=n(574),l=n(575);n(578),n(579),n(580),n(581),n(582),n(305),n(585),n(587),n(590),n(592),n(593),n(415),n(596),n(597),n(598),n(601),n(602),n(603),n(605),n(607);var c=n(608),d=n(610),p=n(614),m=n(978),f=n(424),h=n(618);n(619);var b=n(624);n(625);var y=n(626),v=n(627),g=n(426),k=n(629);function x(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}n(633);var O=x(r),E=x(a),j=x(i),w=x(o),C=x(s),S=x(u),D=x(l),R=x(c),q=x(d),M=x(p),P=x(f),T=x(h),A=x(b),L=x(y),Q=x(v),F=x(g),z=x(k);function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){j.default(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var U=T.default.extendMoment(P.default),V={day:function(e){return Array.from(e.by("day")).map((function(e){return e.format("YYYY-MM-DDT00:00:00.000")}))},month:function(e){return Array.from(e.snapTo("month").by("month")).map((function(e){return e.format("YYYY-MM-01T00:00:00.000")}))},year:function(e){return Array.from(e.snapTo("year").by("year")).map((function(e){return e.format("YYYY-01-01T00:00:00.000")}))},hour:function(e){return Array.from(e.by("hour")).map((function(e){return e.format("YYYY-MM-DDTHH:00:00.000")}))},minute:function(e){return Array.from(e.by("minute")).map((function(e){return e.format("YYYY-MM-DDTHH:mm:00.000")}))},second:function(e){return Array.from(e.by("second")).map((function(e){return e.format("YYYY-MM-DDTHH:mm:ss.000")}))},week:function(e){return Array.from(e.snapTo("isoweek").by("week")).map((function(e){return e.startOf("isoweek").format("YYYY-MM-DDT00:00:00.000")}))}},Y=/^\d\d\d\d-\d\d-\d\d$/,B=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z?$/,_=function(e){var t=new Map;return function(n){return n.forEach((function(n){var r=e(n);t.has(r)||t.set(r,[]),t.get(r).push(n)})),Array.from(t.entries())}},K={REGULAR_QUERY:"regularQuery",COMPARE_DATE_RANGE_QUERY:"compareDateRangeQuery",BLENDING_QUERY:"blendingQuery"},H=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(C.default(this,e),this.loadResponse=t,null!=this.loadResponse.queryType?(this.queryType=t.queryType,this.loadResponses=t.results):(this.queryType=K.REGULAR_QUERY,this.loadResponse.pivotQuery=N(N({},t.query),{},{queryType:this.queryType}),this.loadResponses=[t]),!Object.values(K).includes(this.queryType))throw new Error("Unknown query type");this.parseDateMeasures=n.parseDateMeasures,this.options=n,this.backwardCompatibleData=[]}return S.default(e,null,[{key:"measureFromAxis",value:function(e){return e[e.length-1]}},{key:"timeDimensionMember",value:function(e){return"".concat(e.dimension,".").concat(e.granularity)}},{key:"deserialize",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new e(t.loadResponse,n)}}]),S.default(e,[{key:"drillDown",value:function(e,t){if(this.queryType===K.COMPARE_DATE_RANGE_QUERY)throw new Error("compareDateRange drillDown query is not currently supported");if(this.queryType===K.BLENDING_QUERY)throw new Error("Data blending drillDown query is not currently supported");var n=e.xValues,r=void 0===n?[]:n,a=e.yValues,i=void 0===a?[]:a,o=this.normalizePivotConfig(t),s=[];o.x.forEach((function(e,t){return s.push([e,r[t]])})),o.y.forEach((function(e,t){return s.push([e,i[t]])}));var u=this.query(),l=u.filters,c=void 0===l?[]:l,d=u.segments,p=void 0===d?[]:d,m=this.loadResponses[0].annotation.measures,f=s.find((function(e){return"measures"===M.default(e,1)[0]}))||[],h=M.default(f,2)[1];if(void 0===h){var b=Object.keys(m);h=M.default(b,1)[0]}if(!(m[h]&&m[h].drillMembers||[]).length)return null;var y=[{member:h,operator:"measureFilter"}].concat(q.default(c)),v=[];return s.filter((function(e){return"measures"!==M.default(e,1)[0]})).forEach((function(e){var t=M.default(e,2),n=t[0],r=t[1],a=n.split("."),i=M.default(a,3),o=i[0],s=i[1],u=i[2];if(void 0!==u){var l=U.range(r,r).snapTo(u);v.push({dimension:[o,s].join("."),dateRange:[l.start,l.end].map((function(e){return e.format(U.HTML5_FMT.DATETIME_LOCAL_MS)}))})}else null==r?y.push({member:n,operator:"notSet"}):y.push({member:n,operator:"equals",values:[r.toString()]})})),N(N(N({},m[h].drillMembersGrouped),{},{filters:y},p.length>0?{segments:p}:{}),{},{timeDimensions:v,segments:p,timezone:this.loadResponses[0].query.timezone})}},{key:"series",value:function(e){var t=this;return this.seriesNames(e).map((function(n){var r=n.title,a=n.key;return{title:r,key:a,series:t.chartPivot(e).map((function(e){var t=e.category,n=e.x;return{value:R.default(e,["category","x"])[a],category:t,x:n}}))}}))}},{key:"axisValues",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.loadResponses[t].query;return function(t){var r=function(n){return e.filter((function(e){return"measures"!==e})).map((function(e){return null!=t[e]?t[e]:null})).concat(n?[n]:[])};return e.find((function(e){return"measures"===e}))&&(n.measures||[]).length?n.measures.map(r):[r()]}}},{key:"axisValuesString",value:function(e,t){return e.map((function(e){return null==e?"∅":""===e?"[Empty string]":e})).join(t||", ")}},{key:"normalizePivotConfig",value:function(t){return e.getNormalizedPivotConfig(this.loadResponse.pivotQuery,t)}},{key:"timeSeries",value:function(t){if(!t.granularity)return null;var n=t.dateRange;if(!n){var r=m.pipe(m.map((function(n){return n[e.timeDimensionMember(t)]&&U(n[e.timeDimensionMember(t)])})),m.filter((function(e){return!!e})))(this.timeDimensionBackwardCompatibleData());n=r.length&&[m.reduce(m.minBy((function(e){return e.toDate()})),r[0],r),m.reduce(m.maxBy((function(e){return e.toDate()})),r[0],r)]||null}if(!n)return null;var a=t.dateRange?t.dateRange.find((function(e){return e.match(Y)})):!["hour","minute","second"].includes(t.granularity),i=n,o=M.default(i,2),s=o[0],u=o[1],l=U.range(s,u);if(!V[t.granularity])throw new Error("Unsupported time granularity: ".concat(t.granularity));return V[t.granularity](a?l.snapTo("day"):l)}},{key:"pivot",value:function(t){var n=this;t=this.normalizePivotConfig(t);var r=this.loadResponse.pivotQuery,a=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=_((function(e){var t=e.xValues;return n.axisValuesString(t)})),o=function(e,t){return e[t]};if(t.fillMissingDates&&1===t.x.length&&m.equals(t.x,(r.timeDimensions||[]).filter((function(e){return!!e.granularity})).map((function(t){return e.timeDimensionMember(t)})))){var s=n.loadResponses.map((function(e){return n.timeSeries(e.query.timeDimensions[0])}));s[0]&&(i=function(e){var t=m.groupBy((function(e){var t=e.xValues;return U(t[0]).format(U.HTML5_FMT.DATETIME_LOCAL_MS)}),e);return s[a].map((function(e){return[e,t[e]||[{xValues:[e],row:{}}]]}))},o=function(e,t){return e[t]||0})}var u=m.pipe(m.map((function(e){return n.axisValues(t.x,a)(e).map((function(t){return{xValues:t,row:e}}))})),m.unnest,i)(n.timeDimensionBackwardCompatibleData(a)),l=m.pipe(m.map((function(e){var r=M.default(e,2)[1];return m.unnest(r.filter((function(e){var t=e.row;return Object.keys(t).length>0})).map((function(e){var r=e.row;return n.axisValues(t.y,a)(r)})))})),m.unnest,m.uniq)(u);return u.map((function(r){var i=M.default(r,2)[1],s=i[0].xValues,u=m.pipe(m.map((function(e){var r=e.row;return n.axisValues(t.y,a)(r).map((function(e){return{yValues:e,row:r}}))})),m.unnest,m.groupBy((function(e){var t=e.yValues;return n.axisValuesString(t)})))(i);return{xValues:s,yValuesArray:m.unnest(l.map((function(r){var a=t.x.find((function(e){return"measures"===e}))?e.measureFromAxis(s):e.measureFromAxis(r);return(u[n.axisValuesString(r)]||[{row:{}}]).map((function(e){var t=e.row;return[r,o(t,a)]}))})))}}))},i=this.loadResponses.length>1?this.loadResponses.map((function(e,t){return a(t)})):[];return i.length?this.mergePivots(i,t.joinDateRange):a()}},{key:"mergePivots",value:function(e,t){var n=e.reduce((function(e,t){return null!=e&&t.length>=e.length?e:t}),null);return n.map((function(r,a){return{xValues:t?[e.map((function(e){return e[a]&&e[a].xValues||[]})).join(", ")]:n[a].xValues,yValuesArray:m.unnest(e.map((function(e){return e[a].yValuesArray})))}}))}},{key:"pivotedRows",value:function(e){return this.chartPivot(e)}},{key:"chartPivot",value:function(e){var t=this,n=new Set;this.queryType===K.BLENDING_QUERY&&m.flatten(this.loadResponses.map((function(e){return e.query.measures}))).filter((function(e,t,n){return n.indexOf(e)!==t})).forEach((function(e){return n.add(e)}));return this.pivot(e).map((function(r){var a=r.xValues,i=r.yValuesArray;return N({category:t.axisValuesString(a,","),x:t.axisValuesString(a,","),xValues:a},i.map((function(r,a){var i,o=M.default(r,2),s=o[0],u=o[1];return j.default({},t.axisValuesString(function(t,r){return e&&e.aliasSeries&&e.aliasSeries[r]?[e.aliasSeries[r]].concat(q.default(t)):n.has(t[0])?[r].concat(q.default(t)):[t]}(s,a),","),u&&(i=u,t.parseDateMeasures&&B.test(i)?new Date(i):Number.isNaN(Number.parseFloat(i))?i:Number.parseFloat(i)))})).reduce((function(e,t){return Object.assign(e,t)}),{}))}))}},{key:"tablePivot",value:function(e){var t=this.normalizePivotConfig(e||{}),n=t.x.concat(t.y).includes("measures");return this.pivot(t).map((function(e){var r=e.xValues,a=e.yValuesArray;return m.fromPairs(t.x.map((function(e,t){return[e,r[t]]})).concat(n?a.map((function(e){var t=M.default(e,2),n=t[0],r=t[1];return[n.length?n.join():"value",r]})):[]))}))}},{key:"tableColumns",value:function(e){var t=this.normalizePivotConfig(e||{}),n=m.pipe(m.pluck("annotation"),m.reduce(m.mergeDeepLeft(),{}))(this.loadResponses),r=Object.values(n).reduce((function(e,t){return N(N({},e),t)}),{}),a={},i=function(e){var t=r[e]||{};return{key:e,title:t.title,shortTitle:t.shortTitle,type:t.type,format:t.format,meta:t.meta}},o=this.pivot(t);(o[0]&&o[0].yValuesArray||[]).forEach((function(e){var n=M.default(e,1)[0];if(n.length>0){var r=a;n.forEach((function(e,n){r[e]={key:e,memberId:"measures"===t.y[n]?e:t.y[n],children:r[e]&&r[e].children||{}},r=r[e].children}))}}));var s=[];return!o.length&&t.y.includes("measures")&&(s=(this.loadResponses[0].query.measures||[]).map((function(e){return N(N({},i(e)),{},{dataIndex:e})}))),!t.y.length&&t.x.includes("measures")&&s.push({key:"value",dataIndex:"value",title:"Value",shortTitle:"Value",type:"string"}),t.x.map((function(e){return"measures"===e?{key:"measures",dataIndex:"measures",title:"Measures",shortTitle:"Measures",type:"string"}:N(N({},i(e)),{},{dataIndex:e})})).concat(function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return 0===Object.keys(t).length?[]:Object.values(t).map((function(t){var r=t.key,a=R.default(t,["key"]),o=e(a.children,[].concat(q.default(n),[r])),s=i(a.memberId),u=s.title,l=s.shortTitle,c=R.default(s,["title","shortTitle"]),d=r!==a.memberId||null==u?r:"";return o.length?N(N({},c),{},{key:r,title:[u,d].join(" ").trim(),shortTitle:d||l,children:o}):N(N({},c),{},{key:r,dataIndex:[].concat(q.default(n),[r]).join(),title:[u,d].join(" ").trim(),shortTitle:d||l})}))}(a)).concat(s)}},{key:"totalRow",value:function(){return this.chartPivot()[0]}},{key:"categories",value:function(e){return this.chartPivot(e)}},{key:"seriesNames",value:function(t){var n=this;t=this.normalizePivotConfig(t);var r=m.pipe(m.pluck("annotation"),m.pluck("measures"),m.mergeAll)(this.loadResponses),a=m.unnest(this.loadResponses.map((function(e,r){return m.pipe(m.map(n.axisValues(t.y,r)),m.unnest,m.uniq)(n.timeDimensionBackwardCompatibleData(r))}))),i=new Set;this.queryType===K.BLENDING_QUERY&&m.flatten(this.loadResponses.map((function(e){return e.query.measures}))).filter((function(e,t,n){return n.indexOf(e)!==t})).forEach((function(e){return i.add(e)}));return a.map((function(a,o){var s=function(e,n){return t&&t.aliasSeries&&t.aliasSeries[n]?[t.aliasSeries[n]].concat(q.default(e)):i.has(e[0])?[n].concat(q.default(e)):e}(a,o);return{title:n.axisValuesString(t.y.find((function(e){return"measures"===e}))?m.dropLast(1,s).concat(r[e.measureFromAxis(a)].title):s,", "),key:n.axisValuesString(s,","),yValues:a}}))}},{key:"query",value:function(){if(this.queryType!==K.REGULAR_QUERY)throw new Error("Method is not supported for a '".concat(this.queryType,"' query type. Please use decompose"));return this.loadResponses[0].query}},{key:"pivotQuery",value:function(){return this.loadResponse.pivotQuery||null}},{key:"rawData",value:function(){if(this.queryType!==K.REGULAR_QUERY)throw new Error("Method is not supported for a '".concat(this.queryType,"' query type. Please use decompose"));return this.loadResponses[0].data}},{key:"annotation",value:function(){if(this.queryType!==K.REGULAR_QUERY)throw new Error("Method is not supported for a '".concat(this.queryType,"' query type. Please use decompose"));return this.loadResponses[0].annotation}},{key:"timeDimensionBackwardCompatibleData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!this.backwardCompatibleData[t]){var n=this.loadResponses[t],r=n.data,a=n.query,i=(a.timeDimensions||[]).filter((function(e){return!!e.granularity}));this.backwardCompatibleData[t]=r.map((function(t){return N(N({},t),m.fromPairs(Object.keys(t).filter((function(n){return i.find((function(e){return e.dimension===n}))&&!t[e.timeDimensionMember(i.find((function(e){return e.dimension===n})))]})).map((function(n){return[e.timeDimensionMember(i.find((function(e){return e.dimension===n}))),t[n]]}))))}))}return this.backwardCompatibleData[t]}},{key:"decompose",value:function(){var t=this;return this.loadResponses.map((function(n){return new e({queryType:K.REGULAR_QUERY,pivotQuery:N(N({},n.query),{},{queryType:K.REGULAR_QUERY}),results:[n]},t.options)}))}},{key:"serialize",value:function(){return{loadResponse:m.clone(this.loadResponse)}}}],[{key:"getNormalizedPivotConfig",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r={x:[],y:[],fillMissingDates:!0,joinDateRange:!1},a=t.measures,i=void 0===a?[]:a,o=t.dimensions,s=void 0===o?[]:o,u=(t.timeDimensions||[]).filter((function(e){return!!e.granularity}));n=n||(u.length?{x:u.map((function(t){return e.timeDimensionMember(t)})),y:s}:{x:s,y:[]});var l=function(n){return n.map((function(n){return u.find((function(e){return e.dimension===n}))&&!s.find((function(e){return e===n}))?e.timeDimensionMember(t.timeDimensions.find((function(e){return e.dimension===n}))):n}))};(n=m.mergeDeepLeft(n,r)).x=l(n.x),n.y=l(n.y);var c=n.x.concat(n.y),d=u.map((function(t){return e.timeDimensionMember(t)})).concat(s),p=function(e){return d.includes(e)||"measures"===e};return n.x=n.x.concat(d.filter((function(e){return!c.includes(e)}))).filter(p),n.y=n.y.filter(p),n.x.concat(n.y).find((function(e){return"measures"===e}))||n.y.push("measures"),i.length||(n.x=n.x.filter((function(e){return"measures"!==e})),n.y=n.y.filter((function(e){return"measures"!==e}))),n}}]),e}(),G=function(){function e(t){C.default(this,e),this.sqlQuery=t}return S.default(e,[{key:"rawQuery",value:function(){return this.sqlQuery.sql}},{key:"sql",value:function(){return this.rawQuery().sql[0]}}]),e}(),J=function(e){return m.fromPairs(e.map((function(e){return[e.name,e]})))},W={string:[{name:"contains",title:"contains"},{name:"notContains",title:"does not contain"},{name:"equals",title:"equals"},{name:"notEquals",title:"does not equal"},{name:"set",title:"is set"},{name:"notSet",title:"is not set"}],number:[{name:"equals",title:"equals"},{name:"notEquals",title:"does not equal"},{name:"set",title:"is set"},{name:"notSet",title:"is not set"},{name:"gt",title:">"},{name:"gte",title:">="},{name:"lt",title:"<"},{name:"lte",title:"<="}]},$=function(){function e(t){C.default(this,e),this.meta=t;var n=this.meta.cubes;this.cubes=n,this.cubesMap=m.fromPairs(n.map((function(e){return[e.name,{measures:J(e.measures),dimensions:J(e.dimensions),segments:J(e.segments)}]})))}return S.default(e,[{key:"membersForQuery",value:function(e,t){return m.unnest(this.cubes.map((function(e){return e[t]})))}},{key:"resolveMember",value:function(e,t){var n=this,r=e.split("."),a=M.default(r,1)[0];if(!this.cubesMap[a])return{title:e,error:"Cube not found ".concat(a," for path '").concat(e,"'")};var i=(Array.isArray(t)?t:[t]).map((function(t){return n.cubesMap[a][t]&&n.cubesMap[a][t][e]})).find((function(e){return e}));return i||{title:e,error:"Path not found '".concat(e,"'")}}},{key:"defaultTimeDimensionNameFor",value:function(e){var t=this,n=e.split("."),r=M.default(n,1)[0];return this.cubesMap[r]?Object.keys(this.cubesMap[r].dimensions||{}).find((function(e){return"time"===t.cubesMap[r].dimensions[e].type})):null}},{key:"filterOperatorsForMember",value:function(e,t){var n=this.resolveMember(e,t);return W[n.type]||W.string}}]),e}(),Z=function(){function e(t){C.default(this,e),this.progressResponse=t}return S.default(e,[{key:"stage",value:function(){return this.progressResponse.stage}},{key:"timeElapsed",value:function(){return this.progressResponse.timeElapsed}}]),e}();function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach((function(t){j.default(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var te=function(){function e(t){var n=t.authorization,r=t.apiUrl,a=t.method,i=t.headers,o=void 0===i?{}:i,s=t.credentials;C.default(this,e),this.authorization=n,this.apiUrl=r,this.method=a,this.headers=o,this.credentials=s}return S.default(e,[{key:"request",value:function(e,t){var n=this,r=t.baseRequestId,a=R.default(t,["baseRequestId"]),i=1,o=new URLSearchParams(a&&Object.keys(a).map((function(e){return j.default({},e,"object"===w.default(a[e])?JSON.stringify(a[e]):a[e])})).reduce((function(e,t){return ee(ee({},e),t)}),{})),s="".concat(this.apiUrl,"/").concat(e).concat(o.toString().length?"?".concat(o):"");this.method=this.method||(s.length<2e3?"GET":"POST"),"POST"===this.method&&(s="".concat(this.apiUrl,"/").concat(e),this.headers["Content-Type"]="application/json");return{subscribe:function(e){var t=this;return E.default(O.default.mark((function o(){var u;return O.default.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,A.default(s,{method:n.method,headers:ee({Authorization:n.authorization,"x-request-id":r&&"".concat(r,"-span-").concat(i++)},n.headers),credentials:n.credentials,body:"POST"===n.method?JSON.stringify(a):null});case 2:return u=o.sent,o.abrupt("return",e(u,(function(){return t.subscribe(e)})));case 4:case"end":return o.stop()}}),o)})))()}}}}]),e}();function ne(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=F.default(e);if(t){var a=F.default(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Q.default(this,n)}}var re=function(e){L.default(n,e);var t=ne(n);function n(e,r){var a;return C.default(this,n),(a=t.call(this,e)).response=r,a}return n}(z.default(Error));function ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(n),!0).forEach((function(t){j.default(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ae(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(n),!0).forEach((function(t){j.default(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ue=0,le="Mutex has been changed",ce=function(){function e(t,n){C.default(this,e),"object"===w.default(t)&&(n=t,t=void 0),n=n||{},this.apiToken=t,this.apiUrl=n.apiUrl||"https://statsbot.co/cubejs-api/v1",this.method=n.method,this.headers=n.headers||{},this.credentials=n.credentials,this.transport=n.transport||new te({authorization:"function"==typeof t?void 0:t,apiUrl:this.apiUrl,method:this.method,headers:this.headers,credentials:this.credentials}),this.pollInterval=n.pollInterval||5,this.parseDateMeasures=n.parseDateMeasures}var t;return S.default(e,[{key:"request",value:function(e,t){return this.transport.request(e,se({baseRequestId:D.default()},t))}},{key:"loadMethod",value:function(e,t,n,r){var a=this,i=++ue;"function"!=typeof n||r||(r=n,n=void 0);var o=(n=n||{}).mutexKey||"default";n.mutexObj&&(n.mutexObj[o]=i);var s,u=this.updateTransportAuthorization().then((function(){return e()})),l=!1,c=function(){var e=E.default(O.default.mark((function e(){var t;return O.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u;case 2:if(t=e.sent,!n.mutexObj||n.mutexObj[o]===i){e.next=9;break}if(l=!0,!t.unsubscribe){e.next=8;break}return e.next=8,t.unsubscribe();case 8:throw le;case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),d=function(){var e=E.default(O.default.mark((function e(i,o){var s,d,p,m,f,h;return O.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u;case 2:return s=e.sent,d=function(){var e=E.default(O.default.mark((function e(){return O.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.subscribe||l){e.next=8;break}if(!s.unsubscribe){e.next=5;break}return e.abrupt("return",o());case 5:return e.next=7,new Promise((function(e){return setTimeout((function(){return e()}),1e3*a.pollInterval)}));case 7:return e.abrupt("return",o());case 8:return e.abrupt("return",null);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),p=function(){var e=E.default(O.default.mark((function e(t){return O.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l){e.next=5;break}if(!t){e.next=4;break}return e.next=4,new Promise((function(e){return setTimeout((function(){return e()}),1e3*a.pollInterval)}));case 4:return e.abrupt("return",o());case 5:return e.abrupt("return",null);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.next=7,a.updateTransportAuthorization();case 7:if(502!==i.status){e.next=11;break}return e.next=10,c();case 10:return e.abrupt("return",p(!0));case 11:return e.next=13,i.json();case 13:if("Continue wait"!==(m=e.sent).error){e.next=19;break}return e.next=17,c();case 17:return n.progressCallback&&n.progressCallback(new Z(m)),e.abrupt("return",p());case 19:if(200===i.status){e.next=32;break}return e.next=22,c();case 22:if(n.subscribe||!s.unsubscribe){e.next=25;break}return e.next=25,s.unsubscribe();case 25:if(f=new re(m.error,m),!r){e.next=30;break}r(f),e.next=31;break;case 30:throw f;case 31:return e.abrupt("return",d());case 32:return e.next=34,c();case 34:if(n.subscribe||!s.unsubscribe){e.next=37;break}return e.next=37,s.unsubscribe();case 37:if(h=t(m),!r){e.next=42;break}r(null,h),e.next=43;break;case 42:return e.abrupt("return",h);case 43:return e.abrupt("return",d());case 44:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),p=u.then((function(e){return function(e){return new Promise((function(t,n){e.then((function(e){return t(e)}),(function(e){return e!==le&&n(e)}))}))}(e.subscribe(d))}));return r?{unsubscribe:(s=E.default(O.default.mark((function e(){var t;return O.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u;case 2:if(t=e.sent,l=!0,!t.unsubscribe){e.next=6;break}return e.abrupt("return",t.unsubscribe());case 6:return e.abrupt("return",null);case 7:case"end":return e.stop()}}),e)}))),function(){return s.apply(this,arguments)})}:p}},{key:"updateTransportAuthorization",value:(t=E.default(O.default.mark((function e(){var t;return O.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"!=typeof this.apiToken){e.next=5;break}return e.next=3,this.apiToken();case 3:t=e.sent,this.transport.authorization!==t&&(this.transport.authorization=t);case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"load",value:function(e,t,n){var r=this;return this.loadMethod((function(){return r.request("load",{query:e,queryType:"multi"})}),(function(e){return new H(e,{parseDateMeasures:r.parseDateMeasures})}),t,n)}},{key:"sql",value:function(e,t,n){var r=this;return this.loadMethod((function(){return r.request("sql",{query:e})}),(function(e){return Array.isArray(e)?e.map((function(e){return new G(e)})):new G(e)}),t,n)}},{key:"meta",value:function(e,t){var n=this;return this.loadMethod((function(){return n.request("meta")}),(function(e){return new $(e)}),e,t)}},{key:"dryRun",value:function(e,t,n){var r=this;return this.loadMethod((function(){return r.request("dry-run",{query:e})}),(function(e){return e}),t,n)}},{key:"subscribe",value:function(e,t,n){var r=this;return this.loadMethod((function(){return r.request("subscribe",{query:e,queryType:"multi"})}),(function(e){return new H(e,{parseDateMeasures:r.parseDateMeasures})}),se(se({},t),{},{subscribe:!0}),n)}}]),e}();t.HttpTransport=te,t.ResultSet=H,t.default=function(e,t){return new ce(e,t)},t.defaultHeuristics=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=n.meta,a=n.sessionGranularity,i=a||"day",o={};if(Array.isArray(e)||Array.isArray(t))return e;if(e){if(1===(t.timeDimensions||[]).length&&1===(e.timeDimensions||[]).length&&e.timeDimensions[0].granularity&&t.timeDimensions[0].granularity!==e.timeDimensions[0].granularity&&(o=ie(ie({},o),{},{sessionGranularity:e.timeDimensions[0].granularity})),0===(t.measures||[]).length&&(e.measures||[]).length>0||1===(t.measures||[]).length&&1===(e.measures||[]).length&&t.measures[0]!==e.measures[0]){var s=r.defaultTimeDimensionNameFor(e.measures[0]);return e=ie(ie({},e),{},{timeDimensions:s?[{dimension:s,granularity:i}]:[]}),ie(ie({},o),{},{pivotConfig:null,shouldApplyHeuristicOrder:!0,query:e,chartType:s?"line":"number"})}return 0===(t.dimensions||[]).length&&(e.dimensions||[]).length>0?(e=ie(ie({},e),{},{timeDimensions:(e.timeDimensions||[]).map((function(e){return ie(ie({},e),{},{granularity:void 0})}))}),ie(ie({},o),{},{pivotConfig:null,shouldApplyHeuristicOrder:!0,query:e,chartType:"table"})):(t.dimensions||[]).length>0&&0===(e.dimensions||[]).length?(e=ie(ie({},e),{},{timeDimensions:(e.timeDimensions||[]).map((function(e){return ie(ie({},e),{},{granularity:e.granularity||i})}))}),ie(ie({},o),{},{pivotConfig:null,shouldApplyHeuristicOrder:!0,query:e,chartType:(e.timeDimensions||[]).length?"line":"number"})):((t.dimensions||[]).length>0||(t.measures||[]).length>0)&&0===(e.dimensions||[]).length&&0===(e.measures||[]).length?(e=ie(ie({},e),{},{timeDimensions:[],filters:[]}),ie(ie({},o),{},{pivotConfig:null,shouldApplyHeuristicOrder:!0,query:e,sessionGranularity:null})):o}if(o.chartType){var u=o.chartType;if(("line"===u||"area"===u)&&1===(t.timeDimensions||[]).length&&!t.timeDimensions[0].granularity){var l=M.default(t.timeDimensions,1),c=l[0];return ie(ie({},o),{},{pivotConfig:null,query:ie(ie({},t),{},{timeDimensions:[ie(ie({},c),{},{granularity:i})]})})}if(("pie"===u||"table"===u||"number"===u)&&1===(t.timeDimensions||[]).length&&t.timeDimensions[0].granularity){var d=M.default(t.timeDimensions,1),p=d[0];return ie(ie({},o),{},{pivotConfig:null,shouldApplyHeuristicOrder:!0,query:ie(ie({},t),{},{timeDimensions:[ie(ie({},p),{},{granularity:void 0})]})})}}return o},t.defaultOrder=function(e){var t=(e.timeDimensions||[]).find((function(e){return e.granularity}));return t?j.default({},t.dimension,"asc"):(e.measures||[]).length>0&&(e.dimensions||[]).length>0?j.default({},e.measures[0],"desc"):(e.dimensions||[]).length>0?j.default({},e.dimensions[0],"asc"):{}},t.flattenFilters=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.reduce((function(t,n){return n.or||n.and?[].concat(q.default(t),q.default(e(n.or||n.and))):[].concat(q.default(t),[n])}),[])},t.isQueryPresent=function(e){return(Array.isArray(e)?e:[e]).every((function(e){return e.measures&&e.measures.length||e.dimensions&&e.dimensions.length||e.timeDimensions&&e.timeDimensions.length}))},t.moveItemInArray=function(e,t,n){var r=q.default(e),a=r.splice(t,1),i=M.default(a,1)[0];return r.splice(n,0,i),r},t.movePivotItem=function(e,t,n,r,a){var i=ie(ie({},e),{},{x:q.default(e.x),y:q.default(e.y)}),o=e[r][t],s=i[a].length-1;return"measures"===o?n=s+1:n>=s&&"measures"===i[a][s]&&(n=s-1),i[r].splice(t,1),i[a].splice(n,0,o),i}}});